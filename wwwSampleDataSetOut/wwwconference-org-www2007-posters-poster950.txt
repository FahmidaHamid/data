FindingCommunityStructureinMega-scaleSocialNetworks[ExtendedAbstract]∗KenWakitaTokyoInstituteofTechnology2-12-1Ookayama,Meguro-kuTokyo152-8552,Japanwakita@is.titech.ac.jpToshiyukiTsurumiTokyoInstituteofTechnology2-12-1Ookayama,Meguro-kuTokyo152-8552,Japantsurumi2@is.titech.ac.jpABSTRACTCommunityanalysisalgorithmproposedbyClauset,New-man,andMoore(CNMalgorithm)ﬁndscommunitystruc-tureinsocialnetworks.Unfortunately,CNMalgorithmdoesnotscalewellanditsuseispracticallylimitedtonetworkswhosesizesareupto500,000nodes.Weshowthatthisinef-ﬁciencyiscausedfrommergingcommunitiesinunbalancedmannerandthatasimpleheuristicsthatattemptstomergecommunitystructuresinabalancedmannercandramati-callyimprovecommunitystructureanalysis.Theproposedtechniquesaretestedusingdatasetsobtainedfromexist-ingsocialnetworkingservicethathosts5.5millionusers.Wehavetestedthreethreevariationsoftheheuristics.ThefastestmethodprocessesaSNSfriendshipnetworkwith1millionusersin5minutes(70timesfasterthanCNM)andan-otherfriendshipnetworkwith4millionusersin35minutes,respectively.Anotheroneprocessesanetworkwith500,000nodesin50minutes(7timesfasterthanCNM),ﬁndscom-munitystructuresthathasimprovedmodularity,andscalestoanetworkwith5.5million.Furtherdetailisreportedin[3].CategoriesandSubjectDescriptors:H.2.8[Databaseappli-cations]:Datamining;G.2.2[GraphTheory]:Graphalgo-rithmsGeneralTerms:Algorithms,PerformanceKeywords:Communityanalysis,clustering,socialnetwork-ingservice1.INTRODUCTIONFindingcommunitystructureincomplexnetworksisanimportantﬁrststeptograspinherentcomplexstructureofsocialnetworks.Manyresearchactivitiesattempttodeﬁnethenotionofcommunitiesandproposecommunityanalysisalgorithms[2,1].Weimplementedafastcommunityanalysisalgorithmpro-posedbyClauset,Newman,andMoore[1](CNMalgorithm)andappliedittoanalyzevarioussubsetsofanacquaintancerelationshipnetworkobtainedfromasocialnetworkingsys-tem(SNS).Itperformswellforamid-scalesubsetofthenet-∗Alongversionofthispaperisavailableas[3].ThisworkissupportedinpartbytheGrant-inAid(No.18300041)ofMEXT,Japan.Copyrightisheldbytheauthor/owner(s).WWW2007,May8–12,2007,Banff,Alberta,Canada.ACM978-1-59593-654-7/07/0005.workthatconsistsoflessthan500,000usersitwasincapabletoanalyzelargernetworks.Weobservedthatmergingincouplingpairofcommunitystructures,balancednessofthepairhasgreatimpactoncom-putationalefﬁciencyofCNMalgorithm.Basedonthisobser-vation,wehaveimplementedaslightlymodiﬁedversionsofCNMalgorithmandobservedremarkablespeedupandslightimprovementofthemodularity.2.CNMALGORITHMNewmanandGirvanattempttomeasurethequalityofnetworkclusteringbymeansofmodularity[2].Theiralgo-rithm(CNMalgorithm)isabottom-upagglomerativeclus-teringwhichcontinuouslyﬁndsandmergespairsofclusterstryingtomaximizemodularityofthecommunitystructureinagreedymanner[1].TheauthorshaveprogramedCNMalgorithmandattemptedtoanalyzeanfriendshipnetworkofanSNScalled“mixi1”thathostedaboutonemillionusersinOctober2005.Inspiteofthegoodscalabilityasadvertisedin[1],wehadtostoptheexperimentafteraweekwhenlessthan10%ofthewholeanalysiswasﬁnished. 0 200 400 600 800 1000 1200 1400 1600 1800 0 50000 100000 150000 200000 250000 300000 350000 400000 450000Time [sec]#Joins#Nodes = 500K#Nodes = 400K#Nodes = 300K#Nodes = 200K#Nodes = 100KFigure1:Analysistime.Toﬁgureouttheperformancebottleneck,weconductedcommunityanalysisonavarioussubsetsofmixiSNSnet-work.ThemixiSNSassignseachuseranincrementaserialregistrationID.LetusrepresentthemixiSNSnetworkbya1mixi(http://mixi.jp/)isthelargestinvitation-basedSNSinJapanandithostsabout7millionusers(Feb.2007).WWW 2007 / Poster PaperTopic: Social Networks1275graphGmixi=(U,F),whereU={1,2,...}isthesetofuserIDsandF⊂U×Uisasetoffriendshiprelationship.Asubsetofthisgraphcanbegivenasfollows:Gnmixi=(Un,F∩(Un×Un))whereUn={u∈U|u≤n}Figure1illustratestimerequiredforanalysisofvarioussubsets:GNmixi.Eachbarofthegraphdepictstimerequiredtomerge10,000communitypairs.Formostofthecomputationtimeisconsumedfortheﬁrsthalfofthemergingprocesswhichdecreasesdramaticallyforthelatterhalf.[1]discussesthecomputationalcomplexityofCNMalgo-rithmcanbeapproximatedbyO(nlog2n),fornnodesbutthisapproximationcontracictssuperquadraticcostillustratedinFigure1.Figure2:Consolidationratioofeachmergestep.Fromthemergelogsthatrecordhowcommunitypairsaremergedintolargerones,itwasobservedthatonlyafewlargecommunitiesaregrowingfast,merginginmanytinycom-munities.Figure2presentsunbalancednessofmergestepsinthecourseofcommunityanalysisforG500Kmixi.Forthispur-pose,wehavedeﬁnedthenotionofconsolidationratio,whichplots,forn-thmergestep,ck:=join(ci,cj),(n,ratio(ci,cj)),wherethesize(s)ofacommunityismeasuredintermsofthenumberofitslinkstoothercommunities.ratio(ci,cj)=min(s(ci)/s(cj),s(cj)/s(ci)).Theapproximationofcomputationalcomplexity(nlog2n)of[1]isbasedonananticipationthatthemergesareper-formedinabalancedmanner,whichinpracticeisnotthecaseandthusleadstosuperquadraticcomputationalcom-plexity.3.HEURISTICSWehaveseenthatifwecouldcontrolthegrowthofcom-munitiessothattheygrowinabalancedmanner,theperfor-manceofthealgorithmwillimproveremarkably.Thestruc-tureofthealgorithmremainsthesameexceptforthewaythecommuitypairsarechosen:weuseboth∆QCci,cjaswellasratio(ci,cj),whichtheoriginalalgorithmusesonlythefor-mer.Wecanbuildvariantsofthealgorithmchoosingdifferentmetricsforcomputingthecommunitysizes,s(c).WetestedthreevariantsHN,HE,andHE’:HNmeasuresacommunityAlgorithm1Outlineoftheproposedalgorithm.ratio(ci,cj)≡min(s(ci)/s(cj),s(cj)/s(ci));while(true){updateDeltaQ();Find(ci,cj)∈C2thathasmaximum∆QCci,cj·ratio(ci,cj).if(max(∆QCci,cj<0)break;C:=join(ci,cj);}Table1:Elapsedtime(minutes):Java5.0,3.2GBHeap,IntelXeon2.80GHz.G200KmixiG400KmixiG600KmixiG800KmixiG1MmixiG4MmixiCNM42.2197NANANANAHE2.156.8013.624.536.2243HE’8.5235.568.21241733,400HN0.431.162.053.174.4733.3bythenumberofitsmembers,andHEmeasuresacommu-nitybythenumberofedgesthatlinkthiscommunitywithothers,andHE’isahybridofCNMalgorithmandHE.4.EVALUATIONUseofheuristicsdramaticallyacceleratesexecutionofcom-munityanalysis(Table1,Figure3).Thelargestdatasettheoriginalalgorithm(Clauset+(2004))waspossibletoanalyseisG500Kmixi.Ittookabout5.9hours.Thefastestheuristics(HN)processesG1Mmixiinlessthanﬁveminutes.ThesloweronHE’takes3hoursbutoffersimporovedmodularity[3].5.REFERENCES[1]A.Clauset,M.E.J.Newman,andC.Moore.Findingcommunitystructureinverylargenetworks.PhysicalReviewE,70:066111,2004.[2]M.E.J.NewmanandM.Girvan.Findingandevaluatingcommunitystructureinnetworks.PhysicalReviewE,69:026113,2004.[3]KenWakitaandToshiyukiTsurumi.Findingcommunitystructureinmega-scalesocialnetworks,February2007,cs.CY/0702048.http://arxiv.org/abs/cs.CY/0702048v1. 0 50000 100000 150000 200000 250000 300000 350000 400000 1e+06 1.5e+06 2e+06 2.5e+06 3e+06 3.5e+06 4e+06 4.5e+06 5e+06 5.5e+06Elapsed Time [sec]Size of Social NetworkHEHE’HNFigure3:ScalabilityWWW 2007 / Poster PaperTopic: Social Networks1276