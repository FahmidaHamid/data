cross-site scripting  aws have now surpassed bu er over ows as the world s most common publicly-reported security vulnerability. in recent years, browser vendors and researchers have tried to develop client-side  lters to mitigate these attacks. we analyze the best existing  lters and  nd them to be either unacceptably slow or easily circumvented. worse, some of these  lters could introduce vulnerabilities into sites that were previously bug-free. we propose a new  lter design that achieves both high performance and high precision by blocking scripts after html parsing but before execution. compared to previous approaches, our approach is faster, protects against more vulnerabilities, and is harder for attackers to abuse. we have contributed an implementation of our  lter design to the webkit open source rendering engine, and the  lter is now enabled by default in the google chrome browser.
