The standard approach to modeling a large online social network is to treat it as a single graph with an enormous number of nodes and a sparse pattern of connections.
Increasingly, however, many of the key problems encountered in managing an online so-Copyright is held by the International World Wide Web Conference Committee (IW3C2).
IW3C2 reserves the right to provide a hyperlink to the author s site if the Material is used in electronic media.
cial network involve working with large collections of small, dense graphs contained within the network.
On Facebook, for example, the set of people belonging to a group or attending an event determines such a graph, and considering the set of all groups or all events leads to a very large number of such graphs.
On any social network, the network neighborhood of each individual   consisting of his or her friends and the links among them   is also generally a small dense graph with a rich structure, on a few hundred nodes or fewer [19].
If we consider the neighborhood of each user as de ning a distinct graph, we again obtain an enormous collection of graphs.
Indeed, this view of a large underlying social network in terms of its overlapping node neighborhoods suggests a potentially valuable perspective on the analysis of the network: rather than thinking of Facebook, for example, as a single billion-node network, with a global structure that quickly becomes incomprehensible, we argue that it can be useful to think of it as the superposition of a billion small dense graphs   the network neighborhoods, one centered at each user, and each accessible to a closer and more tractable investigation.
Nor is this view limited to a site such as Facebook; one can  nd collections of small dense graphs in the interactions within a set of discussion forums [7], within a set of collaborative online projects [20], and in a range of other settings.
Our focus in the present work is on a fundamental global question about these types of graph collections: given a large set of small dense graphs, can we study this set by de ning a meaningful  coordinate system  on it, so that the graphs it contains can be represented and understood within a common space?
With such a coordinate system providing a general-purpose framework for analysis, additional questions become possible.
For example, when considering collections of a billion or more social graphs, it may seem as though almost any graph is possible; is that the case, or are there underlying properties guiding the observed structures?
And how do these properties relate to more fundamental combinatorial constraints deriving from the extremal limits that govern all graphs?
As a further example, we can ask how different graph collections compare to one another; do network neighborhoods differ in some systematic way, for instance, from social graphs induced by other contexts, such as the graphs implicit in social groups, organized events, or other arrangements?
The Present Work.
In this paper we develop and analyze such a representation, drawing on the theory of graph homomorphisms.
Roughly speaking, the coordinate system we examine begins by describing a graph by the frequencies with which all possible small subgraphs occur within it.
More precisely, we choose a small number k (e.g.
k = 3 or 4); then, for each graph G in a collection, we create a vector with a coordinate for each distinct k-node subgraph
 copy of H (in other words, the frequency of H as an induced sub-graph of G).
For k = 3, this description corresponds to what is sometimes referred to as the triad census [5, 6, 21].
With each graph in the collection mapped to such a vector, we can ask how the full collection of graphs  lls out this space of sub-graph frequencies.
This turns out to be a subtle issue, because the arrangement of the graphs in this space is governed by two distinct sets of effects: extremal combinatorial constraints showing that certain combinations of subgraph frequencies are genuinely impossible; and empirical properties, which reveal that the bulk of the graphs tend to lie close to a simple one-dimensional curve through the space.
We formulate results on both these types of properties, in the former case building on an expanding body of combinatorial theory [4, 11] for bounding the frequencies at which different types of subgraphs can occur in a larger ambient graph.
The fact that the space of subgraph frequencies is constrained in these multiple ways also allows us to concretely address the following type of question: When we see that human social networks do not exhibit a certain type of structure, is that because such a structure is mathematically impossible, or simply because human beings do not create it when they form social connections?
In other words, what is a property of graphs and what is a property of people?
Although this question is implicit in many studies of social networks, it is hard to separate the two effects without a formal framework such as we have here.
Indeed, our framework offers a direct contribution to one of the most well-known observations about social graphs: the tendency of social relationships to close triangles, and the relative infrequency of what is sometimes called the  forbidden triad : three people with two social relationships between them, but one absent relationship [14].
There are many sociological theories for why one would expect this subgraph to be underrepresented in empirical social networks [8].
Our framework shows that the frequency of this  forbidden triad  has a nontrivial upper bound in not just social graphs, but in all graphs.
Harnessing our framework more generally, we are in fact able to show that any k node subgraph that is not a complete or empty subgraph has a frequency that is bounded away from one.
Thus, there is an extent to which almost all subgraphs are mathematically  forbidden  from occurring beyond a certain frequency.
We aim to separate these mathematical limits of graphs from the complementary empirical properties of real social graphs.
The fact that real graph collections have a roughly one-dimensional structure in our coordinate system leads directly to our  rst main question: is it possible to succinctly characterize the underlying backbone for this one-dimensional structure, and can we use such a characterization to usefully describe graphs within our coordinate system in terms of their deviation from this backbone?
The subgraph frequencies of the standard Erd os-R nyi random graph [3] Gn,p produce a one-dimensional curve (parametrized by p) that weakly approximates the layout of the real graphs in the space, but the curve arising from this random graph model systematically deviates from the real graphs in that the random graph contains fewer triangles and more triangle-free subgraphs.
This observation is consistent with the sociological principle of triadic closure   that triangles tend to form in social networks.
As a means of closing this deviation from Gn,p, we develop a tractable stochastic model of graph generation with a single additional parameter, determining the relative rates of arbitrary edge formation and triangle-closing edge formation.
The model exhibits rich behaviors, and for appropriately chosen settings of its single parameter, it produce remarkably close agreement with the subgraph frequencies observed in real data for the suite of all possible 3-node and 4-node sub-graphs.
Finally, we use this representation to study how different collections of graphs may differ from one another.
This arises as a question of basic interest in the analysis of large social media platforms, where users continuously manage multiple audiences [2]   ranging from their set of friends, to the members of a groups they ve joined, to the attendees of events and beyond.
Do these audiences differ from each other at a structural level, and if so what are the distinguishing characteristics?
Using Facebook data, we identify structural differences between the graphs induced on network neighborhoods, groups, and events.
The underlying basis for these differences suggests corresponding distinctions in each user s reaction to these different audiences with whom they interact.
Throughout our presentation, we analyze several collections of graphs collected from Facebook s social network.
The collections we study are all induced graphs from the Facebook friendship graph, which records friendship connections as undirected edges between users, and thus all our induced graphs are also undirected.
The framework we characterize in this work would naturally extend to provide insights about directed graphs, an extension we do not discuss.
We do not include edges formed by Facebook  subscriptions  in our study, nor do we include Facebook  pages  or connections from users to such pages.
All Facebook social graph data was analyzed in an anonymous, aggregated form.
For this work, we extracted three different collections of graphs, around which we organize our discussion:   Neighborhoods: Graphs induced by the friends of a single Facebook user ego and the friendship connections among these individuals (excluding the ego).
  Groups: Graphs induced by the members of a  Facebook group , a Facebook feature for organizing focused conversations between a small or moderate-sized set of users.
  Events: Graphs induced by the con rmed attendees of  Facebook events , a Facebook feature for coordinating invitations to calendar events.
Users can response  Yes ,  No , and  Maybe  to such invitations, and we consider only users who respond  Yes .
The neighborhood and groups collections were assembled in October 2012 based on monthly active user egos and current groups, while the events data was collected from all events during 2010 and
 date of the event were used.
Subgraph frequencies for four-node subgraphs were computed by sampling 11,000 induced subgraphs uniformly with replacement, providing suf ciently precise frequencies without enumeration.
The graph collections were targeted at a variety of different graph sizes, as will be discussed in the text.
In this section, we study the space of subgraph frequencies that form the basis of our coordinate system, and the one-dimensional concentration of empirical graphs within this coordinate system.
We derive a model capable of accurately identifying the backbone of this empirical concentration using only the basic principle of triadic closure, showing how the subgraph frequencies of empirical social graphs are seemingly restricted to the vicinity of a simple one-dimensional structure.
Formally, the subgraph frequency of a k-node graph F in an n-node graph G (where k   n) is the probability that a random
 orange, groups are green, and events are lavender.
The black curves illustrate Gn,p as a function of p.
k-node subset of G induces a copy of F .
It is clear that for any integer k, the subgraph frequencies of all the k-node graphs sum to one, constraining the vector of frequencies to an appropriately dimensioned simplex.
In the case of k = 3, this vector is simply the relative frequency of induced three-node subgraphs restricted to the 4-simplex; there are just four such subgraphs, with zero, one, two, and three edges respectively.
When considering the frequency of larger subgraphs, the dimension of the simplex grows very quickly, and already for k = 4, the space of four-node subgraph frequencies lives in an 11-simplex.
has in fact settled?)
and also the properties of the boundaries of the space as a whole (where, in principle, would it be possible for the population to settle?
).
Empirical distribution.
In Figure 1, the three-node subgraph frequencies of 50-node, 100-node, and 200-node graph collections are shown, with each subplot showing a balanced mixture of 17,000 neighborhood, group and event graphs   the three collections discussed in Section 2, totaling 51,000 graphs at each size.
Because these frequency vectors are constrained to the 4-simplex, their distribution can be visualized in R3 with three of the frequencies as axes.
Notice that these graph collections, induced from disparate contexts, all occupy a sharply concentrated subregion of the unit simplex.
The points in the space have been represented simply as an unordered scatterplot, and two striking phenomena already stand out:  rst, the particular concentrated structure within the simplex that the points follow; and second, the fact that we can already discern a nonuniform distribution of the three contexts (neighborhoods, groups and events) within the space   that is, the different contexts can already be seen to have different structural loci.
Notice also that as the sizes of the graphs increases   from 50 to 100 to 200   the distribution appears to sharpen around the one dimensional backbone.
The vast number of graphs that we are able to consider by studying Facebook data is here illuminating a structure that is simply not discernible in previous examinations of sub-graph frequencies [6], since no analysis has previously considered a collection near this scale.
The imagery of Figure 1 directly motivates our work, by visually framing the essence of our investigation: what facets of this curious structure derive from our graphs being social graphs, and what facets are simply universal properties of all graphs?
We will  nd, in particular, that parts of the space of subgraph frequencies are in fact inaccessible to graphs for purely combinatorial reasons   it is mathematically impossible for one of the points in the scatterplot to occupy these parts of the space.
But there are other parts of the space that are mathematically possible; it is simply that no real social graphs appear to be located within them.
Intuitively, then, we are looking at a population density within an ambient space (the Facebook graphs within the space of subgraph frequencies), and we would like to understand both the geography of the inhabited terrain (what are the properties of the areas where the population Also in Figure 1, we plot the curve for the frequencies for 3 node subgraphs in Gn,p as a function of p. The curves are given simply by the probability of obtaining the desired number of edges in a three node graph, ((1   p)3, 3p(1   p)2, 3p2(1   p), p3).
This curve closely tracks the empirical density through the space, with a single notable discrepancy: the real world graphs systemically contain more triangles when compared to Gn,p at the same edge density.
We emphasize that it is not a priori clear why Gn,p would at all be a good model of subgraph frequencies in modestly-sized dense social graphs such as the neighborhoods, groups, and events that we have here; we believe the fact that it tracks the data with any  delity at all is an interesting issue for future work.
Beyond Gn,p, in the following subsection, we present a stochastic model of edge formation and deletion on graphs speci cally designed to close the remaining discrepancy.
As such, our model provides a means of accurately characterizing the backbone of subgraph frequencies for social graphs.
Stochastic model of edge formation.
The classic Erd os-R nyi model of random graphs, Gn,p, produces a distribution over n-node undirected graphs de ned by a simple parameter p, the probability of each edge independently appearing in the graph.
We now introduce and analyze a related random graph model, the Edge Formation Random Walk, de ned as a random walk over the space of all unlabeled n-node graphs.
In its simplest form, this model is closely related to Gn,p, and will we show via detailed balance that the distribution de ned by Gn,p on n-node graphs is precisely the stationary distribution of this simplest version of the random walk on the space of n-node graphs.
We  rst describe this basic version of the model; we then add a component to the model that captures a triadic closure process, which produces a close  t to the properties we observe in real graphs.
Let Gn be the space of all unlabeled n-node graphs, and let X(t) be the following continuous time Markov chain on the state space Gn.
The transition rates between the graphs in Gn are de ned by random additions and deletions of edges, with all edges having a uniform formation rate  > 0 and a uniform deletion rate  >
 rate of edges, completely characterizes the process.
Notice that this process is clearly irreducible, since it is possible to transition between any two graphs via edge additions and deletions.
Since X(t) is irreducible, it possesses a unique stationary distribution.
The stationary distribution of an irreducible continuous time Markov chain can be found as the unique stable  xed point of the linear dynamical system X0(t) = Qn( )X(t) that describes the diffusion of probability mass during a random walk on n-node
    




  +     


  
 +
   )

   +   (
   )  



  + 
 Figure 2: The state transitions diagram for our stochastic graph model with k = 4, where   is the arbitrary edge formation rate,   is the triadic closure formation rate, and   is the edge elimination rate.
graphs, where Qn( ) is the generator matrix with transition rates qij and qii =  Pj6=i qji, all depending only on  .
The stationary distribution  n then satis es Qn( ) n = 0.
The following proposition shows the clear relationship between the stationary distribution of this simplest random walk and the frequencies of Gn,p.
PROPOSITION 3.1.
The probabilities assigned to (unlabeled) graphs by Gn,p satisfy the detailed balance condition for the Edge Formation Random Walk with edge formation rate   = p/1   p, and thus characterizes the stationary distribution.
PROOF.
We  rst describe an equivalent Markov chain based on labeled graphs: there is a state for each labeled n-node graph; the transition rate qij from a labelled graph Gi to a labelled graph Gj is qij =   if Gj can be obtained from Gi by adding an edge; and qij =   if Gj can be obtained from Gi by removing an edge.
All other transition rates are zero.
We call this new chain the labeled chain, and the original chain the unlabeled chain.
Now, suppose there is a transition from unlabeled graph Ha to unlabeled graph Hb in the unlabeled chain, with transition probability k .
This means that there are k ways to add an edge to a labeled copy of Ha to produce a graph isomorphic to Hb.
Now, let Gi be any graph in the labeled chain that is isomorphic to Ha.
In the labeled chain, there are k transitions out of Gi leading to a graph isomorphic to Hb, and each of these has probability  .
Thus, with probability k , a transition out of Gi leads to a graph isomorphic to Hb.
A strictly analogous argument can be made for edge deletions, rather than edge additions.
This argument shows that the following describes a Markov chain equivalent to the original unlabeled chain: we draw a sequence of labeled graphs from the labeled chain, and we output the isomor-phism classes of these labeled graphs.
Hence, to compute the stationary distribution of the original unlabeled chain, which is what we seek, we can compute the stationary distribution of the labeled chain and then sum stationary probabilities in the labeled chain over the isomorphism classes of labeled graphs.
It thus suf ces to verify the detailed balance condition for the distribution on the labeled chain that assigns probability p|E(Gi)|(1   p)(n
 the labeled walk occurs between two labeled graphs Gi and Gj, with |E(Gi)| = |E(Gj)| + 1, the only nontrivial detailed balance equations are of the form: qijPr[X(t) = Gi] =q jiPr[X(t) = Gj] Pr[X(t) = Gi] =  Pr[X(t) = Gj] Pr[X(t) = Gi] = Pr[X(t) = Gj].
p 1   p Since the probability assigned to the labeled graph Gi by Gn,p is simply p|E(Gi)|(1   p)(n
 is ed.
Incorporating triadic closure.
The above modeling framework provides a simple analog of Gn,p that notably exposes itself to subtle adjustments.
By simply adjusting the transition rates between select graphs, this framework makes it possible to model random graphs where certain types of edge formations or deletions have irregular probabilities of occurring, simply via small perturbations away from the classic Gn,p model.
Using this principle, we now characterize a random graph model that differs from Gn,p by a single parameter,  , the rate at which 3-node paths in the graph tend to form triangles.
We call this model the Edge Formation Random Walk with Triadic Closure.
Again let Gn be the space of all unlabeled n-node graphs, and let Y (t) be a continuous time Markov chain on the state space Gn.
As with the ordinary Edge Formation Random Walk, let edges have a uniform formation rate  > 0 and a uniform deletion rate  > 0, but now also add a triadic closure formation rate     0 for every 3-node path that a transition would close.
The process is still clearly irreducible, and the stationary distribution obeys the stationary conditions Qn( ,  ) n = 0, where the generator matrix Qn now also depends on  .
We can express the stationary distribution directly in the parameters as  n( ,  ) ={   : Qn( ,  )  = 0}.
For   = 0 the model reduces to the ordinary Edge Formation Random Walk.
The state transitions of this random graph model are easy to construct for n = 3 and n = 4, and transitions for the case of n = 4 are shown in Figure 2.
Proposition 3.1 above tells us that for   = 0, the stationary distribution of a random walk on this state space is given by the graph frequencies of Gn,p.
As we increase   away from zero, we should therefore expect to see a stationary distribution that departs from Gn,p precisely by observing more graphs with triangles and less graphs with open triangles.
The framework of our Edge Formation Random Walk makes it possible to model triadic closure precisely; in this sense the model forms an interesting contrast with other models of triangle-closing in graphs that are very challenging to analyze (e.g.
[9, 10]).
We will now show how the addition of this single parameter makes it possible to describe the subgraph frequencies of empirical social graphs with remarkable accuracy.
Fitting subgraph frequencies.
The stationary distribution of an Edge Formation Random Walk model describes the frequency of different graphs, while the coordinate system we are developing focuses on the frequency of k-node subgraphs within n-node graphs.
For Gn,p these two questions are in fact the same, since the distribution of random induced k-node subgraphs of Gn,p is simply Gk,p.
When we introduce  > 0, however, our model departs from this symmetry, and the stationary probabilities in a random walk on k node graphs is no longer precisely the frequencies of induced k-node subgraphs in a single n-node graph.
But if we view this as a model for the frequency of small graphs as objects in themselves, rather than as subgraphs of a larger ambient graph, the model provides a highly tractable parameterization


 .
    .
Neighborhoods, n=50                 Neighborhoods data, mean Fit model,     = 19.37 Gnp   model Gnp       Groups, n=50                       Groups data, mean Fit model,     = 7.02 Gnp   model Gnp         Events, n=50                 Events data, mean Fit model,     = 7.38 Gnp   model Gnp       y c n e u q e r f y c n e u q e r f


 .
.
.
.
.
.
.
.
.
.
y c n e u q e r f Figure 4: The four-node subgraph frequencies for the means of the 50-node graph collections in Figure 3, and the subgraph frequency of the model,  tting the triadic closure rate   to the mean vectors.
As   increases from   = 0 to   =  opt, we see how this single additional parameter provides a striking  t.
remarkable how precisely the model describes the scarcity of the four-node cycle.
The scarcity of squares has been previously observed in email neighborhoods on Facebook [18], and our model provides the  rst intuitive explanation of this scarcity.
The model s ability to characterize the backbone of the empirical graph frequencies suggests that the subgraph frequencies of individual graphs can be usefully studied as deviations from this backbone.
In fact, we can interpret the  tting procedure for   as a variance minimization procedure.
Recall that the mean of a set of points in Rn is the point that minimizes the sum of squared residuals.
In this way, the procedure is in fact  tting the  mean curve  of the model distribution to the empirical subgraph frequencies.
Finally, our model can be used to provide a measure of the tri-adic closure strength differentially between graph collections, investigating the difference in  opt for the subgraph frequencies of different graph collections.
In Figure 4, the three different graph types resulted in notably different ratios of  /    the ratio of the triadic closure formation rate to the basic process rate   with a signi cantly higher value for this ratio in neighborhoods.
We can interpret this as saying that open triads in neighborhoods are more prone to triadic closure than open triads in groups or events.
As discussed at the beginning of the previous section, we face two problems in analyzing the subgraph frequencies of real graphs: to characterize the distribution of values we observe in practice, and to understand the combinatorial structure of the overall space in Figure 3: Subgraph frequencies for 3-node subgraphs in 50-node graphs, shown as a function of p. The black curves illustrate Gn,p, while the yellow curves illustrate the  t model.
that we can use to approximate the structure of subgraph frequencies observed in our families of larger graphs.
In doing so, we aim to  t  k( (p,  ),  ) as a function of p, where  (p,  ) is the rate parameter   that produces edge density p for the speci c value of  .
For   = 0 this relationship is simply   = p/(1   p), but for  >0 the relation is not so tidy, and in practice it is easier to  t   numerically rather than evaluate the expression.
When considering a collection of graph frequencies we can  t   by minimizing residuals with respect to the model.
Given a collec-k be the vectors of k-node subgraph tion of N graphs, let y1 frequencies for each graph and p1, .
.
.
, pN be the edge densities.
We can then  t   as: k, .
.
.
, yN  opt k = arg min   || k( (pi,  ),  )   yi k||2.
NXi=1 k ),  opt In Figure 3 we plot the three-node subgraph frequencies as a function of edge density p, for a collection of 300,000 50-node subgraphs, again a balanced mixture of neighborhoods, groups, and events.
In this  gure we also plot (in yellow) the curve resulting from  tting our random walk model with triadic closure,  k( (p,  opt k ), which is thus parameterized as a function of edge density p. For this mixture of collections and k = 3, the optimal  t is  opt
 from the black Gn,p curve to better represent the backbone of natural graph frequencies.
From the  gure it is clear that almost all graphs have more triangles than a sample from Gn,p of corresponding edge density.
When describing extremal bounds in Section 4, we will discuss how Gn,p is in fact by no means the extremal lower bound.
As suggested by Figure 2, examining the subgraph frequencies for four-node subgraphs is fully tractable.
In Figure 4, we  t   to the mean subgraph frequencies of our three different collections of graphs separately.
Note that the mean of the subgraph frequencies over a set of graphs is not necessarily itself a subgraph frequency corresponding to a graph, but we  t these mean 11-vectors as a demonstration of the model s ability to  t an  average  graph.
The subgraph frequency of Gn,p at the edge density corresponding to the data is shown as a black dashed line in each plot   with poor agreement   and gray dashed lines illustrate an incremental transition in  , starting from zero (when it corresponds to Gn,p) and ending at  opt.
The striking agreement between the  t model and the mean of each collection is achieved at the corresponding edge density by  tting only  .
For neighborhood graphs, this agreement deviates measurably on only a single subgraph frequency, the four-node star.
The y-axis is plotted on a logarithmic scale, which makes it rather
 stochastic models to address the former question, we now consider the latter question.
Speci cally, in this section we characterize extremal bounds on the set of possible subgraph frequencies.
Using machinery from the theory of graph homomorphisms, we identify fundamental bounds on the space of subgraph frequencies that are not properties of social graphs, but rather, are universal properties of all graphs.
By identifying these bounds, we make apparent large tracts of the feasible region that are theoretically inhabitable but not populated by any of the empirical social graphs we examine.
We  rst review a body of techniques based in extremal graph theory and the theory of graph homomorphisms [11].
We use these techniques to formulate a set of inequalities on subgraph frequencies; these inequalities are all linear for a  xed edge density, an observation that allows us to cleanly construct a linear program to maximize and minimize each subgraph frequency within the combined constraints.
In this manner, we show how it is possible to map outer bounds on the geography of all these structural constraints.
We conclude by offering two basic propositions that transcend all edge densities, thus identifying fundamental limits on subgraph frequencies of all sizes.
homomorphism density In this subsection, we review some background arising from the theory of graph homomorphisms.
We will use this homomorphism machinery to develop inequalities governing subgraph frequencies.
These inequalities allow us to describe the outlines of the space underlying Figure 1(a)   the  rst step in understanding which aspects of the distribution of subgraph frequencies in the simplex are the result of empirical properties of human social networks, and which are the consequences of purely combinatorial constraints.
Linear constraints on subgraph frequency.
Let s(F, G) denote the subgraph frequency of F in G, as de ned in the last section: the probability that a random |V (F )|-node subset of G induces a copy of F .
Note that since s(F, G) is a probability over outcomes, it is subject to the law of total probability.
The law of total probability for subgraph frequencies takes the following form.
PROPOSITION 4.1.
For any graph F and any integer `   k, where |V (F )| = k, the subgraph density of F in G, s(F, G) satis- es the equality s(F, G) = X{H:|V (H)|=`} s(F, H)s(H, G).
PROOF.
Let H0 be a random `-vertex induced subgraph of G.
Now, the set of outcomes H = {H : |V (H)| = `} form a partition of the sample space, each with probability s(H, G).
Furthermore, conditional upon an `-vertex induced subgraph being isomorphic to H, s(F, H) is the probability that a random k-vertex induced subgraph of H is isomorphic to F .
This proposition characterizes an important property of subgraph frequencies: the vector of subgraph frequencies on k nodes exists in a linear subspace of the vector of subgraph frequencies on `> k nodes.
Furthermore, this means that any constraint on the frequency of a subgraph F will also constrain the frequency of any subgraph H for which s(F, H) > 0 or s(H, F ) > 0.
Graph homomorphisms.
A number of fundamental inequalities on the occurrence of subgraphs are most naturally formulated in terms of graph homomorphisms, a notion that is connected to but distinct from the notion of induced subgraphs.
In order to describe this machinery, we  rst review some basic de nitions [4].
if F and G are labelled graphs, a map f : V (F ) !
V (G) is a homomor-phism if each edge (v, w) of F maps to an edge (f (v), f (w)) of G.
We now write t(F, G) for the probability that a random map from V (F ) into V (G) is a homomorphism, and we refer to t(F, G) as a homomorphism density of F and G.
There are three key differences between the homomorphism density t(F, G) and the subgraph frequency s(F, G) de ned earlier in this section.
First, t(F, G) is based on mappings of F into G that can be many-to-one   multiple nodes of F can map to the same node of G   while s(F, G) is based on one-to-one mappings.
Second, t(F, G) is based on mappings of F into G that must map edges to edges, but impose no condition on pairs of nodes in F that do not form edges: in other words, a homomorphism is allowed to map a pair of unlinked nodes in F to an edge of G. This is not the case for s(F, G), which is based on maps that require non-edges of F to be mapped to non-edges of G. Third, t(F, G) is a frequency among mappings from labeled graphs F to labelled graphs G, while s(F, G) is a frequency among mappings from unlabeled F to unlabeled G.
From these three differences, it is not dif cult to write down a basic relationship governing the functions s and t [4].
To do this, it is useful to de ne the intermediate notion tinj(F, G), which is the probability that a random one-to-one map from V (F ) to V (G) is a homomorphism.
Since only an O(1/V (G)) fraction of all maps from V (F ) to V (G) are not one-to-one, we have t(F, G) = tinj(F, G) +O (1/|V (G)|).
(1) Next, by de nition, a one-to-one map f of F into G is a homomor-phism if and only if the image f (F ), when viewed as an induced subgraph of G, contains all of F  s edges and possibly others.
Correcting also for the conversion from labelled to unlabeled graphs, we have tinj(F, G) = XF 0:F F 0 ext(F, F 0)   aut(F 0) k!
  s(F 0, G), (2) where aut(F 0) is the number of automorphisms of F 0 and ext(F, F 0) is the number of ways that a labelled graph F can be extended (by adding edges) to form a labelled graph H isomorphic to F 0.
Homomorphism inequalities.
There are a number of nontrivial results bounding the graph homomorphism density, which we now review.
By translating these to the language of subgraph frequencies, we can begin to develop bounds on the simplexes in Figure 1.
For complete graphs, the Kruskal-Katona Theorem produces upper bounds on homomorphism density in terms of the edge density while the Moon-Moser Theorem provides lower bounds, also in terms of the edge density.
(KRUSKAL-KATONA [11]).
For a complete graph Kr on r nodes and graph G with edge density t(K2, G), t(Kr, G)   t(K2, G)r/2.
(MOON-MOSER [12, 16]).
For a complete graph Kr on r nodes and graph G with edge density t(K2, G) 2 [(k   2)/(k   1), 1], t(Kr, G)   r 1Yi=1 (1   i(1   t(K2, G))).
has recently given an impressive sharp lower bound for the homo-morphism density of the triangle K3 [16] using sophisticated machinery [15].
We limit our discussion to the simpler Moon-Moser lower bound which takes the form of a concise polynomial and provides bounds for arbitrary r, not just the triangle (r = 3).
Finally, we employ a powerful inequality that is known to lower bound the homomorphism density of any graph F that is either a forest, an even cycle, or a complete bipartite graph.
Stated as such, it is the solved special cases of the open Sidorenko Conjecture, which posits that the result could be extended to all bipartite graphs F .
We will use the following proposition in particular when F is a tree, and will refer to this part of the result as the Sidorenko tree bound.
(SIDORENKO [11, 17]).
For a graph F that is a forest, even cycle, or complete bipartite graph, with edge set E(F), and G with edge density t(K2, G), t(F, G)   t(K2, G)|E(F )|.
Using Equations (1) and (2), we can translate statements about homomorphisms into asymptotic statements about the combined frequency of particular sets of subgraphs.
We can also translate statements about frequencies of subgraphs to frequencies of their complements using the following basic fact.
LEMMA 4.5.
If for graphs F1, .
.
.
F`, coef cients  i 2 R, and a function f,  1s(F1, G) +.
.
.
+  `s(F`, G)   f (s(K2, G)), 8G, then  1s(F 1, G) +.
.
.
+  `s(F `, G)   f (1   s(K2, G)), 8G.
PROOF.
Note that s(F, G) = s(F , G).
Thus if  1s(F 1, G) +.
.
.
+  `s(F `, G)   f (s(K 2, G)), 8G, then  1s(F 1, G) +.
.
.
+  `s(F `, G)   f (s(K 2, G)), 8G, where s(K 2, G) = 1   s(K2, G).
In the previous section, we reviewed linear constraints between the frequencies of subgraphs of different sizes, and upper and lower bounds on graph homomorphism densities with applications to sub-graph frequencies.
We will now use these constraints to assemble a linear program capable to mapping out bounds on the extremal geography of the subgraph space we are considering.
To do this, we will maximize and minimize the frequency of each individual sub-graph frequency, subject to the constraints we have just catalogued.
We will focus our analysis on the cases k = 3, the triad frequencies, and k = 4, the quad frequencies.
Let x1, x2, x3, x4 denote the subgraph frequencies s( , G) of the four possible 3-vertex undirected graphs, ordered by increasing edge count.
PROGRAM 4.6.
The frequency xi of a 3-node subgraph in any graph G with edge density p is bounded asymptotically (in |V (G)|) by max / min xi subject to xi   0,8i and: x2 + (3) x1 + x2 + x3 + x4 = 1, x4   p3/2, x4   p(2p   1) x1   (1   p)(1   2p) (1/3)x3 + x4   p2,


 x3 + x4 = p,
 x1   (1   p)3/2, p   1/2, p   1/2, x1 + (1/3)x2   (1   p)2.
(4) (5) (6) (7) Here the equalities in (3) derive from the linear constraints, the constraints in (4) derive from Kruskal-Katona, the constraints (5-
the Sidorenko tree bound.
More generally, we obtain the following general linear program that can be used to  nd nontrivial bounds for any subgraph frequency: PROGRAM 4.7.
The frequency fF of a k-node subgraph F in any graph G with edge density p is bounded asymptotically (in |V (G)|) by max / min fF , subject to AfF = b(p), CfF   d(p), appropriately assembled.
From Program 1 given above it is possible to derive a simple upper bound on the frequency of the 3-node-path (sometimes described in the social networks literature as the  forbidden triad , as mentioned earlier).
PROPOSITION 4.8.
The subgraph frequency of the 3-node-path F obeys s(F, G)   3/4 +o(1), 8G.
PROOF.
Let x1, x2, x3, x4 again denote the subgraph frequencies s( , G) of the four possible 3-vertex undirected graphs, ordered by increasing edge count, where x3 is the frequency of the 3-node-path.
By the linear constraints, (1/3)x2 + (2/3)x3 + x4 = p, while by Moon-Moser, x4 + O(1/|V (G)|)   p(2p  1).
Combining these two constraints we have: x3   3p(1   p) +o (1).
The polynomial in p is maximized at p = 1/2, giving an upper bound of 3/4 +o(1).
This bound on the  forbidden triad  is immediately apparent from Figure 5 as well, which shows the bounds constructed via linear programs for all 3-node and 4-node subgraph frequencies.
In fact, the subgraph frequency of the  forbidden  3-node-path in the balanced complete bipartite graph Kn/2,n/2, which has edge density p = 1/2, is exactly s(F, G) = 3/4, demonstrating that this bound is asymptotically tight.
(In fact, we can perform a more careful analysis showing that it is exactly tight for even n.) Figure 5 illustrates these bounds for k = 3 and k = 4.
Notice that our empirical distributions of subgraph frequencies fall well within these bounds, leaving large tracts of the bounded area uninhabited by any observed dense social graph.
While the bounds do not fully characterize the feasible region of subgraph frequencies, the fact that the bound is asymptotically tight at p = 1/2 for the complete bipartite graph Kn/2,n/2 is important   practically no empirical social graphs come close to the boundary, despite this evidence that it is feasibly approachable.
We emphasize that an exact characterization of the feasible space would necessitate machinery at least as sophisticated as that used by Razborov.
In the next subsection we develop two more general observations about the subgraph frequencies of arbitrary graphs, the latter of which illustrates that, with the exception of clique subgraphs and empty subgraphs, it is always possible to be free from a subgraph.
This shows that the lower regions of the non-clique nonempty frequency bounds in Figure 5 are always inhabitable, despite the fact that social graphs do not empirically populate these regions.
The upper bound for the frequency of the 3-node-path given in Proposition 4.8 amounted to simply combining appropriate upper bounds for different regions of possible edge densities p. In this
 asymptotically feasible region found via the linear program.
The empirical frequencies are as in Figure 3.
The black curves illustrate Gn,p, while the yellow curves illustrate the  t triadic closure model.
section, we provide two general bounds pertaining to the subgraph frequency of an arbitrary subgraph F .
First, we show that any sub-graph that is not a clique and is not empty must have a subgraph density bounded strictly away from one.
Second, we show that for every subgraph F that is not a clique and not empty, it is always possible to construct a family of graphs with any speci ed asymptotic edge density p that contains no induced copies of F .
With regard to Figures 5, the  rst of the results in this subsection uses the Sidorenko tree bound to show that in fact no subgraph other than the clique or the empty graph, not even for large values of k, has a feasible region that can reach a frequency of 1   o(1).
The second statement demonstrates that it is always possible to be free of any subgraph that is not a clique or an empty graph, even if this does not occur in the real social graphs we observe.
PROPOSITION 4.9.
For every k, there exist constants " and n0 such that the following holds.
If F is a k-node subgraph that is not a clique and not empty, and G is any graph on n   n0 nodes, then s(F, G) < 1   ".
PROOF.
Let Sk denote the k-node star   in other words the tree consisting of a single node linked to k   1 leaves.
By Equation (1), if G has n nodes, then tinj(Sk, G)   t(Sk, G) c/n for an absolute constant c. We now state our condition on " and n0 in the statement of the proposition: we choose " small enough and n0 large enough so that For a k-node graph F , let P(F ) denote the property that for all graphs G on at least n0 nodes, we have s(F, G) < 1   ".
Our 2 k 1 > max ", (1   ")k 2 k c n  .
(8) goal is to show that P(F ) holds for all k-node F that are neither the clique nor the empty graph.
We observe that since s(F, G) = s(F , G), the property P(F ) holds if and only if P(F ) holds.
The basic idea of the proof is to consider any k-node graph F that is neither complete nor empty, and to argue that the star Sk lacks a one-to-one homomorphism into at least one of F or F   suppose it is F .
The Sidorenko tree bound says that Sk must have a nontrivial number of one-to-one homomorphisms into G; but the images of these homomorphisms must be places where F is not found as an induced subgraph, and this puts an upper bound on the frequency of F .
We now describe this argument in more detail; we start by considering any speci c k-node graph F that is neither a clique nor an empty graph.
We  rst claim that there cannot be a one-to-one homomorphism from Sk into both of F and F .
For if there is a one-to-one homomorphism from Sk into F , then F must contain a node of degree k   1; this node would then be isolated in F , and hence there would be no one-to-one homomorphism from Sk into F .
Now, since it is enough to prove that just one of P(F ) or P(F ) holds, we choose one of F or F for which there is no one-to-one homomorphism from Sk.
Renaming if necessary, let us assume it is F .
Suppose by way of contradiction that s(F, G)   1   ".
Let q
 denote the edge density of F   that is, q = |E(F )|/ k density p of G can be written, using Proposition 4.1, as p = s(K2, G) = X{H:|V (H)|=k} s(K2, H)s(H, G)   s(K2, F )s(F, G)   q(1   ").
k-sets of G according to the following rule.
Let U be a k-set of G: we color U blue if G[U ] is isomorphic to F , and we color U red if there is a one-to-one homomorphism from Sk to G[U ].
We leave the k-set uncolored if it is neither blue nor red under these rules.
We observe that no k-set U can be colored both blue and red, for if it is blue, then G[U ] is isomorphic to F , and hence there is no one-to-one homomorphism from Sk into G[U ].
Also, note that s(F, G)   1   " is equivalent to saying that at least a (1   ") fraction of all k-sets are blue.
Finally, what fraction of k-sets are red?
By the Sidorenko tree bound, we have t(Sk, G)   pk 1   qk(1   ")k   (1   ")k 2 k 1 ,  k tinj(Sk, G)   where the last inequality follows from the fact that F is not the empty graph, and hence q   1/ k c/n, our condition on n from (8) implies that
 (1   ")k 2 k 1 >".
2 k Now, let inj(Sk, G) denote the number of one-to-one homomor-phisms of Sk into G; by de nition, inj(Sk, G) inj(Sk, G) , = and hence tinj(Sk, G) = n(n   1) ( n   k + 1) inj(Sk, G) = k!
n k! n k  k!tinj(Sk, G) >"k !
n k!.
to the same k-set of G, and hence more than " n k  many k-sets of G are red.
It follows that the fraction of k-sets that are red is >" ; but this contradicts our assumption that at least a (1   ") fraction of k-sets are blue, since no k-set can be both blue and red.
Now, at most k!
different one-to-one homomorphisms can map Sk PROPOSITION 4.10.
Assume F is not a clique and not empty.
Then for each edge density p there exists a sequence Gp
 of asymptotic edge density p for which F does not appear as an induced subgraph in any Gp i .
Equivalently, s(F, Gp
 i ) = 0,8i.
PROOF.
We call H a near-clique if it has at most one connected component of size greater than one, and this component is a clique.
For any p 2 [0, 1], it is possible to construct an in nite sequence
 H p 2 , .
.
.
of near-cliques with asymptotic density p, by simply taking the nontrivial component of each H p i to be a clique of the appropriate size.
Now,  x any p 2 [0, 1], and let F be any graph that is neither a clique nor an empty graph.
If F is not a near-clique, then the required sequence Gp 2, .
.
.
is the sequence of near-cliques H p 2 , .
.
., since all the induced subgraphs of a near-clique are themselves near-cliques.
On the other hand, if F is a near-clique, then since F is neither a clique nor an empty graph, the complement of F is not a near-clique.
It follows that the required sequence Gp 2, .
.
.
is the se- quence of complements of the near-cliques H 1 p

 , H 1 p
 , .
.
..
Note that it is possible to take an F free graph with asymptotic density p and append nodes with local edge density p and random (Erd os-R nyi) connections to obtain a graph with any intermediate subgraph frequency between zero and that of Gn,p.
The same blending arguement can be applied to any graph with a subgraph frequency above Gn,p to again  nd graphs with intermediate sub-graph frequencies.
In this way we see that large tracts of the sub-graph frequency simplex are fully feasible for arbitrary graphs, yet by Figure 5 are clearly not inhabited by any real world social graph.
The previous two sections characterize empirical and extremal properties of the space of subgraph frequencies, providing two complementary frameworks for understanding the structure of social graphs.
In this section, we conclude our work with a demonstration of how subgraph frequencies can also provide a useful tool for distinguishing between different categories of graphs.
The Edge Formation Random Walk model introduced in Section 3  gures notably, providing a meaningful baseline for constructing classi cation features, contributing to the best overall classi cation accuracy we are able to produce.
Thus, concretely our classi cation task is to take a social graph and determine whether it is a node neighborhood, the set of people in a group, or the set of people at an event.
This is a speci c version of a broader characterization problem that arises generally in social media   namely how social audiences differ in terms of social graph structure [1].
Each of the three graph types we discuss   neighborhoods, groups, and events   de ne an audience with which a user may choose to converse.
The de ning feature of such audience decisions has typically been their size   as users choose to share something online, do they want to share it publicly, with their friends, or with a select subgroup of their friends?
Products such as Facebook groups exist in part to address this audience problem, enabling the creation of small conversation circles.
Our classi cation task is essentially asking: do audiences differ in meaningful structural ways other than just size?
In Figure 1 and subsequently in Figure 5, we saw how the three types of graphs that we study   neighborhoods, groups, and events   are noticeably clustered around different structural foci in the space of subgraph frequencies.
Figure 5 focused on graphs consisting of exactly 50-nodes, where it is visibly apparent that both neighborhoods and events tend to have a lower edge density than groups of that size.
Neighborhood edge density   equivalent to the local clustering coef cient   is known to generally decrease with graph size [13, 19], but it is not clear that all three of the graph types we consider here should decrease at the same rate.
In Figure 6, we see that in fact the three graph types do not decrease uniformly, with the average edge density of neighborhoods decreasing more slowly than groups or events.
Thus, small groups are denser than neighborhoods while large groups are sparser, with the transition occurring at around 400 nodes.
Similarly, small event graphs are denser than neighborhoods while large events are much sparser, with the transition occurring already at around 75 nodes.
The two crossing points in Figure 6 suggest a curious challenge: are their structural features of audience graphs that distinguish them from each other even when they exhibit the same edge density?
Here we use the language of subgraph frequencies developed in this work to formulate a classi cation task for classifying audience graphs based on subgraph frequencies.
We compare our classi cation accuracy to the accuracy achieved when also considering a generous vector of much more sophisticated graph features.
We approach this classi cation task using a simple logistic regression model.
While more advanced machine learning models capable of learning richer relationships would likely produce better classi cation accuracies, our goal here is to establish that this vocabulary of features based on subgraph frequencies can produce nontrivial classi cation results even in conjunction with simple techniques such as logistic regression.
.
.
.
.
.
y t i s n e d e g d e e g a r e v
 Neighborhoods Neighborhoods + ego Groups Events







 size Figure 6: Edge densities of neighborhoods, groups, and events as a function of size, n. When n < 400, groups are denser then neighborhoods.
When n < 75, events are denser then neighborhoods.
When considering neighborhood graphs, recall that we are not including the ego of the neighborhoods as part of the graph, while for groups and events the administrators as members of their graphs.
As such, neighborhoods without their ego deviate systematically from analogous audience graphs created as groups or as events.
In Figure 6 we also show the average edge density of neighborhoods with their ego, adding one node and n   1 edges, noting that the difference is small for larger graphs.
Classi cation features.
Subgraph frequencies has been the motivating coordinate system for the present work, and will serve as our main feature set.
Employing the Edge Formation Random Walk model from Section 3, we additionally describe each graph by its residuals with respect to a backbone   described by the parameter      t to the complete unclassi ed training set.
Features based on subgraph frequencies are local features, com-putable by examining only a few local nodes of the graph at a time.
Note that the subgraph frequencies of arbitrarily large graphs can be accurately approximated by sampling a small number of induced graphs.
Comparatively, it is relevant to ask: can these simple local features do as well as more sophisticated global graph features?
Perhaps the number of connected components, the size of the largest component, or other global features provide highly informative features for graph classi cation.
To answer this question, we compare our classi cation accuracy using subgraph frequencies with the accuracy we are able to achieve using a set of global graph features.
We consider:   Size of the k largest components, for k = 1, 2.
  Size of the k-core, for k = 0, 1, 2, 3.
  Number of components in the k-core, for k = 0, 1, 2.
  Degeneracy, the largest k for which the k-core is nonempty.
  Size of the k-brace [18], for k = 1, 2, 3.
  Number of components in the k-brace, for k = 1, 2, 3.
These features combine linearly to produce a rich set of graph properties.
For example, the number of components in the 1-core minus the number of components in the 0-core yields the number of singletons in the graph.
Classi cation results.
The results of the classi cation model are shown in Table 1, reported in terms of classi cation accuracy   the fraction of correct classi cations on the test data   measured using  ve-fold cross-validation on a balanced set of 10,000 instances.
The classi cation tasks were chosen to be thwart classi cation based solely on edge density, which indeed performs poorly.
Model Features Edges Triads Triads + RG Triads + R  Quads Quads + RG Quads + R  Global + Edges Global + Triads Global + Triads + RG Global + Triads + R  Global + Quads Global + Quads + RG Global + Quads + R  N vs. E, n = 75 N vs. G, n = 400



























 Table 1: Classi cation accuracy for N(eighborhoods), G(roups), and E(vents) on different sets of features.
RG and R  denote the residuals with respect to a Gn,p and stochastic graph model baseline, as described in the text.
Using only 4-node subgraph frequencies and residuals, an accuracy of 77% is achieved in both tasks.
In comparison, classi cation based on a set of global graph features performed worse, achieving just 69% and 76% accuracy for the two tasks.
Meanwhile, combining global and subgraph frequency features performed best of all, with a classi cation accuracy of 81 82%.
In each case we also report the accuracy with and without residuals as features.
Incorporating residuals with respect to either a Gn,p or Edge Formation Random Walk baseline consistently improved classi cation, and examining residuals with respect to either baseline clearly provides a useful orientation of the subgraph coordinate system for empirical graphs.
The modern study of social graphs has primarily focused on the examination of the sparse large-scale structure of human relationships.
This global perspective has led to fruitful theoretical frameworks for the study of many networked domains, notably the world wide web, computer networks, and biological ecosystems [13].
However, in this work we argue that the locally dense structure of social graphs admit an additional framework for analyzing the structure of social graphs.
In this work, we examine the structure of social graphs through the coordinate system of subgraph frequencies, developing two complementary frameworks that allow us to identify both  social  structure and  graph  structure.
The framework developed in Section 3 enables us to characterize the apparent social forces guiding graph formation, while the framework developed in Section 4 characterizes fundamental limits of all graphs, delivered through combina-torial constraints.
Our coordinate system and frameworks are not only useful for developing intuition, but we also demonstrate how they can be used to accurately classify graph types using only these simple descriptions in terms of subgraph frequency.
Distribution note.
Implementations of the Edge Formation Random Walk equilibrium solver and the subgraph frequency extremal bounds optimization program are available from the  rst author s webpage.
Acknowledgments.
This work was supported in part by NSF grants IIS-0910664 and IIS-1016099.
