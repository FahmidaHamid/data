The Web is organized by entities.
Entity search, that is, returning  object  (e.g., people, media objects, locations, products, organizations, etc.)
in response to users  information needs, has received considerable attention recently in various research communities.
In social media communities, such as Flickr, YouTube and Facebook, people are sharing their experiences and interests through substantial amounts of various contents, such as photos, videos, people, tags, geo-locations and documents, which are referred to entities in this paper.
In addition, these contents are strong correlated by a wide variety of social behaviors, e.g., tagging, commenting, and joining communities.
With the large-scale, heterogeneous and correlative sets of data available, there has been increasing expectation for mechanisms that organize and search these entities e ectively and e ciently in social networks.
To motivate, consider following scenarios, for user Henry who likes taking photographs at the seaside.
Scenario 1 (friend suggestion): Henry wants to  nd friends who have the similar interests to himself.
To begin with, he may use the keywords like  seaside  as the query to  nd some photos in Flickr, and then he needs to sift through the photostream (all photos shared by a user) of photographers one by one and dig out the interesting ones as his friends.
This overall process can be unnecessarily time consuming.
Scenario 2 (image (geo-)tagging): Henry sees a beautiful picture when he browses a webpage and he wants to know where this picture was taken.
He may formulate some descriptive words to search similar images via web image search engines and then read through the surrounding words, but it is hard to  nd the duplicate images in this way due to the sheer volume of Internet images.
Scenario 3 (personalized image search): Henry wants to search photos with sunrise scene.
He may use  sunrise  as the query in a web image search engine and many images with sunrise scene are returned.
But Henry prefers photos taken by the seaside, to get his expected photos he might have to go through all the images, or formulate the other
 be a very laborious process.
In these scenarios, like every user in many similar situations, Henry is looking for a particular type of entities not pages as  relevant documents  to read.
This demand has challenged us to face a dilemma: on one hand, the proliferating data on the Internet leads to surge of research activities in social media search, for instance, personalized image search [12][15][19], tag ranking [10], Yahoo people search [20], friend suggestion [8][14][22], and ImageCLEF (Image Retrieval in CLEF) [5].
All of these social media searches are independent and each of them is designed especially for searching a certain type of entities; on the other hand, in real-world social media communities, these existing entities always in uence each other in explicit or implicit way.
As in scenarios mentioned above, people always look for entities by using the other types of entities; that is to say, the various entity searches are essentially closely related, and the common goal is to discover the relationships among these entities.
Therefore, it is more natural and e cient to develop a uni ed framework which can accomplish these entity searches in a single way, which directly motivates our work in this paper.
Towards this goal, we propose a multilevel graph model to integrate all the entities together.
The relevance of an entity for a given query is estimated by the cost of nearest navigated route.
As shown in Fig.1(b), the red lines with arrows present a navigated route from query q to entity vb k (will be described in De nition 1) in a three-level graph.
The cost comes from two sources, i.e., intra-relation between every two same types of entities in each level of graph, and interlink across di erent types of entities in every two levels of graphs.
To leverage the two sources of the route cost, the entity search is formulated from the probabilistic perspective in a Bayesian framework.
The intra-relations of entities within the searching pool are modeled as a conditional prior which indicates the ranking score consistency between similar entities; and the interlinks are modeled as a likelihood which re ects the correspondence of the query and entities in searching pool.
In the Bayesian framework, the entity search is formulated as maximizing the product of the conditional prior and the likelihood.
The foundation of the uni ed entity search is the proposed circular propagation which iterative-ly re nes the intra-relations of entities, through exchanging information across di erent entity types in a cyclic manner.
Instead of exploring similarity metrics used in existing entity search, the procedure encourages interaction among multiple entities to seek for consensus that are useful for entity search.
Fig.1 illustrates the uni ed entity search framework based on the proposed integral multilevel graph.
The main contributions of this work can be summarized as follows:   We propose to integrate various types of entities in a multilevel graph model, upon which multiple social media applications can be implemented in a single way.
  We propose the circular propagation to exchange information across di erent entity types in a cyclic manner.
In this way, the relationships of various entities are mutually reinforced and re ned.
  We explicitly formulate entity search as a global optimization problem in a Bayesian framework, which well leverages the various relationships in social media community.
The remaining sections are organized as follows.
Section
 multilevel graph construction including circular propagation and its convergence property, while Section 4 formulates the problem of uni ed entity search and its solution over the integral graph.
Section 5 takes a popular photo-sharing site as an example to detail the entity graph constructed from a social media community.
Section 6 provides empirical justi- cations, followed by the conclusions in Section 7.
We brie y group the related works into two categories: search in social media community and multi-modality fusion.
The former draws upon research in searching over extracted entities in social media community, and the later learns the contribution of a modality (entity) in social search applications.
There exists rich research on search in social media community, such as friend suggestion (user search), image tagging (tag search) and personalized image search (image search).
Finding potential friends with similar interest will improve photo-sharing and browsing experiences in the social community.
Roth et al. suggest friends based on an implicit social graph, which is formed by user interaction with contacts and groups of contacts [14].
In another work by Li [8], user similarity is  rstly mined by using location et al.
history and then potential friends are recommended.
As an online people search service, Yahoo people search [20] is to  nd friends and family with whom people have lost touch.
People can employ it to search for friends using name and location or phone numbers, or search using email addresses.
Attaching textual or semantic linkage to images will significantly facilitate Web image search and organization.
Li et al. [7] present a real-time automatic image tagging method.
The method takes as input a set of labeled images and tries to learn which low level visual features correspond to higher level semantic labels.
The mapping can then be applied to annotate the new unlabeled images.
Similar in spirit, Chen et al. [1] propose a tag recommendation approach that directly predicts the possible tags with models learned from training data.
Therefore, the approach can only recommend the tags from a prede ned set.
Later in [10], Liu et al.  rst estimate relevance scores for the tags to images based on probability density estimation and then a random walk over a tag similarity graph is performed to re ne the relevance.
Based on the re ned relevance, the associated tags can be ranked in a descending order of their relevance.
ImageCLEF (Image Retrieval in CLEF) [5] aims to analyze a collection of Flickr photos in terms of their visual and/or textual features in order to detect the presence of one or more concepts.
The detected concepts can then be used for the purpose of automatically annotating the images or for retrieving the best matching images to a given concept-oriented query.
Generating the search results according to the modi ed user search intents is proved to be an e ective mean for enhancing Web search experience.
Lu et al.
[12] utilized a co-clustering method to extract latent interest dimensions, and rerank the images by coming latent interest based user
 Integral multilevel graph Unified entity search bird flower tree house outdoor Friend suggestion Image tagging Personalized image search sunrise .
.
.
Bird Flower Animal (a) (b) (c) Figure 1: Uni ed entity search framework (For better viewing, please see original color pdf  le).
(a) Entities in social media community, such as tags, photos and users.
(b) Integral multilevel graph with three types of entity sets, i.e., Vi, Vj and Vk: solid colorful lines in each level of graphs indicate the intra-relations of entities of the same types, while dash gray lines indicate the interlinks between entities of the di erent types; black vertex is the query q of entity type j ( j = 1,  i = 0(i 6= j)) and red vertex is the random entity vb k to be ranked in the searching pool Vk.
Shadow lines denote the links between entity vb k and the subset of entities in Vj , enclosed in the purple ellipse.
Red lines with arrows present a navigated route from query q to entity vb k. (c) Based on the integral multilevel graph, various entity searches can be formulated within a uni ed framework.
preference and query relevance.
Another typical work is performed by Xu et al. [19], in which the overall ranking score is not only based on term similarity matching between the query and the documents but also topic similarity matching between the user s interests and the documents  topics.
In short, while these approaches focus on the mining of various entities for di erent social media search applications, the interaction among entities is not exploited.
Our work in this paper contributes by studying not only holistically exploring interaction (or consensus) among all the entities, but also integrating all the social media search applications in a uni ed framework.
Multi-modality fusion on social media community has been intensively studied in recent years.
Sang et al. [15] propose a tensor factorization model that integrates users, images and tags together for annotation prediction.
With this, personalized search can be easily formulated by user-speci c topic modeling.
In [22], Yao et al. characterize the user relationship by combining the visual and geographic information in a contextual graph modeling.
Negoescu et al. present to discover hypergroups in Flickr, i.e., communities consisting of groups of Flickr groups, while such hypergroups could serve to enrich Flickr s traditional group search [13].
Zheng et al. provide a tensor decomposition-based group recommendation model to combine semantic tags with social relation and to help people more easily engage in group activities [24].
Lin et al. model the community discovery through analysis of time-varying and multi-relational data in rich social media community [9].
These approaches, nevertheless, deal with the multiple modalities independently and the interaction among modalities is not exploited.
In another work by Zhuang et al. [26], social strength is measured in a two-stage learning framework.
The  rst stage is to learn the optimal fusion weights of the multiple proximity graphs for a kernel target alignment; with the learnt kernel, the second stage is to estimate the social strength by a kernel-based learning to rank approach.
However, it is still implemented in supervised way, which needs expensive human e ort.
To make our formulation more clear, we  rstly de ne a few terms below and some are illustrated in Fig.1(b), an exemplary three-level graph.
k, v2 k, .
.
.
, vZk DEFINITION 1: Represented by multilevel graph model, the social network G = {Gk : k = 1, 2, .
.
.
, N } consists of N graphs and each graph is represented by Gk = (Vk, Ek), where k is the entity type id, Vk and Ek are sets of vertices and edges.
Speci cally, Vk = {v1 k }, where Zk is the number of entities in Vk; and each edge in Ek connects two vertices, with weight function wk : Ek    + mapping edges to nonnegative real-valued weights, here we call it intra-relation.
For instance, wk(a, b) measures the intra-relation strength between entities va k. The a nity matrix Wk is de ned by taking wk(a, b) as its (a, b)-element.
: j, k =
 from two levels of graphs.
Of entity set Vj, the subset Sj(vb j } contains M entities, which are linked to the entity vb k in entity set Vk, i.e., Sj(vb k)   Vj.
The links are weighted by link function  k j : Lk j    + mapping links to nonnegative real-valued weights and we de-scibe it as interlink.
For instance,  k j(b, c) measures the DEFINITION 2: The link set L = {Lk j k and vb k) = {v1 j , v2 j , .
.
.
, vM 1459inter-link strength between entity vb we set  k k( ,  ) = 1.
k and vc j .
For self-link,
 To facilitate interaction among di erent entity relationships, we construct an integral graph, over which the circular propagation is proposed to mutual reinforce each other.
Suppose there are N entity types, and thus we can have N views of relationship among these entities by constructing a N level of a nity graphs.
In each level of graphs, the vertices and edges represent the entities and intra-relations of them (wk), respectively.
The entities of di erent types are mutually linked with interlink ( k j).
In this way, N runs of propagations can be conducted separately on each graph to re ne the intra-relation of N entity type.
The spirit of circular propagation is to encourage entity interaction in a way that an entity starts propagation by using the a nity graph of another entity, while preserving its original estimated intra-relation measures.
By arranging the N entities linearly, such that the k-th order entity uses the graph of the (k   1)-th order entity, this forms a circular ring that each entity, once completing propagation, will propagate the new result to in uence its next linked entities.
Let wk(a, b)   wab k ,  k j(b, c)    bc k j, the circular propagation is formulated as following: (t) (t) wab
 wab
 (t) wab k (t) wab
 (t)

 2 1 wij
       k k 1 wij       =  1Pij  ai =  2Pij  ai =  kPij  ai =  N  1Pij  ai =  NPij  ai (1    N  1) wab (t 1)  bj
 (0)
 (0)  bj 2 1 + (1    2) wab
 (t)  bj k k 1 + (1    k) wab k (0) k 1 N  1 N  2 wij
 (t)  bj
 (0)
 (t)         (t)
 wab
 N  N  1 wij  bj N  N  1 + (1    N ) wab
 (1) where the superscript (t) denotes the iteration, and the tradeo  parameter  k(0 6  k 6 1) weights the importance of the propagated and initial estimated intra-relations.
Note that the  rst term in each equation represents information exchange from neighboring entity, while the second term is the initial similarity.
In this circular propagation, the intra-relations of N entities are produced simultaneously.
Instead of estimating the similarity of entities with the same type separately, the circular propagation enforces additional constraint that two entities are similar if the entities of di erent type which are linked to them are connected strongly.
Eq.
(1) can be expressed in a matrix form as following,

 (t) =  1 1 N WN (t) =  2 2 1W1       (t 1) 1 N T + (1    1)W(0)
 (t) 2 1 T + (1    2)W(0)
 Wk (t) =  k k k 1Wk 1 (t) k k 1       T + (1    k)W(0) k
 (t) =  N  1 N  1 N  2WN  2 (t) N  1 N  2
 (1    N  1)W(0)
 (t) =  N  N  N  1WN  1
 T + (1    N )W(0)
 (2) where Wk = [wab k j]Zk  Zj is a n-ity and link matrix respectively, correspondingly composed k ]Zk Zk and  k j = [ bc (t) k k 1 of propagated intra-relations and interlink.
Circular propagation is guaranteed to converge for having the following property: lim t  (Wk (t+1)   Wk (t)) = 0 (3) Proof: (t+1)   Wk Wk = ( k k k 1Wk 1 (t)   ( k k k 1Wk 1 (t+1) k k 1 (t) k k 1 (t+1)   Wk 1 T + (1    k)W(0) k ) T + (1    k)W(0) k ) (t)) k k 1
 =  k k k 1(Wk 1 =  k k k 1( k 1 k 1 k 2Wk 2    k k k 1( k 1 k 1 k 2Wk 2 =  k k 1 k k 1 k 1 k 2(Wk 2  k 1 k 2 T  k k 1
 (t+1) k 1 k 2 (t) k 1 k 2 T ) k k 1
 T ) k k 1
 (t+1)   Wk 2 (t)) (t)   Wk (t 1)) k+1 k =       =  k .
.
.
 1 N .
.
.
 k+1 k k 1 .
.
.
 1 N  N  N  1 .
.
.
 k+1 k T .
.
.
 k k 1 (Wk = ( k .
.
.
 1 N .
.
.
 k+1 k k 1 .
.
.
 1 N  N  N  1 .
.
.
 k+1 k)t T .
.
.
 k k 1 (Wk (4) It is easy to see Eq.
(3) can be derived when each row of  k k 1 is normalized to 1, and 0 6  N ,  N  1, ...,  1 6 1.
2

 (0))( k+1 k (1)   Wk


 T )t

 DEFINITION 3: The query of an entity search is represented by a vector q = [v0 N ]T , which corresponds to another vector u = [ 1,  2, .
.
.
,  N ]T , indicating the im-2, .
.
.
, v0 1, v0 portance of di erent entity types in the query q, Pj  j = 1.
DEFINITION 4: The objective of an entity search (e.g., searching entities of type k) is to give a ranking score list rk = [r1 k ]T , which is a vector of the ranking scores, corresponding to the entity searching pool Vk, for instance, rb k is the ranking score of vb k.
k, .
.
.
, rZk k, r2 (0) DEFINITION 5: An entity search function is de ned as follows, r = f (q, Vk).
(5) Permuting the entities according to this function is called entity search.
In this paper, we formulate the entity search problem from the probabilistic perspective.
Supposing the ranking score list is a random variable, entity search can be regarded as a process to derive the most probable score list given the certain entity query.
From the probabilistic perspective, entity search is to derive the optimum r  with the maximum a posterior probability given the query q and entity searching pool Vk, r  k = argmaxrk Pr(rk|q, Vk).
(6) According to Bayesian formula and the independency assumption of the query q and entity searching pool Vk, the posterior is proportional to the product of the conditional prior probability and the likelihood, Pr(rk|q, Vk)   Pr(rk|Vk)   Pr(q|rk), (7) where Pr(rk|Vk) is the conditional prior of the score list given the entity searching pool Vk.
Pr(q|rk) is the likelihood, which expresses how probable the query q is given the optimal ranking score list rk.
Replacing the posterior in Eq.
(6) with Eq.
(7), we formulate the entity search as maximizing the product of a conditional prior and a likelihood, r  k = argmaxrk Pr(rk|Vk)   Pr(q|rk).
(8)
 energy function, a regularization term, Pr(rk|Vk) =

 exp( Reg(rk, Vk)), (9) where H1 = Pr exp( Reg(rk, Vk)) is a normalizing constant.
Reg(rk, Vk) is de ned as follows following Normalized Laplacian regularizer [25], E(rk) = Reg(rk, Vk) +     IR(q, rk), (18) where the two terms on the right-hand side correspond to the conditional prior and the likelihood, respectively.
The   = H1   is a trade-o  parameter to the two terms.
Given
 that the energy function in Eq.
(18) is quadratic, we minimize E(rk) solving  E(rk) = 0, and have the closed form,  a(rk, Vk), (10) k = (I    Sk) 1 k.
r  (19) Reg(rk, Vk) =Xa

 k  (q, vb where  a(rk, Vk) de ned over entity va visual consistency on its neighbors vb k, k for measuring the  a(rk, Vk) = wk(a, b)(   )2, (11)

 ra k k pda rb k k pdb and da matrix form as following k = Pb wk(a, b).
Then Eq.
(10) can be expressed in a Reg(rk, Vk) = rT k Skrk, (12) where Sk = D 1/2 k WkD 1/2 trix with its (a, a)-element (da row of Wk.
k in which Dk is a diagonal ma-k) equal to the sum of the a-th For the likelihood Pr(q|rk), we formulate it as a shortest-paths problem on a weighted graph, Pr(q|rk) = exp(    IR(q, rk)), (13) where IR(q, rk) =Pa(ra k))2 measures the degree of the disagreement between the ranking scores and the shortest paths in graph.
H2 is the normalizing constant and   > 0 is a scaling parameter.
In a shortest-paths problem, for a weighted graph with entities of the same type j, the weight of path l =< vm > is the sum of the weights of its constituent edges: , .
.
.
, vm+n j , vm+1 j j  j(l) = n Xi=1 wj (m + i   1, m + i).
(14) The shortest-part weight from va j to vb j is de ned by,    (va j , vb j ) =( min{ j(l) : va   j l  vb j } if  va j   vb j otherwise , (15) j to vb j   vb j denotes the path from va where va j .
Considering all path weights are nonnegative, we exploit Dijkstra s algorithm to solve the shortest-paths problem in Eq.
(13) [17].
When the query type is di erent from the entities in searching pool, for example, for the path from vd k, the shortest-part weight is de ned by, k) = min{ k j(b, c)   (vd j   Sj(vb j to vb j ) : vc    (vd j , vc j , vb k)}.
(16) For a query q with multiple entity types, the shortest part to an entity vb k is derived in linear fusion way,  (q, vb k) =Xj then we have IR(q, rk) =Pa(ra  j   (v0 j , vb k), k    (q, vb k))2.
Let us further introduce a vector  k with its b-th element  (q, vb k).
With Eq.
(9) and Eq.
(11), the entity search formulation in Eq.
(8) is equivalent to minimizing the following    

 Without loss of generality, we take the most popular photo sharing site, Flickr, as the social media platform to illustrate our multilevel graph modeling, which mainly has four types of entities, i.e., user (Vu), photo (Vp), tags (Vt) and geo-locations (Vg).
It is worth noting that although we take Flickr as an example, the proposed multilevel graph model can be applied to any kind of community, such as Facebook and LinkedIn.
Due to the missing and noises of geo-locations for most of photos, we perform the circular propagation by using the entity sets Vu, Vp and Vt as follows, similar to Eq.
(2), Wt Wp Wu (t) =  t t uWu (t) =  p p tWt (t) =  u u pWp (t 1) t u (t) p t (t) u p T + (1    t)W(0) t T + (1    p)W(0) p T + (1    u)W(0) u , (20) t , W(t) p and W(t) where W(t) u is the a nity matrix of tags, photos and users at the t-th iteration, respectively.
When t = 0, the a nity matrixes are initial ones before propagation.
 t u,  p t and  u p denote the three link matrix-es measuring the link strength of the two levels of graphs, i.e., from tag graph to user graph, from photo graph to tag graph, and from user graph to photo graph.
 t,  p and  u are tradeo  parameters.
Initial Intra-relations   Initial user intra-relation W(0) u In a social media community, the initial user similarity is mostly determined by people interaction [18], including explicit interaction (one gives comments to the other s photos or one s photos get comments from others) and implicit interaction (two users simultaneously give comments on the same photos).
In addition, photos taken in near locations are often shared by the people with similar interests [3], the intra-relation wab u is de ned u as: between user va u and user vb (0) (0) wab u = (fb(a) + fa(b) + g(a, b))   wab g , (21) u on the photos shared by user va where fa(b) denotes the number of the comments given by the user vb u, vice versa.
g(a, b) denotes the number of photos on which user va u and vb u simultaneously comment.
wab is the relation between g user va u caused by geo-locations, and it is given by u and vb (17) wab g =(cid:26)  
 mingd(va u) < T h u, vb else , (22) u, vb where mingd(va u) is the minimal geo-location distance between photos of user va u, T h is a  xed threshold and   (  > 1) is a positive number.
In this paper, T h is set to 20km and   is set to 2. u and vb 1461p   Initial photo intra-relation W(0) We follow the approach in [11] and adopt scale-invariant feature transform (SIFT) descriptor with a Di erence of Gaussian (DoG) interest point detector for extracting the images  visual patterns.
The interest point is referred to as local salient patch, each associated with a 128-dimensional feature vector.
We further use K-means to cluster the similar patches into  visual words,  and use Bag-of-Word (BoW) to represent each image as it has proven to be e ective for object and scene retrieval [6][16][21][23].
Let fa and fb denote the BoW feature vector of photo va p, respectively, then the initial similarity wab between the two photos is p calculated by p and vb (0) (0) wab p = exp(cid:26)  Ed(fa, fb) 2 2
 (cid:27) , (23) where Ed(fa, fb) denotes the Euclidean distance between fa and fb,  1 is the positive radius parameter, and it is estimated by the median value of all the Euclidean distances.
t   Initial tag intra-relation W(0) Tags supplied by users describe the content of photos while providing additional contextual modalities about the photos.
As a preprocessing step, the standard stemming and stop word removal are  rstly applied.
The M tags which have highest frequency are selected for computing their similarity.
Analogous to the principle of Google similarity distance t and vb t , between tag va [2], we de ne the tag distance wab t as follows: (0) T d(va t , vb t ) = max(log f (va t ), log f (vb log G   min(log f (va t ))   log f (va t , vb t ) t ), log f (vb t )) , t and vb t ) and f (vb t , respectively.
f (va (24) where f (va t ) are the numbers of photos containing tag va t ) is the number of photos containing both tag va t .
These numbers can be obtained by performing search on Flickr website using the tags as keywords.
The initial tag similarity between tag va t and vb t is then given by t and vb t , vb (0) wab t = exp(cid:26)  t , vb t ) T d(va 2 2
 (cid:27) .
(25) Similar to  1,  2 is also estimated by the median value of all the tag distances.
As shown in Eq.
(20), there are three types of interlinks, i.e., from tag graph to user graph ( t u), from photo graph to tag graph ( p t), and from user graph to photo graph ( u p).
Accordingly, three link matrices are built as follows.
   t u   [ ab t u](Zt Zu): measuring the link strength of entities in tag and user graph.
It is de ned as:  ab t u =(cid:26) 1/nva
 t u   va vb t else , (26) t denotes the number of users who provide tag va t u annotates a photo with t means user vb u   va where nva to a photo, vb tag va t .
Figure 2: The illustration for building sub-nets.
   p t   [ ab p t](Zp Zt): measuring the link strength of entities in photo and tag graph.
It is given by:  ab p t =(cid:26) 1/nva
 p vb t   va p else , (27) p denotes the tag number of visual photo va p , and t belongs to photo va p .
where nva vb t   va    u p   [ ab p means tag vb entities in user and photo graph.
Similarly, we have: u p](Zu Zp): measuring the link strength of  ab u p =(cid:26) 1/nva
 u p   va vb u else , (28) where nva vb p   va u denotes the photo number shared by user va u, and u means photo vb p is shared by user va u.
Implementations In practice, it is not necessary to run the multilevel graph propagation as a whole in the social network.
Instead, the network itself is usually formed by disconnected sub-nets, and the propagation can be conducted separately on each sub-net.
In our implementation, two users are connected if one of the following conditions is met: (1) the maximal initial tag similarity is above an average value; (2) their photos are taken in nearby locations; (3) they comment each other s photos or comment on a photo contributed by a third party.
This could result in a number of sub-nets.
To make the  nding of sub-nets computationally e cient, we  rst detect the  promising cores  as seeds and then grow the sub-nets from the seeds, by connecting other users ful lling the aforementioned three conditions.
Fig.2 illustrates the procedure of forming social sub-nets.
The  promising core  of a sub-net, intuitively, is the user who has a large number of photos, attracts signi cant photo views and comments from others, while not connecting to the cores of other sub-nets.
Referred to as Fig. 2, we select cores as the users with a minimum of 500 photos, accumulate at least 2,000 comments, and share no more than 20% of similar tags with others.
Then the rest of users are selected as the promising cores(Fig. 2(b)).
Nearby cores as in Fig.
2(c) may be merged if they have high initial user similarity.
Finally, users are connected to the cores based on their initial user similarities.
Based on this implementation, taking our experiment as an example, we detect 101 sub-nets from
 users.
It is also worth noting that only tags with high frequency will be used in the propagation since tags provided by Flickr users are often imprecise, even containing form and spelling form [10].
We empirically select top 1,000 tags.
In this section, we systematically evaluate the e ective-ness of the proposed uni ed formulation and solution to en-1462s r e s u f o #







































































 # of photos Figure 3: The statistics of photo number owned by users (users owned less than  ve photos are removed).
s o t o h p f o #




























































































 # of comments Figure 4: The statistics of comment number given by photos.
tity search in social media community, and report comparative results on three popular entity search tasks, i.e., friend suggestion, image tagging and personalized image search.
We empirically verify the merit of entity search on a dataset crawled from Flickr [4].
The data from Flickr consists of  ve main elements: users, uploaded photos, the tags associated with each photo, geo-location of each photo, and users who comment on the photo (called  cmt users  for short).
We randomly collect 165,558 users and the corresponding photos, tags and comments by using Flickr API.
For our experiment, we remove the users who have less than 5 photos, and then the dataset includes 40,170 users (not includes the cmt users), owning about 9 million photos.
Fig.3 shows the number of photos owned by users.
The long tail indicates most of users share similar number of photos, and very few users own the extremely large number of photos.
In average, a user owns around 200 photos in our experiment.
Fig.4 shows the number of comments on photos.
The long tail phenomenon also exists, which indicates although the social interaction is complex, the comments on each photo are not too many (13 comments per photo in average).
Fig.5 illustrates the tag frequency, where the noise (misspelling words, combination of words and a x variation) and some special words form the long tail.
Friend suggestion aims to search a list of users, which have similar interests to the given user.
Obviously, the entity type of both query and searching pool is  user.  Therefore, in this task, the user similarity is mainly explored and a ranking list of users can be obtained according to Eq.(19).
We compare y c n e u q e r f g a t

















































































































 tag ID Figure 5: The tag frequency distribution.
our uni ed framework based friend suggestion (UFS) with the following  ve methods in both subjective and objective experiments:   Initial user similarity (IUS).
The friends are ranked based on the initial user similarities, which are directly determined by user interaction in photo sharing activities as mentioned in Section 5.1.
  Tag correlations (Tag).
A tag correlation measured by the number of common tags on the users  photos.
The higher the number of common tags, the more likely to be friends of the two users.
  Visual relationships (Visual).
A visual relationship estimated according to the visual similarity of representative photos of users.
  Fusion of user, tag and visual similarity (Fusion).
A linear fusion of IUS, Tag and Visual.
  Context-based friend suggestion (Context) [22].
It aims to leverage multiple contexts, including user-contributed photos, their associated tags and geo-locations, as well as user behaviors like viewing and commenting.
Subjective User Study To evaluate the proposed friend suggestion strategy, we randomly selected 1,000 users as the query users.
The similarity of each user pair was manually labeled by three subjects on a scale of 1-3: (1) dissimilar (totally di erent interest), (2) similar (somewhat relevant interest), and (3) strongly similar (almost same interest).
The ground truth similar degree of each pair is the median scale of three evaluations.
Considering the pairs with high similarity have especially important for most of applications, we adopted the Normalized Discounted Cumulative Gain (NDCG) as the performance metric.
The NDCG score at the depth d in the ranked lists is de ned by: N DCG@d = ZdXd j=1   1 2rj log(1 + j) (29) where rj is the rating of the j-th pair, Zd is a normalization constant and is chosen so that a perfect ranking s N DCG@d value is 1.
After computing the NDCG measure of each query user, we average them to obtain an overall performance evaluation on friend suggestion.
Fig.6 shows the experimental results.
Overall, the results across di erent depth of NDCG consistently indicate that UFS achieves a performance boost compared to IUS, Tag
                               !#&$ !#& !#%$ !#% !#"$ ! "
!#" !#!$ !
'() *+, -./0+1

 (2) Figure 6: Subjective evaluation on friend suggestion.
Figure 8: Objective evaluation on friend suggestion.
User Id Representative photos s r e s u y r e u
 t s i l d n e i r f d e t s e g g u












 Figure 7: The representative photos of suggested friends for the user Id  8519617@N03.  and Visual which using single entity.
Furthermore, in contrast to the linear fusion and context-based method, the superiority of UFS demonstrates that allowing entity interaction can lead to better performance gain.
As indicated by our results, the friend suggestion based on our uni ed entity search framework can better express the user relationship by reinforcing the mutual exchange of information across multiple entities over an integrated graph model.
Fig.7 shows the top  ve users  representative photos to a query user according to the  nal user intra-relations.
From the representative photos of each user, we can see that these photos are similar with each other.
These users are likely to have similar interest and thus are potential candidates for friend suggestion.
The objective evaluation was conducted according to the contacts function in Flickr site, which is organized by users themselves.
If a user exists in the other user s contact list, we view the two users as friends.
We  rst  ltered out the users who have no contacts in Flickr site or in our user set.
After  ltering, we obtained 2,975 users and took them as the query users.
Similar to the subjective user study, the objective comparison as shown in Fig.8 also indicates the strong performance of our proposed UFS in comparison to others.
Image tagging is to assign a set of tags to a given image to describe the image content.
In our uni ed entity search framework, the query type is  image  and the type of entities to be searched is  tag.  By exploring the a nity matrix Wt, and link matrix  p t, the tag ranking list can be obtained by Eq.
(19).
We compare our uni ed framework based image tagging (UIT) with the following two baseline methods.
  Initial image tags in Flickr site (IIT): The tags originally provided by the image owners.
  Tagging ranking (TR).
A Random walk is performed over a tag similarity graph to estimate the relevance score of tags for a given image [10].
To demonstrate the e ectiveness of the image tagging methods, we randomly select 200 images from our collected Flickr image dataset to perform image tagging.
We also invite people to label the tags on a 1-3 scales: (1)  irrelevant,  (2)  relevant,  and (3)  excellent,  and adopt NDCG as the performance metric.
After computing the NDCG score of each image s tag list, we average them to obtain an overall performance evaluation of the image tagging method.
Fig.9 shows the experimental results.
We can see our proposed uni ed solution achieves much better performance compared to the other baseline algorithms at di erent depths of ND-CG.
The improvements demonstrate that UIT can facilitate the relationship and interaction of di erent entities through mutual reinforcement and all the relationships can be re ned.
Fig.10 further illustrates some exemplary images with the top  ve tags generated by three image tagging methods.
We can clearly see that our recommended tags can better characterize the image content.
Given the large and growing importance of search engines, personalized search has the potential to signi cantly improve searching experience [15].
Compared with the common image search, in personalized image search, the user-speci c information is considered to distinguish the exact intentions of textual queries and rank the images.
Formally in our framework, the query types are  user  and  textual tags,  while the entities in searching pool are  images.  To obtain the image ranking list, we estimate the a nity matrix based on the photo a nity matrix Wp, and link matrixes  u p and  p t.
According to Eq.
(19), we can obtain the image ranking list.
Figure 9: Performance comparison of image tagging methods.
IIT: lion, Panthera leo, Masai Mara, grass, NikonflickrAward TR: grass, animal, mountain, yellow, cloud UIT: lion, wildlife, mammal, grass, Africa IIT: Baja, wildwife, seaofcortez, mexico, mammal TR: fish, water, mexico, nature, texture UIT: dolphin, whale, mammal, sea, wildlife IIT: ABigFave, amazing photo, america, best sunset, canon TR: building, cloud, sunset, nature, autumn UIT: sunset, sky, sea, landscape, nature IIT: 091211, St. Paul, Minnesota, parks, Como Park TR: green, tree, garden, outdoor, football UIT: tree, grass, sky, mountain, outdoor IIT: helo, helicopter TR: helicopter, garden, spring, landmark, bird UIT: helicopter, rescue, flying, sky, tree IIT: 2012, 50D, Dingo, Heal, Healesville TR: raining, bird, flower, nature, beautiful UIT: bird, tree, nature, wild, woodland IIT: Ferrari, Fxx, spa, francorchamps TR: car, road, sand, wildlife, landscape UIT: car, Ferrari, racecar, road, sports IIT: Nikon, NikonD90, D90, nature, Arun TR: flower, color, tree, plant, yellow UIT: bee, flower, nature, yellow, leaf Figure 10: Example results of image tagging.
We select the following three state-of-the-art models as the baselines and compare them with our uni ed framework based method (UPIS).
  Non-personalized (Non).
Use the common text-based image search mainly based on tf-idf functions [16].
  Topic-based (Topic).
It aims to explore folksonomy for personalized search [19].
  Preference-based (Pref).
Perform personalized image search by predicting user interests-based preference [12].
Similar to [12], we use comment-based evaluation approach, where the images attract comments from user u are treated as relevant when u issues queries.
We build two test scenarios for the comment-based evaluation: 1) 50 randomly selected users who gave comments to 10-30 photos, denoted as Dataset 10-30, and 2) 20 users who gave comments to more than 100 photos, denoted as Dataset 100.
15 tags frequently appearing in the tags of commented images are selected as the test queries.
The metric of mMAP [15] is utilized to evaluate the performance and the results are demonstrated in Fig.12.
From the results, we have the following observations.
(1) Our proposed uni ed solution achieves better performance compared to the other three baseline algorithms.
This clearly demonstrates the e ectiveness of our proposed uni ed solution in the personalized image search task.
(2) All mMAP values are not very high.
This phenomenon re ects the problem of comment-based evaluation






 Non Topic Pref
 Dataset_10-30 Dataset_100 Figure 12: Performance comparison of personalized image search for di erent methods.
scheme: the commented images are considered relevant for all the test queries.
As no query information is involved, for those queries non-relevant with the topic of the commented images, the performance tends to be low.
(3) Comparing between the two test scenarios, the average performance of Data 100 also improves over Data 10-30.
One possible reason for the improvement is that those users having more comments are active users who are likely to also attend more interest groups and tag more images.
Fig.11 displays exemplary search results for the query  sunrise.  The top eight non-personalized results and the personalized results of three users (User A, User B and User C) are shown.
We can see that by simultaneously considering query relevance and user information, the uni ed framework based personalized image search could capture the user s preference under certain topics.
From the results, we can see that the top search results for user A mainly focus on sunrise at the seaside, while for user B and user C, the top search results are often coexist with cloud and plants.
For the baseline method (non-personalized) which separate query relevance and user preference, most of the search results are relevant to query, yet may hard to interpret a clear search intent.
The complexity of our approach includes o ine and online two parts.
The o ine multilevel graph construction on 40,170 users with their photos, tags and comments can be  nished in ten hours on  ve servers, each having 4GB memories and running four threads.
Our online entity search algorithm is extremely e cient.
The complexity of the algorithm is O(|V | lg |V | + |E|), where |V | and |E| represent the number of vertices and edges, respectively.
Take 200 images to perform image tagging for example, our algorithm takes less than 60.2 seconds on a regular PC (Intel dual-core 3.33GHz CPU and 4 GB RAM) to complete the whole process.
In other words, tagging one image only takes 0.3 seconds.
It can be even faster if executed on a more powerful machine with parallel computing capability.
Clearly, the speed is e cient and provides almost instant response.
In this paper, we have shown how to integrate various entities in a multilevel graph model, which includes the content from images, tags and geo-locations, as well as the rich context derived from user behaviors.
Speci cally, the relations between users, images and tags are fully exploited by reinforcing the mutual exchange and propagation of information relevancy across di erent entities.
Upon the model, entity
 B and User C respectively) search results for query  sunrise.  search is explicitly formulated within a uni ed framework, in which friend suggestion, image tagging and personalized image search can be implemented in one single way.
Future work includes the extension to multiple media sharing sites, such as Facebook and LinkedIn.
It would be a promising topic to investigate whether these entities are consistent across di erent social media sharing sites and whether spe-ci c factors may impact the way users create, share, use and annotate content.
This work was supported in part by a grant from the RGC of the Hong Kong SAR, China (CityU 119610), a grant from the National Natural Science Foundation of China (#61272290), and a grant from Microsoft Research Asia Windows Phone Academic Program (FY12-RES-OPP-107).
