Peer-to-peer (p2p) networks are the most popular mechanism for the criminal acquisition and distribution of child sexual exploitation imagery, commonly known as child pornog-Copyright is held by the International World Wide Web Conference Committee (IW3C2).
IW3C2 reserves the right to provide a hyperlink to the author s site if the Material is used in electronic media.
raphy (CP)1.
Investigating CP tra cking online is critical to law enforcement because it is the only e ective proactive2 method of  nding persons, known as contact o enders, who directly and physically abuse children.
A previous study found that 16% of investigations of CP possession ended with discovering contact o enders [29].
These investigations have two primary goals: to stop the distribution of CP; and to catch child molesters and help children that are being victimized, often by family members.
Numerous studies of p2p networks have explored the availability, performance, and tra c characteristics of  le sharing.
Unfortunately, no study of copyrighted movies or music provides any assistance to law enforcement seeking to arrest CP perpetrators, discover sexually abused children, and inhibit the trade of images of exploitation.
These past works are neither performed within nor evaluated under the constraints and goals of criminal investigations.
The study we present in this paper is based on methodology su cient for court scrutiny3, makes speci c recommendations for law enforcement strategy, and provides an empirical characterization suitable for goals ranging from informing sentencing hearings to setting national enforcement priorities.
The fundamental problem faced daily by CP investigators is triage [28].
Over a one year period, we observed over
 Gnutella, from over 100 countries, sharing hundreds of thousands of  les veri ed as CP.
We observed that the majority of CP  les are shared by a relatively small set of aggressive users, but a smaller set of  les are shared so redundantly that their daily availability is guaranteed.
While most CP  les are only available for a short amount of time (only about 30% are available for more than 10 days of the year), there are at least tens of thousands of unique CP  les available on p2p networks for download each day.
These quantities cannot be addressed by investigators in an ad hoc fashion.
Accordingly, we examine (i) methods of target selection designed to reduce content availability (an NP-hard problem); and (ii) an empirical justi cation for focusing on subgroups of
 possessors have images depicting sexual violence to children such as bondage, rape, and torture; 28% have images of children younger than 3 years old [29].
waiting for someone, a third-party or the victim (if old enough to speak), to come forward and report the abuse.
warrant a davits.
631peers that are the most aggressive, in terms of their duration and scope of activity, volume of shared content, or attempts to escape attribution.
Our key contributions are as follows.
  We propose and evaluate three strategies for prioritizing law enforcement resources in investigating CP tra cking.
We conclude that removing peers with the largest contributions (a weighted measure of days of uptime and  les made available) is most e ective, but with Pareto-like diminishing returns.
  We examine subgroups of aggressive peers, such as peers seen using Tor, peers on multiple p2p networks, and four other subgroups.
We  nd that all appear to be more active in their tra cking, having more CP  les and more uptime than the average peer sharing CP.
These aggressive subgroups deserve priority in investigation over millions of other potential targets.
  We  nd that o enders using Tor use it inconsistently.
Over 60% of linkable user sessions send tra c from non-Tor IPs at least once after  rst using Tor, thus removing its protection; over 90% of sessions observed on three or more days fail likewise.
This result not only speaks broadly to the failure of Tor in practice; it shows that, fortunately, investigators need not employ complicated, theoretical attacks on many Tor users that share CP.
  We examine our dataset for evidence of users purposely aliasing as multiple peers on the network to hide their actions.
We  nd little evidence, on a day-to-day basis, to suggest that users are changing their application-level identi ers but keeping their libraries.
Our  ndings are based on a partnership with over 2,000 U.S. law enforcement o cers nationwide to collect data on CP tra cking.
To enable our study, we have built several tools for conducting forensically valid investigation of these crimes.
All investigators completed multi-day trainings on our tools, and collected evidence with the expectation that a court would examine the data.
These tools are now in daily use in all U.S. states and several other countries.
As a result, thousands of persons, many of whom had directly abused children, have been arrested for these crimes.
The highest impact research in criminal forensics works within, and is evaluated under, the constraints and goals of investigations.
In this paper, we follow that principle, rather than presenting a set of isolated, exploratory characterizations of users.
In this section, we review the U.S. legal constraints on criminal investigation based on applications of our work.
Most importantly, our work is in the context of the pre-warrant (plain view) phase of investigations, prior to any arrest.
Actions by investigators are curtailed by the Fourth Amendment and related jurisprudence.
These require that pre-warrant, investigators acquire only evidence in plain view and therefore not violate a person s expectation of privacy (see Katz v. U.S., 389 U.S. 347 (1967)).
Recent cases have supported the view that logging CP sharing activities on p2p networks does not violate any plain view restrictions because they are open forums; see U.S. v. Borowy, 595 F.3d 1045 (9th Cir.
2010) and U.S. v. Gabel, 2010 WL 3927697.
The goal of the pre-warrant phase is not to make an arrest; it is to obtain a judicially issued search warrant, granted only once the probable cause (PC) standard is met.
PC is a qualitative measure often de ned as meeting a  fair probability  that further evidence will be found in the location to be searched; see U.S. v. Sokolow, 490 U.S. 1 (1989).
In criminal investigations of the type we consider, search warrants must specify this location, and not a person.
This process is in stark contrast to the civil process used in copyright infringement lawsuits, where the standards of evidence are lower, and Fourth Amendment protections do not apply.
Arrests in these criminal cases are typically not based on the network-acquired evidence.
They are based on the fruits of the search and the person identi ed as possessing the contraband materials.
There is no notion of a false positive of a person during a search; only that the search itself was barren of evidence.
Investigators and warrant-issuing judges prefer to minimize as much as possible the number of such ine ectual searches, but they are not impermissible.
Because of the plain view mandate, there is nothing in our data collection methodology that is secret or hidden.
We have no special agreement with law enforcement, other than their identi cation, by hash value, of known  les of interest.
We log and analyze only what is available to any member of the public and research community.
Finally, we note that our work follows a forensics model and not the traditional security attacker model.
Our techniques can be applied very successfully even though there exist many ways to defeat them.
But as we show, many people do not attempt to hide.
We identi ed over 1.8 million eMule GUIDs (globally unique identi ers), with many sharing multiple CP  les.
Each such shared  le matches a list of known CP, identi ed by a cryptographic hash.
Not one of the 1.8 million took the time to change a single bit of the  le and thus the hash.
Why?
We can only speculate, but changing the  le hash serves little purpose when the  le names already contain sexually explicit terms, intentionally named for easy discovery by other peers.
This study is based upon the analysis of a large number of observations of CP  les on p2p networks, and the behavior of the peers that share them.
In this section, we describe the sources of these datasets and provide salient details relevant to our analysis.
In Section 7, we identify sources of bias in the data and potential limitations of our study.
Most previous studies of p2p networks have taken place over just several days [7, 8], several weeks [12], or a few months [6, 17, 21, 25]; our study is comprised of thousands of observations per day for a full year.
This duration is especially critical in the context of criminal investigations; scienti c studies of crime are often submitted as supporting facts during trial and sentencing.
Our focus is on  les of interest (FOI), which include CP images, as well as stories, child erotica, and other collections that are strongly associated with this crime.
We logged only content with hash values matching, by cryptographic hash, a list put together by law enforcement by visual inspection.
Background.
This paper is based on data collected with the help of national and international law enforcement4.
Starting
 and the basics of digital forensics research elsewhere [28].
Date Range Files GUIDs Records Gnutella (FOI only) Gnutella Browse eMule (FOI only) IRC (no  le data) Ares (no  le data)



















 Table 1: All datasets are observations of CP activity only, but IRC and Ares data do not contain information about  les or GUIDs.
Except when otherwise stated, a record corresponds to a law enforcement observation and contains date, time, IP address, application-level identi er, geographic location as determined by an IP geolocation database, and a  le hash.
in January 2009, we began deploying a set of forensic tools to investigators in the U.S. and internationally for online investigation of p2p CP tra cking.
Prior to our collaborative e orts, the standard method for online CP investigation was to make isolated cases: leads were not shared among agencies or o cers, other than by phone or email.
O cers leveraged their own experience to prioritize suspects.
Tools.
Our suite of tools, called RoundUp [14], has enabled seamless sharing of plain view observations of online CP and associated activities on various  lesharing networks.
The shared data, collected in order to make these cases, provide each investigator with a longitudinal view of CP o enders and provide a method of triage for selecting targets for further investigation; and of course, the data enable this study.
Because over 2,000 investigators have been trained on our tool to date, and because it is in use by hundreds of investigators daily, the aggregate set of observations we have used for this study is incredibly detailed.
The tools are still in use, and currently, law enforcement execute approximately 150 search warrants nationwide per month based on data collected using our tools.
We do not, however, present search warrant or arrest data in this study5.
Datasets.
Our datasets, summarized in Table 1, include law enforcement observations from Gnutella and eMule p2p networks.
The Gnutella and eMule datasets span a one-year period from October 1, 2010 to September 18, 2011.
Each record in these datasets corresponds to a law enforcement observation of a particular peer making available one or more FOI, and minimally contains date, time, IP address, application-level identi er, geographic location as determined by an IP geolocation database, and a  le hash.
Most  le sharing protocols include an application-level identi er unique to an installation of the application.
In both Gnutella and eMule, these identi ers are persistent across users  sessions, and are referred to as GUIDs (globally unique identi ers).
Peers on these networks are uniquely identi ed by their GUID, and we use peer and GUID interchangeably to identify unique running instances of the corresponding p2p software.
All FOI are uniquely identi ed using hash values; law enforcement manually classify  les as FOI from a variety of sources, such as post-arrest forensic analyses.
An enormous number of such FOI are shared on Gnutella and eMule.
Respectively, there are 139,604 and 29,458 known FOI shared by 775,941 and 1,895,804 GUIDs.
Our tool searched only for FOI in a list containing about 384,000 entries; this list was updated several times over the course of this study.
Review Boards.
It is a small sample: the National Center for Missing and Exploited Children reports reviewing more than 60 million child pornography images and videos6.
As such, our work presents only a lower bound on the amount of activity present in these networks.
In a limited fashion, we use two other datasets.
Our IRC dataset, based on a more recent tool that we developed, covers a four-month period from June to September 2011.
The IRC dataset is a log of IP addresses that were involved in public activity related to the sexual exploitation of children in public chatrooms; no  le observations are in this dataset.
We also use a dataset of CP-related activity on the Ares p2p network7 collected using a tool we did not write, but collected by the same law enforcement o cers responsible for all data in this paper.
The Ares dataset contains only IP addresses and has no information about  les shared, but addresses were only logged for peers that shared known FOI.
Other Details.
Gnutella allows a peer to be browsed and thus investigators can enumerate all  les shared by peers.
Our Gnutella Browse dataset consists entirely of peer browses and includes all  les a peer is sharing, not just FOI.
Some Gnutella peers cannot be browsed; we collected only FOI data from these peers.
eMule does not permit browses.
Regardless, each of these datasets includes only peers that share one or more FOI; peers without FOI were not logged.
We draw a distinction between a time-limited view of a peer s shared  les and the set of all  les with which a given peer was ever observed.
We de ne a GUID s library to be the set of  les that were observed being shared by that GUID on a given day.
A GUID s corpus is the set of all  les shared by that GUID over the entire duration of the study.
In both cases, we typically only include FOI, but we make it clear when a corpus or library includes non-FOI observed as the result of a browse.
In investigating the tra cking of CP on p2p networks, the goal of law enforcement is to prioritize criminals whose arrest will have the greatest impact.
But the strategy to achieve this goal depends upon the impact desired:  nding contact o enders who go otherwise unreported,  nding those who create new CP, and decreasing the availability of FOI on the network are all priorities.
In this section, we focus on strategies for reducing the availability of FOI.
E ective CP removal strategies are especially important as a means to prioritize law enforcement s limited resources and time.
After online evidence is collected, days or weeks
 servlet/NewsEventServlet?&PageId=4604.
7http://aresgalaxy.sourceforge.net/ http://www.missingkids.com/missingkids/









 f o
 f o
 n o
 i t c a r


 Gnutella eMule Common on Gnutella Common on eMule n o
 i t c a r


 Gnutella eMule Common on Gnutella Common on Emule Common on Both











 GUIDs Sharing Days Available Figure 1: Redundancy of FOI ( les of interest) among multiple GUIDs as a CDF.
Some  les are seen on both networks, but the distribution of these observations is di erent.
The  Common on Gnutella  line shows the CDF of these common  les as seen on Gnutella, and similarly for the  Common on eMule  line.
Figure 2: CDF showing the days available per FOI (during 353 days for Gnutella and 329 days for eMule).
As in Figure 1, the  Common on Gnutella  line shows the CDF of  les common to both networks as seen on Gnutella, and similarly for the  Common on eMule  line.
The  Common on Both  line shows these common  les available on either network on any given day.
of o line processes are required in each case until an arrest is made.
Additional resources are required to go to trial.
It is infeasible for investigators to arrest all users sharing CP and remove all FOI.
Investigators need a triage strategy for deciding upon which small fraction of online leads to act.
An enormous set of perpetrators are active every day around the world.
Even with unlimited resources, U.S. law enforcement can only partially impact  le availability.
Our results, discussed below, suggest the need for a coordinated international e ort.
Before we further discuss the implications of removing  les, we characterize the redundancy and availability of FOI on Gnutella and eMule.
Many FOI on Gnutella and eMule are not widely redundant among GUIDs within the same network.
Figure 1 shows the relative redundancy of FOI, which is the number of GUIDs that possess and make available each  le.
The distribution is presented as a cumulative distribution function (CDF), which shows on the y-axis the fraction of FOI that are shared by at most x GUIDs.
For example, 90% of  les on Gnutella were shared by at most 20 GUIDs; 99% of  les were shared by at most 1,167 GUIDs; and 99.9% of  les were shared by at most 9,129 GUIDs.
Figure 1 also shows the relative redundancy for the subset of FOI appearing on both networks.
The set of  les common to both networks is signi cantly more redundantly shared on each network than the set of all  les on each network.
There is a high degree of FOI overlap among the two networks: 26,136 of the FOI on the eMule network (nearly 89%) were also seen on the Gnutella network, and 97% of Gnutella GUIDs were observed with at least one  le that can be found on the eMule network.
The overall low redundancy of most  les suggests the strategy of prioritizing the investigation of users who possess a large amount of less redundant FOI in order to remove it from the network and prevent its proliferation.
An easily intuited proxy for this measure is to target GUIDs who possess large corpora.
Since most FOI are relatively less redundant, the GUIDs with the largest libraries likely have the most FOI with low redundancy.
We say a  le is available on a given day if at least one peer is sharing that  le on that day.
This approach is simple in that it does not take into account bandwidth and reachability considerations, which are di cult to measure globally.
We do not expect this de nition to limit the applicability of our results, as the assumption of high bandwidth and reachability is conservative from the perspective of law enforcement.
Figure 2 plots the availability of FOI as a CDF on a semi-log scale.
Gnutella  les tend to have lower availability than eMule, with 80% of  les available for more than one day; about 30% are available for more than 10 days; and about
  les that are available for a single day are unique to a speci c GUID;  les that tend to have longer availability are possessed by many GUIDs, not all of whom are online on a given day.
Again we see that the  les that are common to both networks are more available than is typical on each individual network: about 30% of these common  les are available for more than
 average of 9,712 distinct  les are available, with a peak of 32,020  les during our study.
Our law enforcement model is as follows.
Investigators have a global, historical view of GUIDs and their corpora, including known FOI and other  les.
Investigators look to reduce FOI availability, by arresting the users that correspond to peers and removing their corpora from the network.
Investigators aim to remove  les from the network completely.
Content can be removed from these networks only by 634i i g n n a m e



 f o n o i t c a r













 n u e t l l a e
 u e l Heuristic Random Observed Corpus Contribution
 All U.S.
Percentage of Top GUIDs Removed
 Figure 3: The remaining fraction of FOI available at least one day given a percentage of GUIDs removed according to di erent heuristics: random, number of days observed, corpus size, and contribution to  le availability on Gnutella and eMule.
We removed the top 0.01, 0.1, 1, and 10 percent of GUIDs according to each heuristic.
In Gnutella, the Corpus and Contribution heuristics achieve equal results when 0.113% of GUIDs are removed.
Also shown is the impact of removing 100% of peers with 10 or fewer FOI, and 100% of peers in the U.S.
arresting users and taking their shared libraries o ine, as the protocols and implementations inhibit falsifying or polluting content.
Our goal is to  nd out which peers should be removed such that we minimize the number of  les that are available at least one day.
In Appendix A of our technical report we show that this problem is NP-Hard [9].
Here, we evaluate four greedy heuristics aimed at reducing the availability of CP by removing peers.
Our evaluation consists of removing subsets of peers from the data and examining the e ect on availability.
Specifically, we examine the following heuristics: (i) removing peers that were observed most often, i.e., largest number of days observed; (ii) removing peers with the largest corpus size; (iii) removing peers with the largest contribution to availability (as de ned below); and (iv) removing peers selected randomly, as a baseline.
For an arbitrary  le on an arbitrary day, n peers possess that  le.
We say that each peer provides a  le-contribution of 1 n th of that  le.
A peer s contribution to  le availability is the sum of the  le-contributions of the  les in their corpus over the duration of the study.
An alternative measure of availability is daily redundancy, the number of peers that share a  le on a speci c day.
The algorithm to optimally reduce the maximum redundancy over all  les shared is simple: remove the peers with the largest corpus size  rst.
It is unclear that minimizing redundancy, unless it is to zero (equivalent to unavailability), is useful or e ective.
To evaluate the e ect of reducing redundancy to a small value, we would require reachability, bandwidth, and propagation models of the underlying p2p overlays.
Thus, we do not consider daily redundancy further.
Figure 3 compares the e ectiveness of each of the above heuristics.
Interestingly, removing the peers that were seen the most often has almost no e ect on the availability of FOI.
Removing peers by either contribution or corpus size is most e ective; these measures are correlated, so their similarity in performance is unsurprising.
The vast majority of  les are shared only by a relatively small set of proli c GUIDs.
Consider Gnutella (similar trends hold for eMule): If we remove the top 0.01% of 775,941 GUIDs as determined by corpus size, only 59% of the known FOI remain available in the network.
In other words, 41% of the unique  les on the network are made available by a group of only about 80 GUIDs.
The top 0.01% have 3,242 distinct FOI on average, with the top peer possessing about
 for a relatively short amount of time; as Figure 2 shows, only 28% are available for more than 10 days during our study.
Some of this is due to the relatively low number of days these high-contributing GUIDs were observed; this also explains the failure of the observed days heuristic.
These proli c GUIDs have a worldwide presence.
Removing them requires tremendous multinational cooperation as we discuss below.
Impact of Geography on Availability Our data are mostly based on the e orts of U.S. law enforcement, and the  les they are looking for are arguably tuned to U.S. perpetrators.
As law enforcement agents are limited by jurisdiction, the locational diversity of these users provides a resistance to the straightforward approach of prioritizing them.
Only a small majority of top Gnutella GUIDs (by corpus size) 57 out of 100 are located in the U.S.
The rightmost bar ( All U.S. ) in Figure 3 shows the reduction in availability if we restrict our removal to U.S.
GUIDs (that is, GUIDs with an IP located in the U.S.) only.
Note that we remove all such GUIDS in our analysis, a clearly infeasible approach in practice.
Just 30% of  les are unavailable (internationally) after removing all GUIDs in the U.S.; removing just the top 0.01% internationally (a group of about 80 GUIDs) has a similar e ect, suggesting the utility of a coordinated international approach.
Within the U.S., the problem is similarly large in scope.
The top 5% of GUIDs in the U.S. comprises a set of 14,410 GUIDs, each with a corpus of at least 40 known FOI.
Due to the weeks of manual e ort required for each arrest, the limited resources in the U.S. allow for 3,100 arrests per year for both o ine and online o enses [27].
Impact of Low-Sharing GUIDs on Availability A large portion of GUIDs have comparatively few  les.
As shown in Figure 4, about 82% have 10 or fewer FOI.
There are several reasons peers may appear to have few  les.
They may have  les that are CP, but are not yet known to be FOI.
They may be downloading FOI and not subsequently sharing them.
They may have downloaded the  les incidental to other activities.
Finally, they may simply be sharing a smaller library.
We expected removal of such low-sharing users to impact  le availability signi cantly, since very many peers possess few  les.
Contrary to our expectations, removal of these GUIDs sharing few  les has essentially no e ect on  le availability, as shown in the second-rightmost bar in Figure 3 (  10 FOI ).
This result provides further evidence that  le availability depends primarily on those GUIDs with the largest corpora, though it does not consider the contribution to redundancy that these low-sharing GUIDs provide.
s


 f
 o n o i t c a r


 Gnutella FOI GUIDs Gnutella Browse GUIDs Gnutella Browse GUIDs (FOI) eMule FOI GUIDs






 Files in Corpus Figure 4: CDF showing the corpus size per GUID, for various measurement types.
The black line ( Gnutella Browse GUIDs ) show the corpus size distribution for all  les seen at GUIDs whose libraries were browsed, and the corresponding green line shows the distribution of FOIs within those browses.
The other two lines show all FOI observed in any manner.
(n.b., eMule does not allow browses.)
Most GUIDs have very few  les in their corpus.
We give a week-by-week breakdown of Gnutella library sizes in our technical report [9].
In Section 4, we show that strategies for removing content from the entire ecosystem must target o enders from all countries.
In the absence of a uni ed e ort and no such collaboration exists investigators need a triage strategy.
In this section, we characterize triage metrics for local investigators.
Ideally, investigators would target the most dangerous o enders: those that are personally, physically abusing children.
Unfortunately, such information is typically not available until months or years after arrest [26].
In lieu of that ideal, local investigators can target peers that are the most aggressive o enders: peers that exhibit greater evidence of intent [11] beyond the average case, which is an important practical legal concern.
This includes peers such as those that are online for the longest duration and share the largest number of FOI.
Similarly, investigators may target o enders that are conduits between p2p network communities (e.g., by sharing on both eMule and Gnutella), or o enders that seek to escape detection and justice by using Tor or network relays.
We quantify the activity of six subgroups of aggressive peers sharing FOI.
We characterize the contribution of each subgroup to the duration of CP availability and the amount of CP content.
The subgroups are: (i) the top 10% of GUIDs sharing the largest corpora; (ii) the top 10% of GUIDs seen sharing FOI the most number of days; (iii) the top
 Section 4.2; (iv) the set of GUIDs sharing FOI on at least two p2p networks (linked by IP address); (v) GUIDs that use a known Tor exit node; (vi) GUIDs sharing FOI that use an IP address that we infer to be a non-Tor relay.
Our results show that all of these subgroups are more active than a group that consists of all peers that we observed.
The exception is the subgroup of GUIDs using non-Tor relays, as Identi er All GUIDs Multi-Network GUIDS Tor GUIDs Tor GUIDs (> 2 days) Relayed GUIDs Top 10% Observed Top 10% By Corpus Top 10% By Contr.
Gnutella
 Network eMule














 Table 2: Sizes of each GUID subgroup.
De nitions of each subgroup appear in this section.
Network IP Addresses Total Private Tor Gnutella eMule Ares












 Table 3: Number of IP addresses per network observed sharing FOI.
In the case of IRC, the IP addresses correspond to clients observed in public chat rooms related to child sexual exploitation.
The Tor column refers to the number of distinct public IPs where Tor-using GUIDs were seen, including but not limited to known Tor exit nodes.
we explain below.
The di erences of each subgroup to the set of all GUIDs are signi cant (p < 0.001).
Below we provide characteristics of each subgroup, and details of the behavior of each.
For example, we show that GUIDs using Tor to share FOI use Tor irregularly, and therefore their true IP addresses are easily identi able.
Due to space limitations, we omit Gnutella data from some graphs where they largely correspond to the eMule data.
The full set of graphs are available in our technical report [9].
The size of each subgroup is shown in Table 2.
The size of the top 10% by corpus and observed days subgroups are slightly larger than 10%.
This variability is due to ties in the ranked lists of GUIDs.
We include all such GUIDs to avoid arbitrary tie-breaking.
Users can actively participate in p2p networks in two primary ways: by contributing a large number of  les or a large amount of time.
For example, one peer may share 100  les for a single day, and another may share a single  le for
 have only a limited time to take advantage.
In the second case, the content is small but other peers will  nd it easier to gain access to the content.
It is vital for investigators to address both types of activity; the contribution metric balances these two concerns.
For these reasons, we create three subgroups corresponding to the 10% of GUIDs with the largest corpora of  les (F ), the 10% with the most days observed online (D), and the top
 There is substantial but not overwhelming overlap among these subgroups.
The overlap in Gnutella, as de ned by Jaccard s index, J(A, B) = |A B| |A B| , is J(C, F ) = 0.51 and J(C, D) = 0.28; the eMule subgroups overlap similarly.
IP Addresses Intersection



 Gnutella   eMule
 Ares
 Ares IRC   Ares eMule  
















 Intersection of all
 Table 4: Overlap of IP addresses across multiple networks, excluding Tor IPs and private IPs.
A small but signi cant set of IPs were seen across multiple networks, indicating particularly active users.
Law enforcement are interested in users that are active on multiple p2p networks.
Such users are more aggressive in terms of assisting in the distribution and availability of content to two communities, possibly acting as a bridge.
We identify the set of GUIDs in Gnutella that are active in another network by  nding all IP addresses in our Gnutella dataset that also appear in any of our eMule, Ares, or IRC datasets, and correspondingly in eMule for those that appear in any of the Gnutella, Ares, or IRC datasets.
We refer to GUIDs in these sets as multi-network GUIDs.
The total number of IPs addresses, private IPs8, and IPs used by GUIDs that also used known Tor exit nodes that we observed for each of these networks is shown in Table 3.
Generally, private IPs are the result of sub-optimally or miscon gured end-user applications, as opposed to indicating privacy awareness.
In contrast, Tor use indicates privacy-aware users.
Table 4 shows the size of each pairwise network overlap.
For all such intersections, we  rst remove private IPs and Tor exit nodes (as listed in the Tor consensus  les9).
Of all network pairs, the Gnutella-eMule overlap is the largest.
The union of all three intersections comprises our 84,925 GUID multi-network subgroup for Gnutella.
We perform a similar calculation for eMule, resulting in 147,904 GUIDs.
Peers that use Tor are of interest to law enforcement because they are actively masking their identities, thwarting investigations of this crime.
Tor does not  lter application-level data: GUIDs are passed through to investigators, and thus appear in our dataset as well.
We de ne a GUID as a Tor GUID if it was ever observed as having an IP address listed as a Tor exit node in the Tor consensus for the date of the observation.
When a Tor GUID s IP is a known Tor exit node we say that the GUID is using Tor.
As Table 2 shows, this set is not large on either network: 3,666 GUIDs for Gnutella and 16,290 GUIDs for eMule.
It is striking that the vast majority of Tor GUIDs do not use Tor consistently, which makes it possible to detect their true IP address.
In Figure 5, we show the CDFs of overall Tor usage.
In both networks, only about a quarter of the Tor GUIDs used Tor every time they were observed.
More signi cantly, for these GUIDS, under 40% consistently use
 the public Internet, self-assigned, or otherwise invalid, as de ned by RFC 5735.
nodes on a daily basis; see https://metrics.torproject.
org/data.html

 s



 r o
 f o n o
 e
 u e l i t c a r


 Overall Tor Usage (>2 Days Observed) Tor Usage after First Use of Tor (>2 Days Observed) Overall Tor Usage Tor Usage after First Use of Tor





 Fraction of Days Observed on Tor Figure 5: CDF of Tor usage per GUID for eMule.
GUIDs do not use Tor consistently after  rst being observed at a Tor IP.
Under 40% of Tor GUIDs consistently used Tor after  rst being observed using it.
When considering only Tor GUIDs seen on >2 days (which comprise about 70% of all Tor GUIDs), the rate falls to below 10%.
The Gnutella data show similar characteristics.
Tor after their  rst use of Tor.
When we examine these 40% of nodes that used Tor consistently, we found that most were observed on the Gnutella and eMule networks for only one or two days.
Therefore, we recomputed the distribution of Tor usage for the subset of Tor GUIDs observed three or more days, which is over
 Tor usage after  rst using Tor.
The resulting CDFs are the upper lines in Figure 5.
In sum, over 90% of GUIDs using Tor for more than two days on eMule and Gnutella are easily linked back to a non-Tor IP address, one that is most likely their real location.
This irregular use could be due to ignorance of how Tor works, careless con guration, or frustration with the lower throughput of Tor.
It is well known that Tor s design does not o er technical protection to p2p users because it does not hide identifying application-level data [16].
In contrast, we provide the  rst empirical evidence that Tor users do not use the software consistently, even those with a strong reason to so.
Regardless of the quality of Tor s security, this evidence strongly suggests that its usability (its interface, its e ects upon perceived speed, or some other factor) is lacking.
We conclude that the use of Tor, as observed in practice, poses only a small hurdle to investigators.
Reports by the Tor developers that  Journalists use Tor to communicate more safely with whistleblowers and dissidents 10 should give one pause, as there is no evidence that those groups are signi cantly more or less tech-savvy than the users we study.
Peers that Use Suspected Relays The  nal subgroup we identify is a set of peers that are using IPs that we suspect are relays (other than Tor exit nodes).
To create this subgroup, we  rst collected the set of non-Tor IP addresses used by GUIDs that also used a Tor exit node.
We discard the IPs that hosted fewer than four GUIDs (267,035 in the case of Gnutella, and 1,671,419
 overview.html.en from https://www.torproject.org/about/


 s


 f o n o i t c a r








 s


 f o n o i t c a r






 e
 u e l All Tor Relayed Multi Network Top 10% Observed Top 10% Contribution


 Number of FOI

 n u e t l l a All Tor Relayed Multi Network Top 10% Observed Top 10% Contribution







 s


 f o n o i t c a r

 s


 f o n o i t c a r




 e
 u e l All Tor Relayed Multi Network Top 10% by Corpus Size Top 10% Contribution





 Number of Days
 n u e t l l a All Tor Relayed Multi Network Top 10% by Corpus Size Top 10% Contribution


 Number of FOI






 Number of Days Figure 6: Characterizations, as CDFs, of per-GUID corpora and days observed for eMule and Gnutella.
The aggressive subgroups, sans relayed, appear to be more active in their tra cking, having more FOI and uptime than the average peer sharing FOI.
for eMule), and we nominate the remaining IPs as potential relays.
Finally, we create the subgroup of relayed GUIDs as the set of GUIDs seen using the potential relays.
We cannot validate these GUIDs as having de nitely used relays; for example, it may be the potential relays are IP addresses that get reassigned frequently.
However, we consider their use of these shared IPs su cient to de ne them as a distinct set.
There are substantive and statistically signi cant di er-ences among the subgroups in terms of per-GUID corpora and number of days observed.
These di erences can be seen in Figure 6 and are summarized in Table 5.
In particular, the subgroups generally have a larger corpus size and more days observed online than the set of all GUIDs.
The three top-
subgroup and multi-network subgroups show similar e ects.
Notably, these latter two subgroups are selected independently of corpus size and days online.
This result con rms a hypothesis that tech-savvy groups, whether through Tor or multi-network use, are more active.
The set of GUIDs in the top 10% contribution subgroup represent a combination of the other aggressiveness metrics.
This result can be viewed by comparing CDFs in the  gure, or by comparing means in the table.
For example, the top 10% contribution subgroup s mean corpus size is higher than the top 10% observed, and its mean number of days observed is higher than the top 10% corpus subgroup.
The contribution metric could easily be parameterized to weight observations more heavily, though we do not show such results here.
The relayed subgroup in general has larger number of FOI than the all group, and appears online more days on average than the all group in eMule.
However, the relayed subgroup shows fewer days observed online than the all group in the Gnutella network.
This result suggests that either this subgroup, as we ve de ned it, is not particularly active, or that our process for identifying non-Tor relays is faulty.
It may also be that the peers in the relayed subgroup are more successful at aliasing themselves as di erent GUIDs that appear on the network fewer number of days each.
In the following section, we examine the general problem of user aliasing in this data set.
The relationship between p2p network GUIDs and real users is not one-to-one in our dataset.
In fact, it is possible for a single user to correspond to multiple, distinct GUIDs.
We refer to this phenomenon as user aliasing, and for some
 Mean Value (99% CI) Corpus Size Days Obs.
a l l e t u n
 e l u
 e


 All
 Tor

 Relayed
 Multi-Network
 Top 10% Obs.
Top 10% Corp. 75.9 (74.3, 77.7) 16.2 (16.0, 16.5) Top 10% Contr.
69.1 (67.6, 70.9) 19.5 (19.3, 19.8)


 All

 Tor
 Relayed

 Multi-Network

 Top 10% Obs.
Top 10% Corp. 27.8 (27.4, 28.5) 18.7 (18.6, 18.8) Top 10% Contr.
25.8 (25.4, 26.5) 19.0 (18.9, 19.1)

 Table 5: The expected value and 99% con dence interval of each characteristic for each subgroup of GUIDs.
Each subgroup s mean di ers from the mean of the  All  group.
Each such di erence is statistically signi cant (p < 0.001), as determined by a computational permutation test (R = 10, 000).
Con dence intervals are computed by bootstrap (R = 10, 000).
users it is intentional.
In this section, we examine observable user aliasing, and we also attempt to quantify its e ects upon the analyses in the previous sections.
In sum, we  nd that GUIDs that share at least three FOI any given day generally have distinct libraries.
In Gnutella, we can compare all  les shared by a GUID, and in that case users sharing a library of at least two  les are generally distinct on a given day.
We also  nd little evidence to suggest users are changing their GUIDs and then continuing to share the same library or a portion of it later that day.
Parallel results generally held for eMule, though without the ability to browse eMule user libraries, we are less certain of that result.
The true user aliasing rate in our data is unknowable to us.
However, the reasons for deliberate aliasing can be enumerated: (i) if a user has two computers (or multiple accounts on a single computer), each with an installation of Gnutella, he will control two unique GUIDs; and (ii) a user may reinstall or upgrade their p2p client on a single computer or otherwise modify their GUID over time.
We have no way of detecting the  rst case from only network data; however, the second case can be detected if the user does not alter what  les they are sharing, as the  le library acts as a kind of signature for the user.
It is this latter case that we evaluate in the remainder of this section.
Most users, as identi ed by GUIDs, are seen with very small libraries of a single  le or two.
This fact is illustrated in Figure 4 in Section 4 (and in a week-by-week breakdown in our technical report [9]).
We posit that such small libraries are not particularly di erentiable.
By excluding them, we can determine a lower bound on the user aliasing of type (ii) that may be occurring.
Analysis and Results.
We computed day-to-day similarities between Gnutella libraries to determine a lower bound on user aliasing, or alternatively, an upper bound on the number of unique libraries present in the dataset.
Generally, we found most libraries to be distinct.
Figure 7 shows a comparison of Gnutella GUID libraries, plotting the fraction of GUIDs with libraries that are a unique collection of  les.
In the upper portion of the  gure, a comparison is made of just the  les of interest at each












 o n y l
 u l l l i b r a r i e s All Libraries Library Size > 1 Library Size > 2 i s e i r a r b
 e u q n
 n o i t c a r
 i Jan 11 Mar 11 May 11 Jul 11 Sep 11 Date Figure 7: Fraction of Gnutella GUIDs with unique libraries on spe-ci c days, where uniqueness is de ned as libraries that completely match.
When considering libraries of at least two FOI, approximately 95% are unique.
Similar results hold for eMule.
When considering full (browsed) libraries, over 93% are unique.
)
 > e z
 i , n = f f o t u
 y t i r a l i m
 i (


 o n y l
 u l l l i b r a r i e s n > 0.3 n > 0.5 n > 0.9 s e i r a r b
 i i e u q n
 n o i t c a r
 Jan 11 Mar 11 May 11 Jul 11 Sep 11 Date Figure 8: Fraction of Gnutella GUIDs with a unique library, where uniqueness is de ned as there being no other library with a similarity greater than n. The similarity of two libraries is de ned their Jaccard index, J(A, B) = |A B| |A B| .
On most days, 90% of libraries have no more than half their  les in common.
GUID; the lower portion compares all  les in the library of each GUID (from a Gnutella browse request).
GUIDs that have tens of  les or more are easy to distinguish from others.
Figure 7 shows that in general, GUIDs with a single  le are easily aliased with other GUIDs with the same single  le: only about 58% of GUIDs have unique libraries on a given day of our dataset.
Among the 40% of Gnutella GUIDs that have two or more FOI, over 95% have unique libraries.
Among the 25% of GUIDs with three or more FOI, over 99% have distinct libraries.
Fewer aliases are present when comparisons can be made of the complete libraries, as is possible with Gnutella browse information, by including all  les, not just FOI.
This is illustrated in the lower portion of Figure 7.
Note that GUIDs with a single FOI typically possess more than one  le, and thus they are more likely to be unique.
Typically, GUIDs seen with two or more  les in their library had a unique library about 95% of the time; GUIDs with three or more  les were unique over 99% of the time.
The above data suggest that we can treat GUIDs as 639uniquely distinguishable when their libraries contain at least two FOI or when we consider all  les that they share.
The analysis also suggests that users are rarely if ever changing their GUID and appearing on the same day with the same library.
They would appear as aliases if so, and if this was common, the fraction of unique libraries would be lower.
Based on a similar analysis, we also make the claim that there is no compelling evidence that many users are changing GUIDs appearing on the network that day and preserving only most of their shared libraries.
Figure 8 quanti es the uniqueness of partial and complete libraries using the Jaccard index: J(A, B) = |A B| |A B| .
In the upper portion of Figure 8, we see that for GUIDs with at least three FOI, approximately 90% of libraries have no more than half their  les in common on most days of our study.
In the lower portion of Figure 8, we compare all  les in each GUID s library, not just FOI.
Here we see on most days, 85% of libraries have no more than 30% of their  les in common.
A limitation of our calculations above is that we compare GUIDs only within a day s time.
We haven t computed all-pairs, all-times equivalence or similarity among GUID libraries across multiple days because the computation is too lengthy to handle in a reasonable timescale for our dataset.
The limitations of our study prevent us from providing more than conservative lower bounds on the observable activity of CP perpetrators.
First, our set of known FOI is likely biased towards  les and  lenames shared by tra ckers in the U.S. Tra ckers in other countries are likely underestimated by our study.
Second, all of our records would ideally be associated with a browse, in other words, a complete listing of the peer s current  les.
eMule does not support browse functionality at all, and investigators do not browse all Gnutella peers on all days.
For example, a peer may be identi ed as having  le A on day 1 and day 3, but that  le is not seen on day 2 because the appropriate keyword or hash search was not run.
As a result, we may be underestimating the amount of CP content possessed by each peer as well as the number of days they are online.
Third, peers that are online more often are also more likely to be found using a search.
We might be underestimating the number of peers that are rarely online and have few  les.
On the other hand, one user might have one or more installations of the p2p client software, with each installation showing up as a di erent GUID.
Hence, the number of GUIDs in these networks serves as a rough upper bound on the number of users (for the FOI we knew about).
We also note that before, during, and after the collection of the datasets we analyze, law enforcement were and are active in investigating and arresting CP tra ckers.
We do not know which peers were removed from the network, and we do not take these removals into account in our analyses.
The speci c metrics we report on do not rely on linking arrested users to a search warrant and the outcome of a subsequent trial.
Ecosystems & Underground Economies.
Our work is similar in theme to a body of work exploring economic characteristics of network-based ecosystems [2, 5, 10, 13, 18].
For example, the irregular use of Tor by the peers in our dataset might be explained by recent work showing that users abandon privacy for short-term bene ts [1].
Content Availability in P2P Systems.
A large body of related work on p2p systems investigates availability, performance, and issues related to the use of incentives [3, 4, 6,
 on understanding and analyzing the unique properties of p2p networks and their users  behavior, and do not speci cally target CP or separate aggressive subgroups.
CP Tra cking in P2P Systems.
Prior studies of CP-related tra cking on the Internet have a limited scope.
They are mostly indicative of the alarming presence of contraband rather than comprehensively quantifying how the  les are being shared [8, 12, 21, 22].
All previous work focused on CP (rather than copyright violations) is based on only CP-related search terms rather than veri ed content [7, 8, 12, 23, 24].
The exception is our own prior work [14], where we analyze CP-related activity on Gnutella during a  ve-month period with no overlap with the study in this paper.
In that work, we show that the correspondence between IP addresses and application-level identi ers is not one-to-one, and then propose proactive methods of di erentiating the end hosts.
In contrast, our focus in this work is on reducing availability and characterizing peer behavior.
The criminal tra cking of CP on p2p networks is widespread, with no easy answers for law enforcement looking to curtail it.
The diversity in peers  location, the redundancy of their libraries, and the many p2p networks, coupled with limited law enforcement resources, dictate triage as a strategy.
Speci cally, investigators should carefully choose peers to investigate and remove from p2p networks.
We have shown that although naive approaches to triage are ine ective and optimal approaches are NP-Hard, tractable heuristics yield reasonable and useful results.
Further, the use of these heuristics are complemented by our discovery of aggressive subgroups of CP tra ckers, where such groups correspond to aspects of the heuristics we identi- ed.
Prioritizing enforcement in these groups is both e ective and easily understandable by LE and policymakers alike.
Further, we have found no signi cant evidence of users attempting to hide by altering their visible  le libraries: peers  libraries are largely unique, strongly implying a unique user behind each such library.
Some users do use Tor, but surprisingly, most do so inconsistently, making the investigation of such users straightforward.
It is an open question as to whether network-observable behaviors, such as interest in particular types of imagery, correlate with o line behaviors of interest to LE, such as child molestation.
In ongoing and future interdisciplinary work, we will explore this interesting question.
following awards.
UMass personnel were supported in part by CNS-1018615 (re: CP p2p tra cking), CNS-0905349 (re: geographic/mobile analysis in techreport), or 2008-CE-CX-K005 (re: tool development).
Wolak was supported in part by CNS-1016788 (re: CP p2p tra cking).
Albrecht was supported in part by CAREER award CNS-0845349.
We are grateful for the comments and assistance of Hanna Wallach.
