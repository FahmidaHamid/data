shown alongside Online advertisements each other compete rst, for the user s attention, and then for a conversion.
The e ectiveness of an ad, therefore, depends not only on targeting it accurately to a relevant user, but also on the set of other advertisements that are displayed along with it: when an ad for a product is shown along with other high-quality competing ads, the chance that a user will purchase from the  rst advertiser is diminished.
Online ads that are shown together thus impose negative externalities on each other.
This externality e ect comes from two factors.
First, the presence of other advertisements decreases the amount of attention an ad gets from a user: the user may not notice or click on an ad because of other competing ads.
Second, even if a user notices or clicks on an ad, he may not convert on it, but instead convert on a competing advertisement.
Indeed, a user looking to purchase a product would arguably click on multiple ads before deciding which one to convert on.
Such ads, which have already successfully competed for attention, now compete with each other for a conversion from the user.
This externality e ect from post-click competition for conversions cannot be captured by models of clickthrough rates, which only model the e ect of other ads on user attention; rather, as we argue below, they a ect advertisers  private values per-click.
In this paper, we will focus on the e ect of externalities on conversions, and the design of adequately expressive auctions for such externalities.
In sponsored search auctions, where advertisers bid per click but ultimately derive value from conversions, the presence of externalities a ects the private value.
An advertiser s value-per-click is the product of her value-per-conversion times the probability of a conversion conditional on a click, i.e., vclick = vconv   P r(conv|click).
If P r(conv|click) depends on whether or not other ads are simultaneously displayed, the advertiser s (private) value-per-click will be different as well   that is, the private per-click-value is no longer one-dimensional.
In such a situation, a mechanism such as the existing GSP mechanism1, which solicits only a one-dimensional bid and always displays a full slate of ads, can be arbitrarily ine cient2.
To achieve e ciency,

 mechanism must be adequately expressive.
In general, an advertiser s valuation in an auction with n bidders and externalities can be a function v : 2n   R, which is exponential in the number of bidders3.
Allowing very general valuations, even with restrictions on the model to ensure reasonably-sized reports, has two problems.
First, reporting high-dimensional valuations imposes a heavy cognitive burden on advertisers (particularly the less sophisticated ones), who may not be able to determine their values for a wide range of outcomes [17, 19], making such a bidding language highly impractical.
Second, in general, set-based valuations can lead to computational hardness and inapproximability in the winner determination problem, by reduction from independent set4.
We will adopt a very simple valuation model for external-ities, based on exclusivity: an advertiser s value depends on whether or not other ads are shown along with her ad, i.e., whether she is shown exclusively or not.
Such a valuation model is very reasonable in the context of online advertising:  rst, only one additional bid is solicited from advertisers, in addition to the bid they already place in the existing GSP auction.
Second, given that bidding languages that involve competitor identities can lead to computational hardness, a natural, expressive bidding language is one that speci es a value for each possible number of other ads displayed along-with  i.e., if k is the number of slots, this valuation would be represented by a (decreasing) k-dimensional vector.
Our two-dimensional valuation is a simple approximation, especially from an advertiser s point of view, for such a vector.
Also, the two-dimensional language based on exclusivity can arguably better represent5 valuations where the identity of competitors actually in uences value, such as for keywords where some competing ads cause much greater decrease in value than others.
We will be interested in designing expressive GSP-like mechanisms for this setting with two-dimensional private values (i.e., with and without exclusivity).
By GSP-like auctions, we mean auctions that are extensions, in ways we will make precise, of the generalized second price auction (GSP) currently used to sell sponsored search ads.
Such and   if any other ads are shown along with.
Since GSP does not have an outcome which displays a single ad, advertisers simply bid according to their value of  , resulting in an ef- ciency of most n  compared to the optimal e ciency of 1 (display a single ad).
value depends not just on the set of all winners, but also on the exact allocation, such as the precise ordering of other advertisers in slots in sponsored search.
0 , if any of her neighbors are included in the set of winners, and 1 otherwise.
Choosing the optimal set of advertisers to display corresponds exactly to  nding the largest independent set in the graph.
full slate of other ads, the competitors that cause the greatest decrease in value to her are included as well, causing the maximum decrease in value; in contrast, when only one other ad is displayed along with, the value obtained would depend on whether that ad is a strong competitor (minimum value) or not (maximum value).
So an advertiser can simply use his highest and lowest valuations in the exclusivity-based language, but deriving his value vector when some competitors a ect value more than others is much harder for the k-dimensional bidding language.
auctions have two major advantages over auctions that deviate signi cantly from GSP (such as the VCG auction):  rst, advertisers face a smooth transition between the existing and new system, and do not  nd themselves faced with an unfamiliar and complex auction; second, they are also are easier to build and integrate with the existing system.
Auctions which are extensions of GSP are therefore far more likely to actually be deployed in practice.
Other research on designing auctions for sponsored search with more complex valuations has focused on extending the GSP auction as well ([2, 16]), re ecting the practicality of designing such GSP-like auctions.
Results and Organization.
We design two expressive auctions that are both extensions of the GSP auction, and analyze their equilibria for revenue and e ciency.
Both auctions take as input two-dimensional (per-click) bids (b, b ) for exclusive and nonexclusive display, and have two types of outcomes: S, where a single ad is displayed, and M, where a full slate of multiple ads is shown.
Since both auctions are not truthful and can have multiple equilibria, we compare the equilibria of each auction to V CG2D, the VCG auction for two-dimensional valuations (we also provide additive bounds or pointwise comparisons of equilibria of the two auctions where possible).
There are two natural ways to extend the GSP auction to this two-dimensional setting.
The  rst is to require that when multiple ads are displayed, the outcome should exactly match GSP.
Our  rst auction, GSP2D, has the property that when the outcome is M, the allocation and pricing is exactly as if the bids b  had been submitted to the original GSP auction (it then remains to design the rule deciding whether the outcome will be S or M, and the pricing for S, to ensure good equilibrium properties).
The second is to extend the  next-price  principle of GSP to the two-dimensional setting: our second auction, N P2D has the property that every winner pays the minimum amount necessary to keep his position (note that GSP2D is not a next price auction: in the two-dimensional setting, maintaining one s position in outcome M involves both maintaining the outcome type (M versus S), and maintaining one s ranking amongst the winners in
 The comparison between the two auctions is rather subtle.
N P2D has better e ciency guarantees than GSP2D when the e cient outcome is M, while GSP2D is, roughly speaking, slightly better when the e cient outcome is S. In all cases, the welfare in all  good  equilibria where losers bid at least their true value is guaranteed to be at least half the optimal e ciency (we show that such good equilibria always exist for both auctions).
In terms of revenue, N P2D has better revenue guarantees when the equilibrium outcome is S, dominating the V CG2D revenue, while GSP2D is guaranteed to have at least half the V CG2D revenue.
When the equilibrium outcome is M, all envy-free equilibria of GSP2D dominate the V CG2D revenue, whereas there is no corresponding multiplicative bound for N P2D.
However, all envy-free equilibria of N P2D revenue-dominate V CGM , the revenue from the one-dimensional VCG mechanism; also, all the high-revenue M-equilibria of GSP2D are M-equilibria of N P2D as well.
Further, unlike GSP2D, the N P2D auction is guaranteed to always have an equilibrium with revenue at least as much as the current GSP mechanism.
Related Work.
There is a rapidly growing literature on externalities in online advertising, starting with the work in rectly apply to sponsored search.
Externalities in sponsored search are studied theoretically by [3], [15], [11] and [21], and empirically by [12, 14].
However, all of these focus on the e ect of externalities on the clickthrough rate, that is, the attention aspect.
The work in [7] does address the conversion aspect; however, it assumes a speci c form for the conversion rates and more importantly, focuses on analyzing equilibria for this model of conversion rates under the existing GSP mechanism.
In contrast, we focus on designing mechanisms with a more expressive bidding language and outcome space.
In simultaneous and independent work, [16] proposes the agenda of designing auctions where advertisers bid for con gurations; our work provides a thorough design and analysis for one type of con guration, namely exclusivity (see  5 for a more detailed discussion on the relation between the two problems).
[18] studies auctions with share-averse bidders, i.e., bidders su ering from negative externalities when an item is shared amongst multiple competitors, exactly as in online advertising.
However, [18] focuses on characterizing the revenue-maximizing single item auction for this setting, whereas we want to design GSP-like auctions for sponsored search.
Finally, a primary motivation for our work is the loss in e ciency due to limited expressiveness.
The work in [5] provides a general theory for expressiveness in mechanisms, and relates the e ciency of mechanisms to their expressiveness in a domain independent manner.
There are n advertisers bidding for a page with k slots.
Advertiser i s private value is the two-tuple (vi, v  i), where vi is her value-per-click for being displayed exclusively, i.e., with no other ads on the page, and v  i is her value-per-click if other ads are shown as well.
We make the natural assumption that each advertiser (weakly) prefers exclusivity, i.e., vi   v  i.
There are two types of outcomes: S, where only a single ad is displayed on the page, and M, where multiple ads are displayed.
(Note that the maximum possible number of ads are always displayed in M, since bidders do not have, or express, higher values for displaying i ads, 1 < i < k.) We denote the clickthrough rate (CTR) of the i-th slot in outcome M by  i, and assume, without loss of generality, that the CTR of the only slot in outcome S is 1.
It is natural to expect that the CTR with outcome S is at least as large as than that of any slot in M, i.e., 1    1   .
.
.
   k.
We also de ne  i = 0 for i > k for convenience.
(We point out that our results also extend to the case of separable clickthrough rates, where the CTR of an ad in a slot is a product of an ad-dependent clickability and a slot-dependent clickability; we use the simpler model for clarity of exposition.)
i), where bi and b  Each advertiser s two-dimensional bid is denoted by (bi, b  i represent her bids for outcomes S and M respectively.
We refer to the vi and bi as S-values and S-bids, and v  i as M-values and M-bids.
We order advertisers in decreasing order of their M-bids so that 6, and use [i] to refer to the advertiser b  1   b  2   .
.
.
  b  i and b  n
 cle access to the true values for tiebreaking; this assumption is made only for clarity of presentation and is not at all [1]   v  [2]   .
.
.
  v  with i-th highest M-value, i.e., v  [n].
We will use the indices max and max2 to denote the bidders with the highest and second highest S-values, so vmax   vi for every i, and vmax2   vi for every i 6= max.
We will also abuse notation to use bmax and bmax2 to denote the highest and second highest S-bids, respectively (in all equi-libria of interest, these will actually correspond to the same bidders as with the true S-values).
Furthermore, we de ne vmax i and bmax i to be the advertisers who have highest S-value and highest S-bid excluding advertiser i.
In other words, vmax i = vmax and bmax i = bmax if i 6= max, and vmax i = vmax2 and bmax i = bmax2 if i = max.
Finally, to simplify notation, we sometimes skip the lower bound of i is summation when it is 1; e.g., the summation Pk abbreviated to Pk A mechanism for this setting decides on the winning con guration, i.e., whether the outcome is S or M, and the winning advertisers (and their ranking if the outcome is M), and the prices for the winners.
The VCG mechanism, of course, applies to this setting, and is a truthful mechanism which always produces an e cient (i.e., welfare maximizing) outcome.
i=1,i6=j v  i6=j v  i.
Definition 2.1 (V CG2D).
The VCG mechanism com-i=1  iv  i.
pares vmax and Pk   If vmax   Pk i=1  iv  i, VCG allocates the page to only one advertiser, namely max, and charges him either the sum of the k highest  iv  is (excluding himself ) or the second highest S value, whichever is larger, i.e., the winner s payment is max(vmax2 , max  1 Xi=1  iv  i + k Xi=max  iv  i+1).
i=1  iv    If vmax < Pk i, then VCG allocation is M, but the expression for the payments is more complicated.
When advertiser i is removed, the e cient reallocation can be either S or M. If it is S, the winner is vmax i , and hence, the increase in the sum of the values of j .
If the e cient reallocation is M, all advertisers below i will move one slot up, therefore, the sum of their val-j+1.
Therefore, i-th all advertisers other than i is vmax i  Pk ues increases by Pk advertiser s payment,  ipi, is (for i   k): j=i( j    j+1)v  j6=i  jv  max( k Xj=i ( j    j+1)v  j+1, vmax i    jv  j +  ivi).
k Xj=1 We use V CG2D to denote the VCG mechanism applied to our setting where bidder values are two-dimensional, and V CGM to denote VCG for the one-dimensional setting studied in [20, 8], where the only possible outcome is M and advertisers have one-dimensional valuations.
We make this distinction to easily distinguish between the VCG revenues in the various settings.
Restricting Equilibria.
We will be interested only in equilibria where losers bid at least their true value, which we will refer to as  good  equilibria.
This is particularly relevant when the outcome is S: while there might be Nash equilibria where the losing bidders must bid b  i to ensure i < v  essential to the proofs.
is unreasonable to expect that the losing bidders will not bid higher in an e ort to change the outcome to M, which would give them positive utility.
Thus, Nash equilibria where the outcome is S but losers bid less than their true values simply to maintain equilibrium are unlikely to exist in practice.
since the e ciency and revenue guarantees for GSPM relative to V CG1D themselves hold only for envy-free equilibria of GSPM .)
The easy lemma below, which follows immediately from individual rationality, will be used repeatedly in the following two subsections.
In this section, we design an auction with the following property: given a set of bids (bi, b  i), suppose the auction decides to display multiple ads, i.e., the outcome is M. Then, the allocation and pricing for the winning ads is exactly the same as when GSPM is applied to the bids b  i.
This requirement ensures the practical bene t that when multiple ads are displayed, advertisers see no di erence at all between the new auction and the existing system.
Given that the allocation pricing for outcome M is completely speci ed, it remains to design the rule that decides whether the outcome will be S or M, as well as the pricing for S. The GSP2D auction is de ned below.
Definition 3.1 nism GSP2D takes as input bids (bi, b  (The GSP2D auction).
The mecha-i) and compares bmax i to decide whether the outcome should be S or M.
i=2  i 1b  to Pk+1   If bmax  Pk+1 bidder max, whose payment is Pk+1   If bmax   Pk+1 i=2  i 1b  i=2  i 1b  i, assign the page to bidders
 i.e. bidder i (for i   k) has to pay b  i+1 per click.
i, the outcome is S with winning i per click.
i=2  i 1b  the rule i.e., rather allocation 1 +  2b  Pk+1 compares i=1  ib  i, that Note i=2  i 1b  i, than against Pk against the highest M-bid is completely ignored when deciding the outcome.
This is because the natural allocation rule, which 2 + .
.
.
+  kb  would be to compare bmax with  1b  k, does not quite work: if the bidder with the highest M-value is di erent from the bidder max with the highest S-value, that bidder will always set b  1 = bmax     which changes the outcome to M at no cost to her (as long as there is some other nonzero bid b  i), since the pricing when the outcome is M according to GSP remains b 
 natural allocation rule would imply that the only possible equilibria are those with outcome M, defeating the purpose of designing a more expressive auction.
In the remainder of this section, we will investigate the e ciency and revenue of the equilibria of this mechanism.
The restriction to using GSPM when the outcome is M does cause a potential loss in e ciency and revenue with respect to V CG2D, unlike the case with one-dimensional valuations where all envy free equilibria of GSPM are e cient and dominate V CGM in terms of revenue.
However, as we show below, GSP2D has fairly nice properties nonetheless: both the e ciency and revenue of all reasonable equilibria of GSP2D are guaranteed to be at least within a factor 1/3 and 1/2 respectively of the optimal e ciency and revenue.
(By reasonable equilibria, we mean equilibria of the mechanism where losers bid at least their true value; we show such equilib-ria always exist.
Further, when the outcome is M, we will restrict ourselves, as in [20] and [8], to envy free equilibria, Lemma 3.1.
In any equilibrium of GSP2D with outcome i for every i   k.
i+1   v  M, b 
 We consider two cases, one where the e cient outcome is S, and the other where the e cient outcome is M, and analyze the e ciency of the equilibria of GSP2D.
Note that we prove our e ciency results for all reasonable equilibria, rather than only showing that there exists one equilibrium with these properties.
Due to want of space, the proofs of the following results are omitted, and can be found in the full version of the paper [10].
Theorem 3.1.
If the e cient outcome is S (vmax > i=1  iv  [i]), there is no equilibrium of GSP2D with outcome Pk
 Proposition 3.1.
Suppose the e cient outcome is M.
Every equilibrium of GSP2D with outcome S where losers bid at least their true values has e ciency at least 1/3 of the optimal.
Any envy-free equilibrium with outcome M is e cient.
In this section, we compare the revenues of equilibria in GSP2D with the revenue of V CG2D.
Theorem 3.2.
Suppose the e cient outcome is S. The revenue in any equilibrium of GSP2D where losers bid at least their true values is at least half of the revenue of
 is max(bmax2 ,Pk Proof.
First, recall that by Theorem 3.1, the only possible equilibrium outcome is S, so that the revenue of GSP2D i+1).
We give lower-bounds for both terms and then show that the revenue of V CG2D cannot be larger than the sum of the lower bounds; therefore, the revenue of V CG2D cannot be more than twice of the revenue of GSP2D.
i=1  ib  [1], since v  First we assume max 6= [1].
We have bmax2   vmax2   v  [1]    1v  i   vi, and losers bid at least their true values.
For the other term, we know that all bidders except max are losers in outcome S. Therefore, b  i for every i 6= max.
So we get i   v   ib  i+1   k Xi=1 j 1 Xi=2  i 1v  [i] +  i 2v  [i] k+2 Xi=j+1 where j = min(max, k + 2).
On the other hand, the revenue of V CG2D is max(vmax2 ,  iv  [i] + l 1 Xi=1 k+1 Xi=l+1  i 1v  [i]) where l = min(max, k + 1).
To  nish the proof, we need to show that the sum of the lower bounds we have for GSP2D vmax2 + j 1 Xi=2  i 1v  [i] +  i 2v  [i]   k+2 Xi=j+1 Xi=l+1 k+1 l 1 Xi=1 max(vmax2 ,  iv  [i] +  i 1v  [i]).
If the  rst term in the V CG2D revenue is the dominant term, the inequality obviously holds.
Otherwise, we need to show that vmax2 + j 1 Xi=2  i 1v  [i]+ k+2 Xi=j+1  i 2v  [i]   l 1 Xi=1  iv  [i]+ k+1 Xi=l+1  i 1v  [i], i.e., it is enough to show that  1v  [1] + j 1 Xi=2  i 1v  [i] +  i 2v  [i]   k+2 Xi=j+1 Xi=l+1 k+1 l 1 Xi=2  1v  [1] +  iv  [i] +  i 1v  [i], but this inequality clearly holds using term-by-term comparison.
It remains to prove the the theorem for the case where [2], and the In this case, bmax2   vmax2   v  max = [1].
revenue of GSP2D is k k  ib   iv  [i+2]) Xi=1 max(bmax2 , i+1)   max(bmax2 , Xi=1 while the revenue of V CG2D is max(vmax2 ,Pk [i+1]).
As before, if the dominant term in revenue of V CG2D is vmax2 we are done.
Otherwise, the sum of the two terms of the GSP2D revenue is at least  1v  [i+2] which dominates the second term in the V CG2D revenue term by term.
[2] +Pk i=1  iv  i=1  iv  A simple modi cation to Example 3.1 at the end this section shows that this factor of 2 is tight (set v1 = 3 so that the e cient outcome is S).
The following additive bound on revenue follows immediately from the previous proof: RGSP2D   RV CG2D    1v  [1] +  kv  [k+2].
Theorem 3.3.
Suppose the e cient outcome is M. Any envy-free equilibrium of GSP2D with outcome M has revenue greater than or equal to that of V CG2D.
Proof.
First, note that since the equilibrium is envy-free, the ordering of M-bids is the same as ordering of M-values ([20]), i.e., v  [i] for any i   k + 1.
We show that the payment of advertiser i (for i   k) in GSP2D is at least as much as his payment in V CG2D.
i = v  Recall from 2.1 that the payment for advertiser i in V CG2D is k pi = max( Xj=i least vmax i  Pk ( j    j+1)v  j+1, vmax i    jv  j ).
k Xj6=i First we prove that GSP2D payment of bidder i,  ib  i+1, is at j .
We will prove this by contradiction: if not, we show that there is a bidder with a pro table j6=i  jv  deviation to S. Let l be the bidder with the highest S-value excluding i, i.e. vl = vmax i .
By the contradiction hypothesis,  ib  j .
If l is not a winner, he has a profitable deviation by bidding (vl, b  l) which changes the out-j6=i  jv  j +  ib  j+1.
(Of course, bidding (vl, 0) is a  more pro table  deviation, but is unnecessary for the argument.)
come to S because vl > Pk i+1 < vl Pk i+1   Pk j=1  j b  j6=i  j v  So suppose that l is a winner.
Adding and subtracting l+1 and rearranging we get  lb   l(v  l   b  l+1) < vl   ( ib  i+1 +  lb  l+1 +  j v  j).
k Xj6=i,l l): the price for S is at most Pk Note that the term in parentheses on the right hand side is an upper-bound on the price that l has to pay for S if he deviates and bids (vl, b  j+1 (since the outcome with the original vector of bids was M, j+1, so the price for S is always dominated by this term).
Since b  j (the original vector of bids was in equilibrium), the price for S is upper-bounded by ( ib  j ) as claimed, showing that l can deviate pro tably.
(Note that as before, this bid does change the outcome to S.) bmax  Pk l+1 + Pk i+1 +  lb  j6=i,l  jv  j+1   v  j=1  jb  j=1  j b  The fact that  ib  j+1 follows from the lower bound on bids in envy-free equilibria in [20], which also holds for envy-free equilibria in outcome M of
 i+1   Pk j=i( j    j+1)v  Theorem 3.4.
Suppose the e cient outcome is M. The revenue in any equilibrium of GSP2D with outcome S where losers bid at least their true values is at least half of the revenue of V CG2D.
p1 The revenue proceeds considering unfortunately, cases.
i=1  ib  Proof.
The proof, For [j+1], and p2 i+1).
j=i( j    j+1)v  max(bmax2 ,Pk i =Pk The revenue of V CG2D is Pk i=1 pi, where pi = max(p1 First note that p1 i    iv  [i+1].
Also, rationality we have pi    iv  [i].
by of GSP2D is ease of notation let [j].
i ).
from individual i = vmax i  Pk j6=i  jv  i , p2 We consider the following three cases, and will prove for i=1 pi.
Therefore, the revenue of GSP2D is at least half the revenue of V CG2D.
each case that bmax2 +Pk i+1   Pk i=1  ib 
 i, i   k + 1, is at i in this case, so the revenue of GSP2D is at least [i+1]).
The revenue of V CG2D is [1]   [i].
Since vmax2   v[1]   v  i=1  iv  i=2  iv  [1], we have vmax2   p1, and hence least v   1v  max(vmax2 ,Pk at most p1 +Pk Xi=1 vmax2 + k  iv  [i+1]   p1 +  iv  [i], k Xi=2 which implies that the revenue of GSP2D is at least half the revenue of V CG2D.
[j+1] + [j+2]) because all losers bid at least their true values.
We  rst consider the case where p1 i   p2 i for every i.
The revenue of V CG2D cannot be more this case is at least max(vmax2 ,Pmax  2 Pk j=max  1  j v   jv  j=1 [j+1].
Since vmax2   v  [1]   j   Pk [max], j=1 p1 v  [max]    maxv  than Pk Xj=1 vmax2 + max  2  j v  [j+1]+ k Xj=max  1  j v  [j+2]    jv  [j+1], k Xj=1 which shows the revenue of V CG2D cannot be more than twice the revenue of GSP2D in this case.
let l be some index for which For the other case, p1 l < p2 l .
We consider two cases depending on whether p1 max > p2 max.
For both cases, we upper-bound the V CG2D payment of bidder i (for i 6= max and i 6= l) by  iv  max, the revenue of V CG2D is at most [i].
First, if p2 max or p2 max   p1 max   p1 k k p2 l + p2 max + [j] = vmax   + vmax2    jv  [j] + k  jv  Xj6=max,j6=l Xj6=max = vmax   k Xj=1 k  j v  [j] Xj6=l Xj6=max,j6=l [j]!
+ vmax2 .
 j v  [j]  jv  Since the e cient outcome is M, the term in parentheses is non-positive; therefore, the revenue of V CG2D is bounded above by vmax2 , which is clearly less than or equal to the revenue of GSP2D.
Now, if p1 max, the revenue of V CG2D is max   p2  jv  [j] = vmax    j v  [j] k Xj6=l Xj6=max,j6=l k ( j    j+1)v  [j+1] +  jv  [j].
p2 l + p1 max + k k Xj6=max,j6=l + Xj=max Since vmax  Pk j6=l  jv  [j]    lv  [l] (the e cient outcome is M), the revenue of V CG2D is at most revenue of V CG2D cannot be more than Pk Pk [j+1].
Since vmax2   v  [2]    1v 
 j=1  j v  j=1 p1 j   vmax2 + k Xj=1  jv  [j+2]    1v  [2] +  j v  [j+1] k Xj=2 which shows that the revenue of V CG2D cannot be more than twice of revenue of GSP2D in this case.
The analysis of the other case is almost identical to when max   {[2], .
.
.
, [k]}, so we omit repeating it here.
Example 3.1 shows that this factor 2 is tight as well.
How does GSP2D compare to GSPM in terms of revenue?
Suppose bidders have two-dimensional valuations (vi, v  i), but are only o ered the GSPM mechanism with its one-dimensional bidding language.
Since the outcome of GSPM is never S, bidders will bid according to valuations v  i in GSPM .
The example below shows that the revenue of GSP2D (in every equilibrium) can actually be smaller than the revenue in GSPM , i.e., if the search engine had persisted with the old mechanism.
However, the mechanism we design in the next section does not su er from this potential loss in revenue with respect to GSPM .
Example 3.1.
Suppose there are two slots with  1 =  2 = 1    , and three bidders with values v1 = 1 +  , v2 = v3 = 1, and v  i = 1 for i   3.
The revenue of GSPM for this example is 2   2  for all equilibria, and the utility is 0 for all bidders.
However, if advertiser 1 bids ( , 0), and advertisers 2 and 3 bid truthfully, this is an equilibrium with revenue 1     and payment 1  with utility 2  > 0 for the winner.
In fact, this is the highest possible revenue in any equilibrium outcome of
 Finally, we conclude with showing that good equilibria (where losers bid their true values) always exist, so that the theorems we proved so far are not vacuous.
max  1 k  j v  [j] +  jv  [j+1] Theorem 3.5.
For GSP2D, a good equilibrium always exists.
max  1 Xj=1 Xj=2 =  1v  [1] + Xj=max Xj=max k  j v  [j] +  j v  [j+1].
Since vmax2    1v  get [1], by term-by-term comparison we vmax2 + max  2 Xj=1  j v  [j+1] +  jv  [j+2]   k Xj=max  1 Xj=max [j] + k max  1 Xj=2  1v  [1] +  j v   jv  [j+1], which implies the revenue of GSP2D is at least half of the revenue of V CG2D.
[j+2]) because all losers bid at least their true values.
As before, we  rst consider the case where p1 for every i; the at least max(vmax2 ,Pk j=1  jv  i   p2 i i = v  i=1  i  v  Proof.
Suppose (vi, v  i if i < max, and  v  i = v  i+1 +  l 1 v  1   l   k + 1 (de ne  0 = 0 and  v  i) are the S-value and M-value of the i-th bidder, and suppose that v  i s are sorted in descending order.
We construct a good equilibrium of GSP2D.
Let  v  i be the i-th highest M-value excluding v  max, where max is the bidder who has the highest S-value.
(In the e cient ordering of advertisers excluding max in outcome M, the advertisers occupying the i-th slot has M-value  v  i.)
Note that  v  i+1 otherwise.
Let i for
 i+1 in which everyone except max is bidding truthfully, and max is bidding the maximum possible bid,  v  l 1, to get the l-th slot.
Clearly, S1   S2   .
.
.
  Sk.
Let 0   j   k be the largest index such that Sj > vmax2 .
Let uM = max1 i j  i(v  i), and let t = arg max1 i j  i(v  i); in other words, uM is the maximum utility that bidder max can get if the outcome is M and all other bidders are bidding truthfully.
Also, i+1, vmax2 ) which means uS is the maximum utility that bidder max can get if the outcome S0 =   and Sl = Pl 2 l   1) is an upper-bound on Pk let uS = vmax   max(Pk l 1 +Pk max    v  max    v  i=1  i  v  i=1  ib  i=l  i v  vmax2 > S1 so the outcome will always be S irrespective of max s bid; so there is no deviation for max that changes the outcome to M. Therefore, every bidder except max bidding truthfully and max bidding ( , 0) is a good equilibrium of GSP2D with outcome S. So, for the rest of the proof, we assume j   1, and hence t exists.
If uM   uS, everyone except max bidding truthfully and max bidding (St   2 ,  v  t 1    ) is an equilibrium of GSP2D with outcome M. The outcome is M by de nition of St, and also because St   vmax2 .
Consider a bidder a 6= max.
If bidder a decreases her M-bid, the outcome switches to S leading to utility 0 for her.
Furthermore, since a is bidding her true M-value, any overstating value which results in change of allocation leads to negative utility for a; therefore, a has no pro table deviation.
We know that bidder max is already getting the slot which has maximum utility for her among slots 1, .
.
.
, j, and there is no deviation for her leading to outcome M with slot lower than j.
Therefore, any deviation which leads to outcome M is not pro table for max.
Also, since uS < uM , we know that max prefers outcome M to S, and hence, any deviation which switches the outcome to S can not be pro table.
Next, consider the case where uM < uS.
In this case, all bidders except max bidding truthfully and max bidding ( , 0) is a good equilibrium of GSP2D with outcome S. No loser can change the outcome to M pro tably, and max prefers the current outcome to any M-outcome.
The current GSP auction, GSPM , is a next price auction every winner pays the  next price , i.e., the minimum bid necessary in order to maintain her position, which in GSPM is the bid of the next highest bidder.
In our two-dimensional setting, where there are two types of outcomes in addition to multiple slots, maintaining one s position consists of two things for a winner in outcome M:  rst, the outcome must remain M and not switch to S; second, the bid must enable the bidder to maintain her position amongst the k slots.
In a next price auction for our more expressive setting, therefore, the payment of a winner in slot i of outcome M is the larger of two terms  the  rst being the minimum value at which the outcome still remains M, and the second being the bid of the next bidder, b  i+1, as in GSPM .
The auction is formally de ned below.
Definition 4.1 submit bids (bi, b  i).
Assume max = j, i.e., the bidder corresponding to bmax has the jth largest M-bid, and let   = (The N P2D auction).
Bidders i=1  ib  i.
Pk   If bmax    , the outcome is S with payment max(bmax2 , j 1 Xi=1  ib  i + k Xi=j  ib  i+1).
  If bmax    , the outcome is M and the bidder winning slot i 6= max pays  ipi = max( ib  i+1, bmax     +  ib  i) while the bidder max winning slot j pays  j pj = max( j b  j+1, bmax2     +  jb  j ) Note that in computing the price for outcome S, the second term is smaller than  .
In the next two subsections, we will analyze the e ciency and revenue respectively in the equilibria of N P2D.
As before, we will prove guarantees for the revenue and e ciency of good equilibria, where losers bid at least their true value (such equilibria always exist, as we show in Proposition 4.1).
Some proofs have been removed for want of space, and can be found in the full version of the paper [10].
As before, we consider two cases corresponding to the e -cient outcome being S or M. We  rst start with the following lemma, which allows us to prove the e ciency result for S.
Lemma 4.1.
Assume that bidder max is bidding truthfully.
If the outcome of N P2D for a given vector of bids is S, then the winner max cannot bene t from any deviation that changes the outcome to M.
Proof.
Assume max = j, i.e., the bidder max has the jth largest M-bid for the given M-bids b  i from the remaining bidders.
By assumption that max bids truthfully, b  j = v  j and bmax = vmax.
We need to show that bidder max = j prefers outcome S to any position in outcome M. Consider an M-bid b l 1, i.e., targeting slot l, and assume the deviation changes the outcome to M.
j 1, outcome M gives bidder j negative utility because her payment would be at least j 1 > b  b  j in this case.
So without loss of generality we may   assume b j 1, i.e., l   j.
We have to show of bidder j with b  First notice that if b l   b > b  < b    b        vmax   max(bmax2 ,  ib  i+1)   j 1 Xi=1  ib  i + k Xi=j  lv  j   max( lb  l+1, bmax2     +  lb   ).
We know b  j   b  i for (i   j), therefore, ( j    l)b  j = l 1 Xi=j ( i    i+1)b  j   ( i    i+1)b  i+1 l 1 Xi=j and since b  j = v  j we can write  j b  j   l 1 Xi=j By adding ( i    i+1)b  i+1    lv  j   0.
 ib  i + j 1 Xi=1 l 1 Xi=j  ib  i+1 +  lv  j +  ib  i k Xi=l+1 to both sides of the inequality we get k j 1 l 1 k i   j +  ib  i +  ib   ib  Xi=1 Xi=1 Xi=j i+1 +  lb  therefore, using the inequality above, Xi=l+1 Since the outcome is S, we have vmax   Pk Xi=l+1 i+1 +  lv  Xi=1 Xi=j vmax    ib   ib  j + i + j 1 l 1 k  ib  i.
i=1  ib  i, and  ib  i.
(1) We consider two cases, based on whether the dominant term for the price of max in outcome S is bmax2 or not.
i=1  ib  max(bmax2 ,Pj 1 Pk i=j  ib  b  i for any i, we have i + Pk i+1.
Then, by inequality (1), and since b  term is not i=j  ib  bmax2 , i=1  ib  i+1) = Pj 1 i.e., i + i+1   vmax   j 1 Xi=1  ib  i + l 1 Xi=j  ib  i+1 +  lv  j +  ib  i+1 k Xi=l+1 and, by adding and subtracting  lb  side of the inequality we get l+1 to the right hand vmax   j 1 Xi=1  ib  i+ l Xi=j  ib  i+1+ l(v  j  b  l+1)+  ib  i+1.
k Xi=l+1 The  nal inequality can be written as vmax   ( j 1 Xi=1  ib  i + k Xi=j which implies  ib  i+1)    l(v  j   b  l+1) vmax   max(bmax2 ,  ib  i+1)   j 1 Xi=1  ib  i + k Xi=j  lv  j   max( lb  l+1, bmax2     +  lb   ).
i=1  ib  i=j  ib  i+1) = bmax2 .
Since after deviation,
 Xi=j Xi=1  ib 
 i + j 1 l 1 i +Pk  ib    i+1 +  lb + k Xi=l+1  ib  i, we can rewrite inequality (1) as vmax    lv  .
Now, by just subtracting bmax2 from both sides we get j +      lb   vmax   bmax2    lv  j   bmax2 +      lb   which implies j 1 vmax   max(bmax2 ,  ib  i + k Xi=j Xi=1  ib  i+1)    lv  j   max( lb  l+1, bmax2     +  lb   ).
Theorem 4.2.
Suppose the e cient outcome is M. Then the e ciency in any good equilibrium of N P2D with outcome S is at least 1/2 of the optimal e ciency.
Corollary 4.1.
Suppose the e cient outcome is M.
Then the welfare in any good equilibrium of N P2D with out-[i+1]), where OP T is the optimal welfare and j is the rank of M-value of bidder max, i.e. max = [j].
come S is at least OP T  Pk i=j  i(v  [i]   v  Note that if the marketplace is competitive, i.e., the v  i s are not very di erent, the additive bound shows that the loss in welfare will be small even when the ine cient outcome occurs.
Finally, suppose the e cient outcome is M and the equilibrium outcome is M as well.
A result similar to that [8, 20] stating that all envy free equilibria are e cient holds for N P2D as well.
However, before we state the result, we need to extend the notion of envy free equilibria to N P2D; we will then prove, via Lemma 4.2, that the set of envy-free equilibria are all e cient.
The notion of envy free equilibria in [8] can be thought of as restricting the set of bid vectors that are Nash equilibria to those that also generate envy free prices [13], i.e., a price for each slot such that no bidder envies the allocation of another bidder at this price.
We use exactly this idea to de ne envy free equilibria for outcome M in the N P2D auction: A vector of bids leading to outcome M in N P2D is an envy free equilibrium if for any i and j (1   i, j   n)  i(v  i   pi)    j (v  i   pj) where pi and pj are the prices bidders i and j are currently paying for slots i and j respectively.
(Recall that  i = 0 for i > k.) Lemma 4.2.
If v  b for bidders a and b, and  p >  q for slots p and q, then any allocation A that assigns bidder a to slot q and bidder b to slot p is not envy-free.
a > v  Proof.
Assume for sake of contradiction that A is envy-free and suppose that the prices for slots p and q are pp and pq respectively.
For A being envy-free we must have  p(v  b   pq).
Subtracting the second inequality from the  rst one we get  p(v  b), but this last inequality contradicts v  a > v  a   pq) and  p(v  b   pp)    q(v  a   pp)    q(v  b and  q <  p.
b)    q(v  a   v  a   v  This allows for an easy proof of the following result: such that the e cient outcome is S, i.e., vmax >Pk Theorem 4.1.
Suppose the underlying valuations are [i].
There exists an equilibrium with outcome S where losers bid at least their true values.
Further, there is no ine cient equilibrium where all bidders play undominated strategies.
i=1  iv  Unlike in GSP2D, ine cient equilibria with outcome M (with arbitrarily large ine ciency) can occur in N P2D when the e cient outcome is S. However, all such equilibria are  bullying  equilibria (such equilibria occur in GSPM as well) where some bidder bids above her true value, which (Lemma 7.1 in the full version of the paper) is a weakly dominated strategy in N P2D.
Next, suppose the e cient outcome is M. Here, similar to GSP2D, ine ciency can occur in N P2D as well; however, the extent of ine ciency is less than that in GSP2D, as the following multiplicative and additive bounds show.
The theorem below follows immediately from this lemma, since it implies that in any envy-free allocation (not necessarily even an equilibrium) of N P2D with outcome M, the bidders must be allocated to the slots in decreasing order of their M-values.
Theorem 4.3.
Suppose the e cient outcome is M. Then any envy free equilibrium of N P2D with outcome M is e -cient.
When the equilibrium outcome in N P2D is S, the revenue is high, in the following sense: Theorem 4.4.
Any good equilibrium of N P2D with outcome S has at least the same revenue as V CG2D.
Note that here N P2D does better than GSP2D: the revenue of GSP2D can be as small as half the V CG2D revenue come is either S or M (Theorems 3.2 and 3.4).
However, while N P2D leads to better revenue guarantees when the outcome is S, the same is not true for M: unlike GSP2D, where every envy free equilibrium with outcome M revenue-dominates V CG2D, the revenue in an envy free equilibrium of N P2D can be arbitrarily smaller than that of V CG2D, as the following example shows.
1) = (3, 3) and (v2, v  Example 4.1.
Suppose that there are two slots with  1 =
 (v1, v 
 is M. If the bidders bid (b1, b  2) = (2 ,  ), the outcome is M; it is an envy-free equilibrium; and the revenue is  .
However, revenue of V CG2D on this example is
 1) = (3, 3) and (b2, b  That is, we cannot obtain a result similar to the previous revenue results bounding the revenue loss with respect to V CG2D by a multiplicative constant.
However, as the next three theorems will show, the situation is not quite as bleak as the previous example might suggest:  rst, Theorem 4.5 shows that the revenue of N P2D in any envy-free equilibrium with outcome M is at least the V CGM revenue.
Second, and more importantly, Proposition 4.1 shows that there always exists an equilibrium of N P2D with this revenue  note that this is not the case with GSP2D, where there exist values such that every equilibrium of GSP2D has revenue strictly less than the revenue of V CGM (Example 3.1).
The revenue comparison with V CGM is important for the following reason  the V CGM revenue can be thought of as a proxy for the GSPM revenue, since there always exists an equilibrium of GSPM with this revenue [8], and further, this is a  likely  equilibrium in the sense that if bidders update their bids according to reasonable greedy bidding strategies, the bids converge to this equilibrium of GSPM [6].
Therefore, unlike GSP2D, there always exists an equilibrium of N P2D with revenue at least as much as in GSPM , i.e., the transition to the richer outcome space does not lead to revenue loss.
Finally, Theorem 4.6 shows that the N P2D auction also retains all the high revenue equilibria with outcome M of GSP2D: the reason for the nonexistence of a multiplicative bound with respect to V CG2D is simply that N P2D has a larger set of equilibria, some of which have poor revenue; however, no high revenue M-equilibria of GSP2D are lost in using the N P2D auction.
Theorem 4.5.
Every envy-free outcome (not necessarily an equilibrium) of N P2D with outcome M has revenue at least as much as V CGM .
We point out that the proof of this result is independent of how payments pi are calculated.
In fact, any allocation and pricing (even not restricted to our two-dimensional setting) which is envy-free and e cient satis es the conditions needed for the above proof, and hence has revenue at least as much as V CGM .
Proposition 4.1.
There always exists a good equilibrium of N P2D with revenue greater than or equal to that of
 The revenue of the equilibria constructed in Proposi-[i+1].
Therefore, assuming bidders do not play weakly dominated strategies in tion 4.1 are at least Pk i=1  iv  GSPM (speci cally, bidders do not overstate their values), no equilibrium of GSPM can have revenue higher than the equilibrium of N P2D constructed in Proposition 4.1.
Finally, we show that N P2D retains all the high revenue M-equilibria of GSP2D.
Theorem 4.6.
Every equilibrium of GSP2D with outcome M is an equilibrium with outcome M of N P2D with equal revenue.
That is, while there is no multiplicative bound on the revenue of an envy-free equilibrium of N P2D with outcome M, all the high revenue M-equilibria of GSP2D, which dominate the V CG2D revenue, are also equilibria of N P2D.
We point out an interesting property of the N P2D auction: when bids go up, the revenue can actually decrease.
The following example illustrates this non-monotonicity in revenue as a function of the bids: Example 4.2.
Suppose there are two slots with  1 =  2 =
 outcome is M, and the prices for bidders 2 and 3 are 8 and 1 respectively, so the revenue is 9.
However, if the third bidder increases her bid to (3, 3), the outcome remains M, but the payments change to 7 and 1 for bidder 2 and 3 respectively.
Therefore, the revenue decreases to 8.
When the bids are such that bmax = P  ib  enue is exactly P  ib  i, the total rev-i irrespective of which outcome is chosen.
If the tie is broken in favor of outcome M, every bidder must pay exactly his bid, since for any bid below this the outcome will switch to S. Now suppose all bidders bid b  i +   (and don t change their S bids).
The outcome remains M, but every bidders payment decreases, since the minimum amount needed to maintain outcome M given the other bids has decreased.
So the revenue decreases even though the bids increase.
Note that this revenue non-monotonicity occurs in the VCG auction as well, for the same reason.
However, GSP2D does not have this property in the sense that when the bids increase the total revenue cannot decrease.
Revenue mono-tonicity is often considered a desirable property in practice, and could in uence the choice between which of the two auctions, GSP2D or N P2D is actually used in practice.
In this paper, we designed two expressive GSP-like auctions for exclusivity-based valuations, and showed that they have good revenue and e ciency properties in equilib-ria.
While the N P2D auction has, roughly speaking, better worst-case e ciency properties, and does better than GSP2D in several cases in terms of revenue, it does have envy-free equilibria with poor revenues, and shares VCG s revenue non-monotonicity problem.
Choosing between the two auctions will require an empirical assessment of the marketplace parameters as well as an understanding of bidder valuations and behavior, to predict which equilibria are actually likely to arise in practice.
(Note, as an aside, that there is no way to infer S-values from the current GSPM auction, since multiple ads are always shown.)
There are many directions for further work.
The  rst obvious direction is to combine the more expressive bidding and analyze a model that incorporates both attention and conversion based externalities.
Second, the bidding language we use can be thought of as a way to succinctly represent a general decreasing k-dimensional vector valuation, where an advertiser speci es the  rst entry in the vector (vi), and uses v  i as a proxy for all the remaining k   1 entries.
An alternative language (also discussed in [16]) which also solicits only two bids from an advertiser, is one where an advertiser speci es that he has value vi provided no more than ni advertisers are shown in all (and zero if any more are shown).
Which of these is a better representation of actual advertiser valuations, and which is it possible to design better mechanisms for?
In general, the question of designing succinct mechanisms that achieve high e ciency in the presence of underlying high-dimensional valuations is an interesting open question.
While the auctions we design have pleasant properties with respect to revenue and e ciency in their equilibria, the comparison of these GSP-like auctions to VCG does not remain quite as starkly positive as in the original one-dimensional setting.
Speci cally, unlike [8, 20], where all envy-free equilibria of GSPM are e cient and have at least the revenue of V CGM , both the N P2D and GSP2D auctions su er from losses in e ciency and revenue with respect to V CG2D: neither auction need always have an e cient equilibrium, or one that guarantees at least as much revenue as V CG2D.
In fact, other research [1, 4] suggests as well that the GSPM auction does not always have desirable properties under more complex valuation models or more sophisticated models of bidder behavior.
Our results suggest that while GSP turns out to have excellent properties for the simplest model of advertiser valuations, this is very possibly no more than a fortunate coincidence that does not extend to more complex valuations.
Thus, rather than continuing to build on the GSP auction, it might be necessary to approach the design of more expressive auctions for advertising on the Internet from a clean slate.
The authors are very grateful to Preston McAfee, David Pennock, and R. Ravi for helpful discussions and comments.
