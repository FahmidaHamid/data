While search engines had a transformational e ect on Internet use and indeed, on human interaction, it was only with the advent of keyword auctions that these search engines became commercially viable.
Most of the major search engines display advertisements along with search results; the revenue from these advertisements drives much of the innovation that occurs in search in particular, and Internet applications in general.
Cost-per-click (CPC) auctions have evolved to be the dominant means by which such advertisements are sold [11].
An advertiser places a bid on a speci c keyword or keyword group.
The auctioneer (i.e. the search engine) maintains an estimate of the click-through probability (CTR) of each advertiser for each keyword.
When a user searches for a keyword, the  rst advertising spot is sold to the advertiser which has the highest product of the bid and the CTR; in the event that this advertisement is clicked upon by the user, this advertiser is charged the minimum bid it would have to make to retain its position.
The same process is repeated for the next slot, and so on.
A full description of the tremendous amount of work related to keyword auctions is beyond the scope of this paper; the reader is referred to the excellent survey by Lahaie et al [6].
Two other alternatives to CPC auctions are widely used:
 lisher charges the advertiser for every instance of an This is widely used to sell banner advertisements.
quisition): The publisher charges the advertiser when an actual sale happens.
This is widely used in associate programs such as the ones run by Amazon, and by lead generation intermediaries.
The three models are equivalent when precise estimates of the click-through-probability and click-to-sale-conversion probability are known.
In the absence of such estimates, CPC has emerged as a good way of informally dividing the risk between the auctioneer and the advertiser: the auctioneer is vulnerable only to uncertainty in its own estimates of CTR, whereas the advertiser is vulnerable only to uncertainty in its own estimates of the click-to-sale-conversion probability, assuming its advertisement gets displayed in a favorable spot.
A great deal of e ort has gone into obtaining good predictions of the CTR.
The problem is made harder by the fact that many keywords are searched for only a few times, and typical CTRs are low.
Advertisers often want to also bid by customer demographics, which further exacerbates the sparsity of the data.
Hence, there has to be a great reliance on predictive models of user behavior and new ads (e.g.
see [10]).
Arguably, another approach would to devise pricing models that explicitly take the uncertainty of the CTR estimates into account, and allow advertisers and auctioneers to jointly optimize over this uncertainty.
In general, we believe that as Internet commerce matures, we need not just better estimation and learning algorithms but also more sophisticated pricing models to exploit all the information held by each of the participants.
In this paper, we propose the use of hybrid auctions for search keywords where an advertiser can make a per-impression as well as a per-click bid, and the auctioneer then chooses one of the two as the pricing mechanism.
Informally, the per-impression bids can be thought of as an additional signal which indicates the advertiser s belief of the CTR.
This signal may be quite valuable when the keyword is obscure, when the advertiser is aggregating data from multiple publishers or has a good predictive model based on domain knowledge, and when the advertiser is willing to pay a higher amount in order to perform internal experiments/keyword-selection.
We assume that the advertiser and the auctioneer both have separate beliefs (called priors) on the click-probability of an advertisement.
We describe the hybrid auction in section 2, where we also outline the strategic model (that of discounted rewards) used by the auctioneer and the advertiser.
We introduce the multi-armed bandit problem as it occurs naturally in this context.
Our results, which we have already described at a high level in the abstract, are split into two parts.
Myopic advertisers.
We  rst study (section 3) the case of myopic advertisers, which only optimize the expected pro t at the current step.
When these advertisers are risk-neutral, we show that truth-telling is a strongly dominant strategy: the advertiser bids the expected pro t from an impression as a per-impression bid, and the value it expects from a click as the per-click bid, regardless of the auctioneer s prior or optimization strategy.
Further, if the advertiser is certain about its CTR, and if this CTR is drawn from the auctioneer s prior which follows the natural Beta distribution (de ned later), then the worst case loss in revenue of the auctioneer over pure per-click bidding is at most 1/e   37%.
In contrast, the revenue-loss for the auctioneer when he uses the per-click scheme as opposed to the hybrid auction can approach 100% for a fairly natural scenario, one that corresponds to obscure keywords.
We  nally consider risk taking behavior of the advertisers when they are not certain about their CTR.
We show that per-click bidding is dominant when the advertisers are risk-averse, but per-impression bidding is desirable when they are risk-seeking.
Thus, the hybrid auc-tion
 per-click bidding auctions currently in use, for the case of myopic, risk-neutral advertisers (which is the situation under which the properties of the per-click auction are typically analyzed [11, 4, 1, 8]).
possible revenue gain for the auctioneer in the natural setting of risk-neutral, myopic advertisers, and where the auctioneer uses the Gittins index.
The revenue gain occurs in the common setting of obscure keywords.
account, which neither per-click nor per-impression bidding could have done on its own (both risk averse and risk seeking advertisers occur naturally).
The result bounding the possible revenue loss of the auctioneer under the hybrid auction is for an arbitrary discount factor used by the auctioneer; the results about the possible revenue gain and the risk posture assume a myopic auctioneer.
We believe these are the most appropriate assumptions, since we want to provide bounds on the revenue loss using hybrid auctions under the most general scenario, and want to illustrate the bene ts of using the hybrid auction under natural, non-pathological scenarios.
Semi-myopic advertisers.
In section 4, we remove the assumption that the advertisers are only optimizing some function of the pro t at the current step.
We generalize to the case where the advertisers optimize revenue over a time-horizon.
We develop a tractable model for the advertisers, and show a simple dominant strategy for the advertisers, based on what we call the bidding index.
Though this strategy does not have a closed form in general, we show that in many natural cases (detailed later), it reduces to a natural pure per-click or pure per-impression strategy that is socially optimal.
Thus, our hybrid auctions are  exible enough to allow the auctioneer and the advertiser to implement complex dynamic programming strategies collaboratively, under a wide range of scenarios.
Neither per-impression nor per-click bidding can exhaustively mimic the bidding index in these natural scenarios.
Finally, we show a simple bidding strategy for a certain (i.e. well-informed) advertiser to make the auctioneer s prior converge to the true CTR, while incurring no extra cost for the advertiser; per-click bidding would have resulted in the advertiser incurring a large cost.
This is our  nal argument in support of hybrid auctions, and may be the most convincing from an advertiser s point of view.
We explain throughout the paper why the scenarios we consider are not arbitrarily chosen, but are quite natural process, we obtain many interesting properties of the hybrid auction, which are described in the technical sections once we have the bene t of additional notation.
Multiple Slots.
The main focus of the paper is analyzing the properties of the hybrid scheme on a single ad slot.
However, the auction itself can be easily generalized to multiple slots in two di erent ways; before describing these, we need to note that the hybrid auction assigns an  e ective bid  to each advertiser based on the per-impression bid, the per-click bid, and the expected CTR or quality measure.
The  rst generalization is akin to the widely used generalized second price auction [4, 11] (also referred to as the  next-price  auction [1]) for CPC-only bidding: the advertisers are ranked in decreasing order of e ective bids, and the  e ective charge  made to each advertiser is the e ective bid of the next advertiser.
We do not discuss this variant in the rest of this paper, since the computation methodology is no di erent from single slot auctions.
Note that we can not expect this multi-slot generalization of the hybrid auction to be truthful because even the CPC-only next-price auction is not truthful [11, 4, 1].
However, given the immense popularity of the next-price auction, we believe that this generalization of the hybrid auction is the most likely to be used in real-life settings.
The second generalization mirrors VCG [4] (or equivalently, a laddered CPC auction [1]).
This generalization assumes that the CTR is multiplicatively separable into a position dependent term and an advertiser dependent term, and under this assumption, guarantees truthfulness (on both the per-impression and per-click bids) for myopic, risk-neutral advertisers.
Details of this auction are in section 6.
The proof follows by extending the proof of theorem 3.1 exactly along the lines of [1] and is omitted.
The hybrid auction is also applicable to scenarios where the hybrid bidding is per-impression and per-action (i.e.
CPM and CPA), or per-click and per-action (i.e. CPC and


 As mentioned before, we will assume that there is a single slot that is being auctioned.
There are n advertisers interested in a single keyword.
When an advertiser j arrives at time t = 0, it submits a bid (mjt, cjt) to the advertiser at time-slot t   1.
The interpretation of this bid is that the advertiser is willing to pay at most mjt per impression or at most cjt per click.
These values are possibly conditioned on the outcomes at the previous time slots.
The auctioneer chooses a publicly known value1 qjt which we term the auctioneer index, which can possibly depend on the outcomes for this advertiser at the previous time slots when its advertisement was shown, but is independent of all the bids.
The Hybrid auction scheme mimics VCG on the quantity Rjt = max(mjt, cjtqjt).
We will call Rjt the e ective bid of user j at time t. Let j  denote the advertiser with highest Rj value, and R j  denote the second highest Rj.
There are two cases.
First, suppose mj  > cj  qj  , then j  gets the slot at per-impression price R j  .
In the other case, j  gets R j  qj  .
It is clear that the Hybrid the slot at per-click price
 to not reveal its true prior; this would be an interesting direction to consider in future work.
scheme is feasible, since the per-impression price charged to j is at most mj, and the per-click price is at most cj.
The auction generalizes in a natural way to multiple slots, but we will focus on the single slot case in this paper.
If the auctioneer chooses qj,t to be an estimate of the click-through-rate (CTR) and the advertiser submits only a per-click bid, then this reduces to the traditional next-price auction currently in use.
In order to analyze properties of the Hybrid auction, we need to make modeling assumptions about the advertiser, about the auctioneer index q, and about time durations.
To model the time scale over which the auction is run, we assume there is a global discount factor  .
Informally, this corresponds to the present value of revenue/pro t/cost that will be realized in the next step, and is an essential parameter in determining the correct tradeo  between maximizing present expected reward (exploitation) vs. obtaining more information with a view towards improving future rewards (exploration).
The expected revenue at time step t gets multiplied by a factor of  t.
Note that   = 0 corresponds to optimizing for the current step (the myopic case).
In the discussion below, we assume the auctioneer and advertiser behave strategically in optimizing their own revenues, and can compute parameters and bids based on their own discount factors which could be di erent from the global discount factor   used for discussing social optimality.
For the purpose of designing an auctioneer index qjt, we assume the auctioneer starts with a prior distribution Qj on the CTR of advertiser j.
We assume further that he announces this publicly, so that the advertiser is aware of this distribution.
Therefore, the a priori expected value of the CTR of advertiser i from the point of view of the auctioneer is E[Qj].
Suppose at some time instant t, Tjt impressions have been o ered to advertiser j, and njt clicks have been observed.
The natural posterior distribution Qjt for the advertiser is given by: Pr[Qjt = x]   xnjt (1   x)Tjt njt   Pr[Qj = x]; this corresponds to Bayesian updates, and when initialized with the uniform continuous prior, corresponds to the natural Beta distribution, de ned later.
The auctioneer chooses a function f (Qjt) that maps a posterior distribution Qjt to a q value.
The function f is chosen based on the revenue guarantees the auctioneer desires.
We will use the following idealized scenario to illustrate a concrete choice of f ; our results apply broadly and are not limited to the scenario we describe.
Suppose the auctioneer wishes to optimize over a time horizon given by discount factor  a.
Then, if the auctioneer were to ignore the per impression bids, and uses a  rst price auction on cjqjt assuming that cj is the true per-click valuation, then his choice of qjt should maximize his expected discounted revenue.
Let vj denote the true per-click valuation of the advertiser.
By assumption, vj = cj.
At time t, the auctioneer o ers the slot to the bidder j  with highest vjqjt at per-click price vj  , earning vj  E[Qjt] in expectation.
It is well-known that the discounted reward of this scheme is maximized when qjt is set to the Gittins index (described next) of Qjt with discount factor  a, and hence choice.
The Gittins index [5, 12] of a distribution Q for discount factor  a is de ned as follows: Consider a coin with this prior distribution on probability of heads Q, and that yields reward 1 on heads.
The Gittins index is (1   )M , where M is the largest number satisfying the following condition: Some optimal discounted reward tossing policy that is allowed to retire at any time point and collect a retirement reward of M will toss the coin at least once.
It is well-known that the Gittins index is at least the mean E[Q] of the prior, and for a given mean, the Gittins index increases with the variance of the prior, taking the lowest value equal to the mean only when the prior has zero variance.
Further, the Gittins index also increases with the discount factor  a, being equal to the mean when  a = 0.
An equivalent de nition will be useful: Consider a coin with the prior distribution on probability of heads Qj,t that yields reward 1 on heads.
Suppose the coin is charged G amount whenever it is tossed, but is allowed to retire anytime.
The Gittins index is the largest G for which the expected discounted di erence between the reward from tossing minus the amount charged in the optimal tossing policy is non-negative2.
Typically, the distribution Q is set to be the conjugate of the Bernoulli distribution, called the Beta distribution [5].
The distribution Beta( ,  ) corresponds to starting with a uniform distribution over the CTR and observing  1 clicks in   +     2 impressions.
Therefore, if the initial prior is Beta( ,  ), and n clicks are then observed in T impressions, the posterior distribution is Beta( +n,  +T  n).
Beta(1, 1) corresponds to the uniform distribution.
Beta distributions are widely used mainly because they are easy to update.
However, unless otherwise stated, our results will not depend on the distribution Q being a Beta distribution.
The value bid by the advertisers will depend on their optimization criteria.
The true per-click value of advertiser j is vj.
The advertiser j maintains a time-indexed distribution Pjt over the possible values of the actual CTR p that is updated whenever he receives an impression.
We assume advertiser j s prior is updated based on the observed clicks in a fashion similar to the auctioneer s prior, but again, this is not essential to our results except where speci cally mentioned.
The advertiser s bid will depend on its optimization criteria.
In the next section, we consider the case where the advertisers only optimize their revenue at the current step, and could possibly take risk.
In later sections, we consider the case where the advertisers attempt to optimize long-term revenue by bidding strategically over time.
In each case, the advertiser could be well-informed (or certain) about its CTR, so that Pjt is a point distribution, or uninformed about its CTR, so that it trusts the auctioneer s prior, i.e., Pjt = Qjt, or somewhere in between.
Depending on the optimization criterion of the advertiser, these cases lead to di erent revenue properties for the auctioneer and advertiser, and show the advantages of the Hybrid scheme over pure per-click bidding and pure per-impression bidding.
 )) but the alternate de nition (1    )M (i.e., G) is more convenient for this paper.
In this section, we analyze single time-step properties of the auction.
Speci cally, we assume that the advertisers are myopic, meaning that they optimize some function of the revenue at the current time step.
Since we consider myopic properties, we drop the subscript t denoting the time step from this section.
The auctioneer s prior is therefore Qj, and the advertiser s prior is Pj.
Let pj = E[Pj].
We  rst show that when the advertisers are risk-neutral, then bidding (vjpj, vj) is the dominant strategy, independent of the auctioneer s prior or the choice of f .
Further, if the advertiser is certain about its CTR, and if this CTR is drawn from the auctioneer s prior which follows a Beta distribution, then the worst case loss in revenue of the auctioneer over pure per-click bidding is at most 1/e   37%.
In contrast, the revenue-loss for the auctioneer when he uses the per-click scheme as opposed to the hybrid auction can approach 100% for a fairly natural scenario, one that corresponds to obscure keywords.
We  nally consider risk taking behavior of the advertisers when they are not certain about their CTR.
We show that per-click bidding is dominant when the advertisers are risk-averse, but per-impression bidding is desirable when they are risk-seeking.
Thus, the hybrid auction naturally extends the truthfulness of the single-slot per-click bidding auctions currently in use, results in bounded possible revenue loss but unbounded possible revenue gain, and naturally takes the risk posture of the advertiser into account; the precise qualitative conclusions are detailed in the introduction and the formal statements are proved below.
The result bounding the possible revenue loss of the auctioneer under the hybrid auction is for an arbitrary discount factor used by the auctioneer; the results about the possible revenue gain and the risk posture assume a myopic auctioneer.
We believe these are the most appropriate assumptions, since we want to provide bounds on the revenue loss using hybrid auctions under the most general scenario, and want to illustrate the bene ts of using the hybrid auction under natural, non-pathological scenarios.
We  rst show that the dominant strategy involves truthfully revealing the expected CTR, pj.
Recall that the advertiser bids (mj, cj).
Further, the auctioneer computes an index qj based on the distribution Qj, and does VCG on the quantity Rj = max(mj, cjqj).
Theorem 3.1.
If pj = E[Pj] and the advertiser is myopic and risk-neutral, then regardless of the choice of qj, the (strongly) dominant strategy is to bid (vjpj, vj).
Proof.
First, consider the case where qj   pj.
Suppose the advertiser bids (mj, cj) and wins the auction.
Then, the expected pro t of this advertiser is at most pjvj min{R j , R j  (pj/qj)} which is at most pjvj   R j .
Thus, the maximum pro t of the advertiser can be at most max{0, pjvj   R j } which is obtained by bidding (pjvj, vj).
Next, consider the case where qj > pj.
Suppose the advertiser bids (mj, cj) and wins the auction.
Then, the expected pro t of this advertiser is at most pjvj   min{R j , R j    (pj/qj)} which is at most pjvj   R j    (pj/qj).
Thus, the maximum pro t of the advertiser can be at most max{0, pjvj  R j (pj/qj)} which is again obtained by bidding (pjvj, vj).
Thus, it is never suboptimal to bid truthfully.
Let R  to show that (pjvj, vj) is a (strongly) dominant strategy, we need to show that for any other bid-pair (mj, cj), there exist values of qj, R  such that the pro t obtained by bidding (mj, cj) is strictly less than that obtained by truthful bids.
Suppose  is an arbitrary small but positive number.
First consider the scenario where qj = pj, i.e., the auctioneer has a perfect prior.
In this scenario, bidding (mj, cj) with either mj > pjvj +  or cj > vj + /pj results in a negative pro t when pjvj < R  < pjvj + ; truthful bidding would have resulted in zero pro t.
Further, if mj < pjvj    and cj < vj   /pj, then the advertiser obtains zero pro t in the case where pjvj > R  > pjvj   ; truthful bidding would have obtained positive pro t.
This leaves the cases where mj = pjvj, cj < vj/(1 + ) or where mj < pjvj/(1 + ), cj = vj.
In the former case, the advertiser obtains zero pro t in the situation where qj > pj > qj/(1 + ) and R  = pjvj; truthful bidding would have obtained positive pro t.
In the latter case, the advertiser obtains zero pro t when qj < pj/(1 + ) and R  = pjvj/(1 + ); truthful bidding would have obtained positive pro t.
tioneer s Revenue We now consider the case where the advertisers are certain about their CTR pj and risk-neutral; by the results of the previous section, we will assume that they bid truthfully.
More formally, we assume the prior Pj is the point distribution at pj.
We suppose that the pj are drawn from the auctioneer s prior that is of the form Qj = Beta( j,  j).
We now show that for qj being the Gittins index of Beta( j,  j) for any discount factor  a, the expected revenue of the auctioneer at the current step is at least 1   1/e times the revenue had he ignored the per-impression bids.
Theorem 3.2.
In the above mentioned scenario, the expected revenue of the auctioneer at the current step is at least 1   1/e   63% of the corresponding auction that ignores the per-impression bid.
Proof.
Let qj denote the Gittins index of Qj =Beta( j,  j).
.
q1 h    i Let advertiser 1 have the highest vjqj, and advertiser 2 the next highest.
Let R  = v2q2.
If the per-impression bids are ignored, advertiser 1 gets the impression at a per-click price of v2q2/q1, so that the expected revenue is R  E[Q1] In the Hybrid scheme, v1q1 and v2q2 are both at least as large as R .
Hence, if the auctioneer makes a per-impression charge, then this charge must be at least R  per impression.
If the advertiser makes a per-click charge (which must be to advertiser 1), then the expected revenue is at least R Q1/q1.
Hence the expected revenue of the Hybrid scheme is at least
 and the ratio of the revenue of the Hybrid scheme to the per-click scheme is at least E[min(q1,Q1)] .
For p drawn from the distribution Q1, we now need to   1   1/e.
To show this, observe show that E[min(q1,Q1)] that for a  xed Q1, this ratio is smallest when q1 is as small as possible.
This implies we should choose q1 = E[Q1] =    +  , which corresponds to a discount factor of 0.
Denote   = E[Q1].
Then, the goal is to minimize the ratio   E[min( ,Q1)] as a function of  ,  . Lemma 3.3 shows that this ratio is 1   1/e, completing the proof.
q1 min

 Lemma 3.3.
If w is drawn from the Beta distribution with parameters  ,     1, and   =  /(  +  ) is the mean of w, then E[min( , w)]    (1   1/e).
 +  =  , which is the same as the mean of w.
Proof.
We will allow  ,   to take on fractional values as long as they are both at least 1.
Suppose  ,   are both strictly bigger than 1.
Let z denote the random variable drawn from the Beta distribution with parameters  0 =    ,  0 =     (1    ) , where   > 0 is chosen such that  0,  0   1 and at least one of  0,  0 is exactly 1.
The mean of z is   Let fw, fz denote the probability density functions of w, z respectively, and let Fw(x) (resp.
Fz(x)) denote Pr[w   x] (resp.
Pr[z   x]).
Consider the ratio r(x) = fw(x)/fz(x) =  x (1   x)(1 ) , where   is the ratio of the corresponding normalizing terms and hence does not depend on x.
Observe that r(x) is uni-modal (since the derivative of r is 0 exactly once in the interval [0, 1]); and that r(x)   0 as x   0+ and as x   1 .
Since both Fw(x) and Fz(x) are monotonically decreasing curves connecting (0, 1) and (1, 0), the above properties of r(x) = F 0 w (x) z (x) easily imply that for
 some s   (0, 1), over the interval x   [0, s], Fw(x)   Fz(x), and over x   [s, 1], Fw(x)   Fz(x).
This combined with the fact that E[w] = E[z] =   implies w Lorenz-dominates z, so that for all concave functions g, we have E[g(w)]   E[g(z)] [7].
Since g(w) = min(w, y) is concave in w for  xed y, we have E[min(w,  )]   E[min(z,  )].
Therefore, it is su cient to analyze E[min( , z)]/ , i.e. the case where either   or   is exactly 1, and the other is at least 1.
It is easy to explicitly verify both these cases, and show that the worst case is when   = 1 and       when E[min( , z)] = (1   1/e) .
is   = O` 1 A Typical Case.
Though the Hybrid scheme is not revenue dominant over the pure per-click scheme in pathological cases, the key advantage is in the following typical situation.
There are n advertisers whose CTRs p1   p2       pn are drawn from a common prior Q = Beta(1, K), whose mean
  .
Assume further that n = 4K or K = log n

 2 !
n   log n   1
   n
 Pr[p2   1/2]  
 log n   We have:



 nlog n
 = = 1   o(1) Recall that the advertisers are aware of their CTR, but the auctioneer is only aware of the prior.
Suppose the per-click value for all the advertisers is v, and these are truthfully revealed.
In the per-click scheme, the auctioneer sells the impression to an arbitrary advertiser at per-click price v, and in expectation earns  v.
If the auctioneer is myopic ( a = 0), then q = E[Q] < p2 w.h.p, and the Hybrid scheme charges per-impression.
Here, the auctioneer sells to advertiser 1 at per-impression price vp2.
From the above, E[p2] =  (1), so that E[p2]/  =  (log n).
Therefore, for n advertisers , the auctioneer with di use priors of the form Beta    

 log n gains a factor  (log n) in revenue.
This is particular relevant for obscure keywords, where the auctioneer will have very di use priors.
So far, we have assumed that the advertiser is risk neutral and certain about the CTR, so that he is optimizing his expected pro t.
We now suppose that the advertiser is uncertain and trying to maximize a utility function U on his pro t.
The function U (x) is monotone with monotone derivative, and U (0) = 0.
If U is convex, the advertiser is said to be risk-seeking, and if it is concave, the advertiser is said to be risk-averse.
We show that for risk-averse advertisers, pure per-click bidding is dominant, whereas pure per-impression bidding is dominant when the advertisers are risk-seeking.
It is natural to assume that some advertisers may be either risk-averse or risk-seeking.
Risk-aversion models advertisers with tight budget constraints.
Risk-seeking advertisers also occur naturally in many settings; one example is when advertisers are conducting experiments to identify high performance advertising channels and keywords.
Finding a high reward keyword may result in a higher budget allocated to this keyword and more revenue in the future, making the present utility function of winning this ad slot appear convex at the present time.
We assume the advertisers are uninformed, which is equivalent to assuming the advertiser and the auctioneer share a common prior, so that Pj = Qj.
Essentially, the advertiser has no information and simply trusts the auctioneer s prior3.
In this section, we focus on a single advertiser, and drop the subscript corresponding to it.
Let p = E[P] = E[Q].
As mentioned earlier, we assume that the auctioneer is myopic as well ( a = 0), so that q = E[Q] = p.
Let (m, c) denote the advertiser s bid, and let v denote the true per-click valuation.
Let IR be the indicator corresponding to whether the bidder gets the impression if R j = R.
The bidding strategy of the advertiser will attempt to maximize:     vP   RP p     IR   max E [U (vP   R)] , E
 In the above expression, the  rst term is the expected pro t if the impression is obtained based on the per-impression bid; and the latter term is the expected pro t if the impression is obtained based on the per-click bid.
Our next lemma captures the structure of the dominant strategy.
Lemma 3.4.
If U is concave, bidding (0, v) is a dominant strategy.
If U is convex, the dominant strategy is of the form (m, 0) for a suitably chosen m.
h    i   0.
Therefore, In this Proof.
First consider the case when vp < R.
vP   RP p
 case, regardless of U , E to obtain positive pro t, the bidder has to obtain the impression based on his per-impression bid.
In this case, the expected pro t is E [U (vP   R)].
Note that E[vP   R] < 0.
Therefore if g is concave: E [U (vP   R)]   U (E [vP   R])   U (0) = 0 Therefore, if U is concave and vp < R, then bidding (0, v) is a dominant strategy.
Since obtaining the impression based
 there is no uncertainty, and hence the risk-averse and risk-seeking cases collapse to risk-neutral.
on the per-click bid does not yield positive pro t, if U is convex, bidding (m, 0) with appropriately chosen m is a dominant strategy.
The next and most interesting case is when vp   R. De- ne random variable X = vP   R and Y = vP   RP p .
First note that E[X] = E[Y ] = vp   R   0.
Further, the cumulative distribution functions (CDFs) of X and Y cross exactly once, with the CDF of X being initially larger than the CDF of Y .
This is su cient to show that Y Lorenz-dominates X.
This implies that for U being concave, E[U (Y )]   E[U (X)] [7], so that the advertiser only bids per click.
Further, if U is convex, E[U (X)]   E[U (Y )], so that the advertiser only bids per impression.
Our main result in this subsection is the following property which gives a single natural characterization of the optimum hybrid bid for both risk-averse and risk-seeking advertisers.
We will then show that for risk-seeking advertisers (U is strictly increasing and convex), the expected myopic revenue of the auctioneer is larger in the Hybrid auction compared to the pure per-click auction, and for risk-averse advertisers, the Hybrid and per-click auctions coincide.
Theorem 3.5.
Let m  = max{y|E [U (vP   y)]   0}.
Bidding (m , v) is a dominant strategy.
Further, the auctioneer s revenue in the Hybrid scheme dominates the revenue in the pure per-click scheme.
Proof.
First consider the case when U is concave.
Then, E [U (vP   p)]   U (E[vP   vp]) = 0.
Therefore, m    vp, so that bidding (m , v) is equivalent to bidding (0, v), which is a dominant strategy.
Next, when U is convex, we have m    vp, so that bidding (m , v) is equivalent to bidding (m , 0).
The previous lemma shows that the dominant strategy is of the form (m, 0).
Since m  is the largest value of R j for which the advertiser makes a non-negative pro t, bidding (m , 0) must be the dominant strategy.
The auctioneer s revenue in the Hybrid scheme is the second largest value of max(m  j , vjpj) while that in the per click scheme is the second largest value of vjpj, which cannot be larger.
In this section, we remove the assumption that the advertisers are optimizing some function of the pro t at the current step.
We now generalize to the case where the advertisers optimize revenue over a time-horizon.
We develop a tractable model for the advertisers, and show a simple dominant strategy for the advertisers, based on what we call the bidding index.
Though this strategy does not have a closed form in general, we show that in many natural cases (detailed later) cases, it reduces to a natural pure per-click or pure per-impression strategy that is socially optimal.
Thus, our hybrid auctions are  exible enough to allow the auctioneer and the advertiser to implement complex dynamic programming strategies collaboratively, under a wide range of scenarios.
Neither per-impression nor per-click bidding can exhaustively mimic the bidding index in these natural scenarios.
Recall that the true per-click value of advertiser j is vj, and that the advertiser j maintains a time-indexed distribution Pjt over the possible values of the actual CTR p that is updated whenever he receives an impression.
We assume in a fashion similar to the auctioneer s prior, Qjt.
We assume the bidding strategy of the advertiser is semi-myopic, which we de ne as follows: The advertiser has a discount factor  b.
The bid of an advertiser j depends on its current state hvj,Pjt,Qjti, and on R j in a fashion described next.
At every step, the value of R j is revealed.
If the advertiser j got the impression the previous time step, the value of R j remains the same since the states of the other advertisers remains the same, else it changes adver-sarially.
The optimization criterion of the advertiser is to maximize its discounted expected gain (using discount factor  b) in the contiguous time that it receives impressions (so that the value of R j remains the same).
We make the reasonable assumption that the advertiser cannot optimize for a horizon beyond that, since the value of R j changes in an unknown fashion.
Finally note that a myopic advertiser is equivalent to assuming  b = 0.
Discussion.
The semi-myopic model is closely related to the MDP approach of analyzing repeated auctions; see for instance [2, 3].
These works make the assumption that the priors Pj of the advertisers are public knowledge.
However, this leads to somewhat perverse incentives in which the optimal strategy for an advertiser could be to underbid at the current time step in the hope that the priors of the other advertisers resolve to low values, and he then wins the auction on the remaining time steps at a lower price.
However, note that if there are su ciently many bidders, this scenario is unlikely to happen, and the bidder will attempt to win the auction at the current time slot.
We make this explicit by making the following assumptions:
 the other bidders, but may not be aware of their prior distributions, which are usually private information.
horizon in which he receives the impressions.
In this horizon, R j is  xed, and further, this removes the perverse incentive to underbid described above.
Note that in our model, the bidder is indeed aware of the current bids R j of the other bidders.
However, unlike the model in [2, 3], the optimization time-horizon of the bidder leads to the existence of a nicely speci ed dominant strategy.
We hope that our modeling, that is only slightly more restrictive than ones considered in literature, but which have nice analytic properties, will be of independent interest in this and other contexts.
We  rst show a bidding strategy that we term the bidding index strategy, and show that it is weakly dominant in the class of semi-myopic strategies.
The bidding index B(v,P,Q) is de ned as follows: Suppose the advertiser s current prior is P and the auctioneer s current prior is Q.
Denote the current time instant as t = 0.
Since the advertiser computes this index, we assume the advertiser trusts his own prior but not the auctioneer s.
For a parameter W , de ne the following game between the advertiser and the auctioneer with discount factor  b: At step t   0, suppose the advertiser has prior Pt (with mean E[Pt] = pt) and the auctioneer, Qt (with qt = f (Qt) being the auctioneer s index), the advertiser can either stop the game, or continue.
If he continues, he gains vpt in expectation and pays the auc-; the di erence is his gain.
The adver-tioneer W min     1, pt qt tiser s value for the game is the expected discounted (according to  b) gain for the optimal strategy.
De ne W(v,P,Q) as the largest value of W for which the value of the game with initial priors P and Q, is positive.
This value can easily be computed by dynamic programming, much like the Gittins index.
The bidding index B(v,P,Q) is de ned as: p0 q0 B(v,P,Q) = W(v,P,Q) min
     This is the largest per impression price at time t = 0 for which the value of the above game is positive.
The Strategy: At any time step, when the advertiser j s prior is Pjt with mean pjt, and the auctioneer s prior is Qjt, with qjt = f (Qjt), let Wjt = W(vj,Pjt,Qjt) and Bjt = B(vj,Pjt,Qjt).
The bidding index strategy involves bidding (Bjt, Bjt pjt It is clear that the bidding index strategy is well-de ned for qjt being an arbitrary function f (Qjt) chosen by the auctioneer,and not just for f being the Gittins index of Qjt using discount factor  a.
).
Theorem 4.1.
The bidding index strategy is (weakly) dominant in the class of semi-myopic strategies.
Proof.
Consider a sequence of time steps when advertiser j gets the impression; call this a phase.
During this time, the value R j used in the VCG scheme is  xed; denote this value R .
Suppose at a certain time step, the mean of the advertiser s prior is pjt and the auctioneer computes qjt.
If the advertiser gets the impression, the price he is charged in the VCG scheme is either R  per impression or R /qjt per click.
The advertiser optimizes this by paying R  min(1, pjt/qjt) in expectation per impression.
The state evolution is only conditioned on getting the impression and not on the price paid for it.
Since the advertiser s strategy is semi-myopic, at any time step, the bid should fetch him a non-negative expected pro t for the rest of the phase.
This implies that R    Wjt.
There are two cases.
qjt pjt First, if pjt < qjt, the advertiser essentially bids Rjt = = Wjt   R , and receives the impression at a per.
Therefore, the expected per impression Bjt click price of R  price is R  pjt Next, if pjt > qjt, the advertiser essentially bids Rjt = Bjt = Wjt   R , and receives the impression at a per-impression price of R  = R  min = R  min 1, pjt qjt   .
    .
qjt qjt   1, pjt qjt Therefore, the bidding scheme ensures that the advertiser receives the impression and makes the most possible pro t in the rest of the phase.
Note  nally that if Wjt < R , the maximum possible pro t in the rest of the phase is negative, and the bidding scheme ensures the advertiser does not receive the impression.
Suppose the global discount factor is  .
We de ne the socially optimal strategy as follows: Suppose at time t, advertiser j with prior Pjt receives the impression resulting in value vjpjt for him.
The socially optimal solution maximizes factor  .
We show that the bidding index strategy implements the socially optimal solution in each of the following two situations: (1) The advertiser and the auctioneer share the same prior (Pjt = Qjt), and either (1a) only the advertisers are strategic ( a = 0 and  b =  ) or (1b) only the auctioneer is strategic ( a =   and  b = 0); and (2) The advertisers are certain about their CTR (Pj = pj) and (2a) the auctioneer s index qjt is always at most pj.
The bidding index also has a particularly simple form when the advertisers are certain, and (2b) the auctioneer s qj,t is monotonically decreasing with t and always larger than pj,t.
In both (2a) and (2b), the bidding index strategy reduces to bidding (vjpj, vj).
These scenarios are not arbitrarily chosen, and are the most illustrative scenarios we could  nd.
Scenario (1) corresponds to an advertiser and an auctioneer that trust each other and hence have a common prior; in case (1a), the auctioneer merely discloses its current estimate and trusts the advertisers to bid in an optimal fashion, whereas in (1b) the advertisers delegate the strategic decision making to the auctioneer.
In scenario 2, the advertisers have a de nitive model of the CTR in (2a), we model the case where the auctioneer starts with an underestimate of the click-through rate and hence the qj,t are always smaller than pj to which they will hopefully converge as this advertisement is shown more times and the auctioneer s prior gets sharpened, and in (2b) we model the mirror situation where the qj,t s are always an overestimate.
It will be interesting to  nd a general theorem about the bidding index that uni es all these diverse scenarios.
In each of these cases, the bidding strategy can be implemented using either per-impression or per-click bidding or both, but neither per-impression nor per-click bidding can exhaustively mimic the bidding index in all scenarios.
Shared Priors.
When the advertisers are uncertain and simply share the auctioneer s prior, we have Pjt = Qjt.
Let Gjt denote the Gittins index of Pjt with discount factor  .
The socially optimal solution always gives the impression to the advertiser with highest vjGjt at time t.
Theorem 4.2.
For shared priors, the bidding index strategy implements the socially optimal solution in the following two cases:
 auctioneer is myopic, i.e.,  a = 0.
tioneer is strategic, i.e.,  a =  .
1, pjt qjt Proof.
For the  rst part, we have qjt = pjt since  a = = 1, so that the value Wjt is
 the largest charge per impression so that the advertiser s discounted revenue is non-negative.
This is precisely the de nition of the Gittins index with discount factor  b =  .
Therefore, the bidding index strategy involves bidding ).
This can easily be seen to be equivalent (vjGjt, vj Gjt pjt ), and hence can be to bidding either (vjGjt, 0) or (0, vj mimiced with either pure-impression or pure-click bidding.
Also, we have Rjt = vjGjt, so that the bidding index implements the socially optimal strategy.
Gjt pjt     For the second part, since the advertiser is myopic, the bidding index reduces to bidding (vjpjt, vj).
Since  a =  , we have qjt = Gjt   pjt.
Therefore, Rjt = vjGjt, so that the bidding index implements the socially optimal solution; this can also be mimiced using per-click bidding but not per-impression bidding.
Well Informed Advertisers.
We next consider the case where the advertisers are certain about their CTR pj, so that Pjt = pj.
The socially optimal solution always gives the impression to the advertiser with the largest vjpj.
We show the following theorem: Theorem 4.3.
When Pjt = pj, then the bidding index strategy reduces to bidding (vjpj, vj) in the following two scenarios:
 the strategy is equivalent to bidding (vjpj, 0) and is socially optimal.
   
 decreasing with t.
1, pj qjt Proof.
When pj > qjt for all t, we have min = 1, so that the value Wjt is the largest per-impression price for which the advertiser s discounted revenue is non-negative.
This is precisely vjpj, so that the bidding index strategy reduces to bidding (vjpj, vj).
This is clearly socially optimal.
Since qjt < pj, this is equivalent to bidding (vjpj, 0, but can not be simulated using per-click bids.
When pj   qjt for all t and qjt is monotonically decreasing charged to the advertiser with t, the expected price Wjt increases with time.
At any time t, the advertiser maximizes Wjt by setting it to vjqjt and stopping after the  rst step.
= vjpj.
There-Therefore, Wjt = vjqjt, and Bjt = vjqjt fore, the bidding index strategy reduces to bidding (vjpj, vj); this is also equivalent to (0, vj), but can not be simulated using per-impression bids.
pj qjt pj qjt

 We now show a simple bidding strategy for a certain (i.e.
well-informed) advertiser to make the auctioneer s prior converge to the true CTR, while incurring no extra cost for the advertiser; per-click bidding would have resulted in the advertiser incurring a large cost.
More concretely, this models the scenario where the advertiser has side information about the advertisement s CTR but the auctioneer does not have a good prior, for example, because the keyword may be obscure.
The advertiser has incentive to help the auctioneer  learn  the true CTR because this improves the advertiser s chance of winning an ad slot in a pure per-click scheme.
To motivate why this is important, imagine a situation where the advertiser would not get the slot if the scheme were pure per-click, and he were to bid truthfully per-click, letting the auctioneer use his own estimate qj of the CTR.
Therefore, in the pure per-click scheme, the advertiser has to overbid on the per-click valuation to get the slot enough number of times to make the CTR used by the auctioneer converge to the true value; we show that this results in loss in revenue for the advertiser.
However, allowing for per impression bids preserves truthfulness, and furthermore, helps enue loss to the advertiser.
This is our  nal argument in support of hybrid auctions, and may be the most convincing from an advertiser s point of view.
Formally, we consider an advertiser that is certain about its CTR pj, where vjpj > R j so that the advertiser can (and would like to) win the auction but where qjt < pj, and where the goal of the advertiser is to make the auctioneer s prior converge to the true CTR.
We show that the advertiser can achieve this goal without any loss in revenue, whereas achieving the same objective using per-click bidding would have resulted in a large revenue-loss.
We assume the auctioneer s prior is a Beta distribution.
We show a candidate strategy for an advertiser to make the Gittins index of the auctioneer s distribution, Qjt = Beta( jt,  jt) converge close to its true CTR pj while incurring no loss in revenue.
The loss is de ned as the value earned from actual clicks minus the amount paid to the auctioneer.
We focus on a single advertiser and drop its subscript.
For any  > 0, suppose the advertiser s strategy is as follows: During an  explore  phase, submit a bid of (vp0, v) where p0 = p(1   ), and then switch to bidding (0, v).
During the explore phase, suppose the advertiser gets T impressions on a price per impression basis resulting in n clicks.
Then the worst-case loss in revenue of the advertiser during the explore phase is v(T p0   n).
The  explore  phase stops when the auctioneer s posterior mean of the distribution Beta(  + n,   + T   n) is at least p(1  ).
Note that this also implies that the Gittins index for Beta(  + n,   + T   n) is at least p(1   ) irrespective of the discount factor  ; this in turn implies that by switching to pure per-click bidding, the advertiser is assured that q   p(1   ), so that bidding (0, v) yields Rj   vp(1   ).
Claim 5.1.
Suppose the advertiser knows its true CTR is p, and the auctioneer s initial prior is Beta( ,  ).
For any  > 0, the explore phase incurs no loss in revenue for the advertiser.
Proof.
Let T denote the random stopping time of the explore phase and suppose it results in N clicks.
First note that if T > 0, then p(1   ) >    +  .
The posterior mean on  + +T   p(1 ), which implies N/T > p(1 ).
stopping is  +N Therefore, T p(1   )   N < 0, which shows there is no loss in revenue (provided T is  nite with probability 1, which follows from the law of large numbers in this case).
Suppose R j = vjpj(1   ).
In a pure per-click bidding scheme, the advertiser would have to bid at least vj(1   )pj/qjt at time t < T with an expected loss (i.e. pro t   cost) of pjvj((1 )pj/qjt 1).
For a myopic auctioneer with initial prior (1,  ), the total loss of revenue for the advertiser till time T is  (vjpj ) which can be arbitrarily large.
In this section, we generalize the hybrid auction to multiple slots under the standard separable CTR assumption, such that the resulting generalization is truthful in a myopic setting analogous to Section 3.
Assume there are K slots, where slot i is associated with a CTR multiplier  i   [0, 1].
Slot 1 is the topmost slot; since the CTRs decrease with slot number, we have 1 =  1    2        K   0.
We will also de ne  K+1 = 0.
As before, advertiser j and the auctioneer maintain priors on the CTR value for this advertiser in ad slot 1.
As before, we denote these priors as Pj and Qj respectively.
Let pj = E[Pj] be the expected CTR estimated by the advertiser, and let qj = f (Qj) denote the Gittins index (or for that matter, any other function) of the auctioneer s prior.
Let vj denote the true per-click valuation of advertiser j.
Note that the priors Pj and Qj correspond to the estimated CTR for advertiser j in the  rst ad slot, so that the expected CTR for the ith slot based on the advertiser s estimate is  ipj.
Advertiser j bids (mj, cj), which is interpreted as the per-impression and per-click bids for obtaining the  rst slot.
The auction is modeled after the laddered auction in [1], which is equivalent to VCG under the separability assumption [4].
First, compute the e ective bid Rj = max{mj, cjqj} for every advertiser as described in section 2.
Assume without loss of generality that there are K + 1 advertisers, and that R1   R2   .
.
.
  RK+1.
Then, the auction proceeds as follows:

 as ej =PK    i i+1   i=j  j Ri+1.
impression; else it is charged ej/qj per click.
It is easy to see that ej j = Rj( j    j+1) + ej+1 j+1.
Informally, advertiser j s e ective charge is the same as the e ective bid of the (j + 1)-th advertiser for the additional click-rate at the j-th position, and the same as the e ective charge of the (j + 1)-th advertiser for the click-rate that would have already been realized at the (j + 1)-th position.
Theorem 6.1.
If pj = E[Pj] and the advertiser is myopic and risk-neutral, then regardless of the choice of qj, the (strongly) dominant strategy is to bid (vjpj, vj).
The proof of the above theorem is obtained by extending the proof of theorem 3.1 exactly along the line of the proof of truthfulness of the laddered auction in [1], and is omitted from this version.
This proof can also be obtained using the analysis of VCG with probabilistic allocations, due to Myerson [9].
Advertising is a major source of revenue for search engines and other websites, and a major driver of innovation in web technology and services.
Advertising spots are typically sold on the web using auctions, and these auctions have typically been either Cost-Per-Click (CPC), Cost-Per-Impression (CPM), or Cost-Per-Action (CPA).
We de ned a single-slot hybrid auction, which allows advertisers to enter per-impression as well as per-click bids.
We showed that this auction is truthful for risk-neutral, myopic advertisers, the setting under which such auctions have typically been analyzed.
When advertisers are risk-seeking, or non-myopic, or when the advertiser has much better information about the Click-Through-Rate (CTR) than the auctioneer, we show that the hybrid auction o ers stronger revenue guarantees and advertiser  exibility than either pure CPC or CPM.
The hybrid auction generalizes naturally to multi-slot scenarios ding.
Finally, the hybrid auction is fully backwards compatible with a CPC auction, in the sense that advertisers entering (optional) per-impression bids in addition to per-click bids can seamlessly coexist with advertisers entering only per-click bids in the same auction.
