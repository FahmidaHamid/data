[1] Ittai Abraham, Susan Athey, Moshe Babioﬀ, and

Michael Grubb. Peaches, lemons and cookies: The
impact of information structure on revenue in common
value auctions. working paper, Microsoft Research,
2010.

[2] Dirk Bergemann and Alessandro Bonatti. Targeting in
advertising markets: Implications for oﬄine vs. online
media. Cowles Foundation Discussion Paper 1758R,
2010.

[3] Dirk Bergemann and Maher Said. Dynamic auctions:
A survey. Wiley Encyclopedia of Operations Research
and Management Science, 2010.

[4] Shuchi Chawla, Jason D. Hartline, David L. Malec,

and Balasubramanian Sivan. Multi-parameter
mechanism design and sequential posted pricing. In
Proceedings of the 42nd ACM Symposium on Theory
of Computing (STOC), pages 311–320, 2010.

[5] Pascal Courty and Hao Li. Sequential screening. The
Review of Economic Studies, 67(4):pp. 697–717, 2000.

[6] Eyal Even-Dar, Michael J. Kearns, and Jennifer

Wortman. Sponsored search with contexts. In Internet
and Network Economics, Third International
Workshop (WINE), pages 312–317, 2007.

[7] Arpita Ghosh, Hamid Nazerzadeh, and Mukund

Sundararajan. Computing optimal bundles for
sponsored search. In Internet and Network Economics,
Third International Workshop (WINE), pages
576–583, 2007.

[8] Jason D. Hartline and Tim Roughgarden. Simple

versus optimal mechanisms. In Proceedings of the 10th
ACM Conference on Electronic Commerce, 2009.

[9] Johathan Levin and Paul Milgrom. Online advertising:

Heterogeneity and conﬂation in market design.
American Economic Review, Papers and Proceedings,
100(2), 2010.

Mechanism:
Total Rev
% from BIN
% Imp Unallocated

761.8

0

0.001

851.8

0

0.014

945.6
53.6
0.017

Table 2: Counterfactual revenue results (in dollars) for
the mechanisms in question. AdECN is the mechanism
currently used by AdECN. Opt SPA is the second-price
auction with optimal reserve (r = 0.067). BIN-TAC uses
this same reserve, d = 2, and the optimal price p = 3.8.

tribution straight from the data. The main assumption we
are making here is that bidders believe the environment to
be symmetric and iid, since then our calculated vj correctly
summarizes their incentives. This appears to be a reasonable
assumption since there is little bid correlation and autocor-
relation, although the symmetry assumption is probably too
strong. To get the simulated BIN-TAC outcomes, we re-run
the auctions in turn, assuming the highest bidder takes the
BIN option if their valuation is above vj, and otherwise the
object allocation is randomized between the top two high-
est bidders. We run this procedure on the training data for
various p in order to determine p⋆.

Once these parameters have been determined, we run the
mechanism on the remaining 90% of the data to calculate
counterfactual revenues. For comparison purposes, we also
look at the optimal SPA, the second-price auction with re-
serve r∗. We ﬁnd r∗ numerically, and somewhat surprisingly
r is very close r∗ (the ﬁrst time the virtual valuations are
positive). 2 Thus, the optimal reserve price for the SPA
for our data is the ﬁrst time the virtual valuation is non-
negative. The results are shown in Table 2. Notice that a
large fraction of the revenue in the BIN-TAC mechanism is
coming from the BIN prices: this right tail of valuations con-
tributes 53.6%. This reﬂects the skewness in the observed
valuations. The main ﬁnding is that the BIN-TAC mecha-
nism increases revenues by 11% relative to the optimal SPA,
which in turn improves on the current AdECN mechanism
by 11%. This demonstrates the BIN-TAC mechanism is ef-
fective in extracting revenue, yet still allows targeting.

2See [14] for a further discussion on reserve prices.

WWW 2011 – Session: Monetization IMarch 28–April 1, 2011, Hyderabad, India153[10] R. Preston McAfee, Kishore Papineni, and Sergei

By combining this with Eq. (7), we get,

Vassilvitskii. Maximally representative allocations for
guaranteed delivery advertising campaigns. Yahoo!
Research Working Paper, 2010.

[11] Paulo Klinger Monteiro and Benar Fux Svaiter.

Optimal auction with a general distribution: Virtual
valuation without densities.

[12] S. Muthukrishnan. Ad exchanges: Research issues.

manuscript, 2010.

[13] Roger B. Myerson. Optimal auction design.

Mathematics of Operations Research, 6(1):58—73,
1981.

[14] Michael Ostrovsky and Michael Schwarz. Reserve

prices in internet advertising auctions: A ﬁeld
experiment. Working Paper, 2009.

[15] Mallesh Pai and Rakesh Vohra. Optimal auctions with

ﬁnancially constrained bidders. Working paper, 2009.

[16] Jean-Charles Rochet and Philippe Chone. Ironing,

sweeping, and multidimensional screening.
Econometrica, 66(6):788–826, July 1998.

APPENDIX

A. PROOF OF THEOREM 1

Consider the payoﬀs to taking BIN, denoted by πB(v),
and to TAC, denoted by πT (v), in this equilibrium. They
are given by:

πB(v) = E(cid:2)1(v > Y 1 > v)(v − Y 1)(cid:3)
+ E(cid:2)1(Y 1 < v)(v − p)(cid:3)
|
}
}
πT (v) = E(cid:20)1(Y 1 < v)1(Y ⋆ < v)
(v − Y ⋆)(cid:21)

No rival chooses BIN

Rival chooses BIN

{z

{z

|

1
d

The threshold type v must be indiﬀerent, so

πT (v) ≥ E(cid:2)1(Y 1 < v)(v − p)(cid:3) − E(cid:2)1(Y 1 < v)(v − v)(cid:3)

= πB(v)

Next, we show a v satisfying Eq. (1) exists and is unique.
Suppose d > 1. Then the right hand side of Eq. (1) is a
E[Y ⋆|Y 1 < v]) <
function of v with ﬁrst derivative 1
1. Since at v = 0 it has value p > 0 and globally has slope
less than 1, it must cross the 45◦ line exactly once. Thus
there is exactly one solution to the implicit Eq. (1). On the
other hand, suppose d = 1; then by assumption p < E[Y 1].
Hence, Eq. (1) simpliﬁes to E[Y 1|Y 1 < v] = p, which has a
solution since E[Y 1|Y 1 < v] = p < E[Y 1].

d (1 − ∂

∂v

Finally, we need to argue there are no other pure strategy
equilibria. Let A be the set of types who elect BIN, vA be the
inﬁmum of this set and vB be the supremum of its comple-
ment. Since v is uniquely deﬁned, any such equilibrium can-
not have a threshold form, so vB > vA. Then reasoning sim-
ilar to the above shows that vA − p ≥ 1
E[vA − Y ⋆|Y−i 6∈ A]
d
but vB − p < 1
E[vB − Y ⋆|Y−i 6∈ A], which implies vB < vA,
d
a contradiction.

B. PROOF OF THEOREM 2

TAC Reserve: Fix (r, d) and v ∈ (ωL, ωH ). Then deﬁne
p(r) implicitly as the BIN price that holds v constant as r
changes. The eﬀects of increasing the reserve r slightly are
two: ﬁrst, if only one person has valuation above v, you
can charge them a slightly higher BIN price; second, if all
bidders have low valuation, increasing the reserve may raise
the expected payment of some types, while decreasing the
probability the object will be sold.

The marginal increase in revenue due to the ﬁrst eﬀect is:

nα(1 − α)n−1 1
d

Pr(Y d ≤ r)

(7)

If there are no BIN bidders, we look at the expected pay-

ment from each of the k highest bidders:

πB(v) = E(cid:2)1(Y 1 < v)(v − p)(cid:3)

= E(cid:20)1(Y 1 < v)

1
d

(v − Y ⋆)(cid:21) = πT (v).

We next show that no other type wants to deviate. Suppose
v > v. Then:

πB(v) = E[1(v > Y 1 > v)(v − Y 1)]

+E[1(Y 1 < v)(v − v)] + E[1(Y 1 < v)(v − p)]

≥ E[1(Y 1 < v)(v − v)] + πT (v)

= E[1(Y 1 < v)(v − v)] + E[1(Y 1 < v)

(v − Y ⋆)]

1
d

1

≥

d(cid:0)E[1(Y 1 < v)(v − v)] + E[1(Y 1 < v)(v − Y ⋆)](cid:1)

= πT (v)

(1 − α)n 1
d

d

Xj=k n
j!(1 − FL(r))jFL(r)n−jr
Xk=1(cid:20) d
f (s)FL(s)n−d−1(1 − FL(s))dds(cid:21)

+Z v

r

n!

d!(n − 1 − d)!

Taking a ﬁrst order condition in r, canceling telescoping

terms and simplifying the double summations:

(1−α)n 1
d

d

Xk=1 n

k!k(1−FL(r))k−1FL(r)n−k (1 − FL(r) − rfL(r))

Summing both marginal eﬀects, expanding P (Y d ≤ r) we

set the following equation to zero:

Similarly, for v < v, we have:

1
d

≥ E(cid:20)1(Y 1 < v)

πT (v) = E(cid:20)1(Y 1 < v)1(Y ⋆ < v)
(v − Y ⋆)(cid:21)
E(cid:2)1(Y 1 < v)(v − Y ⋆)(cid:3)
E(cid:2)1(Y 1 < v)(v − v)(cid:3)

1
d

1
d

1
d

−

=

(v − Y ⋆)(cid:21)

(1 − α)

nα d−1

Xj=0 n − 1

j !(1 − FL(r))jFL(r)n−1−j! +
k!k(1 − FL(r))k−1FL(r)n−k (1 − FL(r) − rfL(r))

d

Xk=1 n

Changing the summation limits, factorizing and eliminating
constants:

α + (1 − FL(r) − rfL(r)) (1 − α) = 0

WWW 2011 – Session: Monetization IMarch 28–April 1, 2011, Hyderabad, India154Since FL(r) = 1
1−F (r⋆)

1−α F (r) and fL(r) = 1

1−α f (r) we get r⋆ =
. Note that by Assumption 1, this point is unique.

f (r⋆)

use the same notation as [13]. This approach requires that
the distribution of the values, F , to be strictly increasing.3
Hence, we consider the following distribution of the values.

BIN Price: Let H be the total number of bidders with
high valuations. Also, let V j be a random variable cor-
responding to the j-th highest valuations among the bid-
ders. Deﬁne tH (d, r, j) to be the expected revenue obtained
from the bidder with the j-th highest valuations among the
bidders, conditioned that H agents have high valuations.
Namely,

t0(d, r, j) =

t1(d, r, j) =

1
d
1
d

Pr(V j > r|H = 1)E[max(V d+1, r)|V j > r, H = 1]

Pr(V j > r|H = 0)E[max(V d+1, r)|V j > r, H = 0]

The revenue function when H ≤ 1 is:

π(d, p, r) = nα(1 − α)n−1 (1 − FH (v))p + FH (v)

+ (1 − α)n

t0(d, r, j)

d

Xj=1

t1(d, r, j)!

d

Xj=1

Now since p = d−1

d v + 1
we can substitute to get:

d E[Y ⋆|Y 1 < v] = d−1

d v +t1(d, r, 1),

π(d, p, r) = nα(1 − nα)[(1 − FH (v))

d − 1

d

v + t1(d, r, 1)

+FH (v)

d

Xj=2

t1(d, r, j)] + (1 − nα)

t0(d, r, j)

d

Xj=1

Taking a ﬁrst order condition of the right hand side in

v ∈ [ωH , ωH ]:

d − 1

d

Re-arranging terms:

t1(d, r, j)! = 0

((1 − FH (v)) − fH (v)v) + fH (v)  d
Xj=2
t1(d, r, j)!

(1 − FH (v))

fH (v)

d

d − 1  d
Xj=2

v −

=

Note that by Assumption 1, if there exists a solution, it is

unique. Solving for v:

v =

d

d − 1

d

Xj=2

t1(d, r, j) +

(1 − FH (v))

fH (v)

or in terms of p:

p⋆ =

d

Xj=1

t1(d, r, j) +

(d − 1)(1 − FH (v))

dfH (v)

= RT AC

1

(d, r) +

(d − 1)(1 − F (v))

df (v)

If there exists no interior solution that satisﬁes the ﬁrst

order condition, then v = τ .

C. PROOF OF THEOREM 3

We prove the theorem using the approach proposed by
Myerson [13]. Some deﬁnitions are in order to describe
the ironing approach; for the sake of consistency, we would

fε(x) = 

Fε(x) = 


x ∈ [ωL, ωL]
βfL(x)
x ∈ (ωL, ωH )
ε
fH (x)α x ∈ [ωH , ωH ]

βFL(x)
β + ε(x − ωL)
(1 − α) + αFH (x − ωH ) ∈ [ωH , ωH ]

x ∈ [ωL, ωL]
x ∈ (ωL, ωH )

where β + ε(ωH − ωL) + α = 1. Hence, as ε tends to 0 we
get the original model back. Myerson [13] showed that if
ψε(x) = x − 1−Fε(x)
is strictly increasing, then, the optimal
fε(x)
mechanism would always allocate the item to the bidder
with the maximizes ψ(·). However, if this function is not
increasing, then one needs to “iron” the virtual values. Note
that for x ∈ (ωL, ωH ), and small enough ǫ,

ψε(x) = x −

1 − (β + ε(x − 1))

ε

< 0 ≤ ψε(r⋆)

For q ∈ [0, 1], let F −1

ε

(q) be the inverse of Fε(·). Deﬁne:

h(q) = F −1

ε

(q) −

H(q) = Z q

0

h(y)dy

1 − q

ε

fε(cid:0)F −1

(q)(cid:1)

G(q) = convH(q)

=

min

λ,r1,r2∈[0,1],λr1+(1−λ)r2=q

{λH(r1) + (1 − λ)H(r2)}

This implies that G(·) is the highest convex function on [0, 1]
such that G(q) ≤ H(q) for every q.

Deﬁne φ(v) = G′(F (v)) as the virtual value of type v.
By Theorem 6.1 [13], the optimal mechanism randomly al-
locates the item to one of the bidders with the highest pos-
itive virtual value. In the following, we compute the virtual
values.

Lemma 1. Let q⋆ = (1 − α)v⋆ and v⋆ be the solution of

−F 2(v⋆) + (2 − α)F (v⋆) + α(ωH − v⋆)f (v⋆) = 1 − α.

Under the assumption of Theorem 3, as ε → 0,

G′(q) = 


h(q)
h(q⋆)
h(q)

q ∈ [0, q⋆]
q ∈ (q⋆, 1 − α)
q ∈ [1 − α, 1]

Proof. First note that H(q) is convex in [0, β] because
of the assumption that x − 1−F (x)
is increasing in [ωL, ωL].
f (x)
It is also decreasing in [0, q0] and increasing in [q0, β], where
q0 = F (r⋆) is the minimum of H(·) in this range. Also,
observe that H(q) is decreasing in [β, 1 − α] because h(q) <
0 in this interval.
In addition, by Assumption 1, H(q) is
increasing and convex in [1 − α, 1]. Therefore, G(·) includes
the tangent line from the point (1 − α, H(1 − α)) to H(q) in

3 See [11, 15] for optimal mechanisms when distributions
have discrete support.

WWW 2011 – Session: Monetization IMarch 28–April 1, 2011, Hyderabad, India155In particular,

H(β) = (β − 1)ωL + ωL

For q ∈ (β, 1 − α), because h(q) = 2q−(1+β)

ε

H(q) = H(β) +(cid:20) x2 − (1 + β − εωL)x

(cid:21)q

= (β − 1)ωL + ωL +

= (q − 1)ωL + ωL + (q − β)

In particular,

ε
q2 − β2 − (q − β)(1 + β − εωL)

β

ε

q − 1

ε

(8)

+ ωL, we get

By [13], the expected payment of each bidder i, pi, is:

[0, β]. Let q⋆ be the tangent point. We have

G(q) = 


H(q)
(q−q⋆)H(q⋆)+(1−α−q)H(1−α)

1−α−q⋆

H(q)

q ∈ [0, q⋆]
q ∈ (q⋆, 1 − α)
q ∈ [1 − α, 1]

which immediately leads to the claim. In the rest we com-
pute q⋆. For q ∈ [0, β],

H(q) = Z q

ε

0  F −1
= Z F −1(q)
= Z F −1(q)

ωL

ωL

ε

1 − y

! dy
fε(cid:0)F −1
fε(x) (cid:19) fε(x)dx

(y)(cid:1)

1 − Fε(x)

(y) −

(cid:18)x −

((xfε(x) + Fε(x)) − 1) dx

= (q − 1)F −1

ε

(q) + ωL

H(1 − α) = −αωL + ωL + (1 − α − β)

−α
ε

= −αωH + ωL

To iron the distribution, we compute the tangent from
H(1 − α) to the H(q), for q ∈ [0, 1 − α]. Note that if q⋆ is
the tangent point then

h(q⋆) =

H(1 − α) − H(q⋆)

1 − α − q⋆

(9)

Observe that by Eq. (8) we have

H(1 − α) − H(q⋆)

1 − α − q⋆

=

=

(−αωH + ωL) −(cid:0)(q⋆ − 1)F −1

ε

(q⋆) + ωL(cid:1)

−αωH − (q⋆ − 1)F −1

ε

1 − α − q⋆
(q⋆)

1 − α − q⋆

Let v⋆ = F −1

ε

(q⋆), i.e., q⋆ = Fε(v⋆) = βFL(v⋆). There-

fore,

H(1 − α) − H(q⋆)

1 − α − q⋆

=

−αωH − (Fε(v⋆) − 1)v⋆

1 − α − Fε(v⋆)

h(q⋆) = v⋆ −

1 − Fε(v⋆)

fε(v⋆)

As ε → 0, the Fε(·) → F (·). Plugging into Eq. (9) we get

(v⋆f (v⋆) − 1 + F (v⋆))(1 − α − F (v⋆))

= f (v⋆)(cid:0)−αωH − (F (v⋆) − 1)v⋆(cid:1)

Hence, rearranging the terms,
−F 2(v⋆) + (2 − α)F (v⋆) + α(ωH − v⋆)f (v⋆) = 1 − α
Observe that only if H(1 − α) > H(q0), then h(q⋆) is

positive.
−αωH + ωL ≥ (q0 − 1)F −1 (q0) + ωL = (F (r⋆) − 1)r⋆ + ωL
This is equivalent to αωH ≤ (1 − F (r⋆))r⋆.

Finally, observe that

h(q⋆) ≤ h(β) = ωL ≤ ωH −

1 − Fε(ωH )

fε(ωH )

which shows that G(·) is convex and completes the proof.

By the above lemma, if αωH ≤ (1−F (r⋆))r⋆, the (ironed)
virtual value of a bidder with value v by φ(v) is deﬁned in
Eq. (6). Note that for v ∈ [0, r⋆) the virtual value is in
fact negative, but because the mechanism only allocates to
positive virtual values, it is equivalent to let the virtual value
equal to 0. Also, note that if v⋆ < r⋆, then the mechanism is
equivalent to the second-price mechanism with reserve ωH .
Now we describe the payments, assuming v⋆ > r⋆.

Let v denoted the vector of valuations (bids) of bidders.

pi(v) = vi −Z v

0

ρi(x, v−i)dx

(10)

where ρi(x, v−i) is the probability of allocation to bidder i
with value x, when the values of other bidders is v−i.

Recall that the optimal mechanism awards the good to
the bidder with the highest virtual valuation, breaking ties
randomly, provided the virtual valuation is positive. Let w1
be the valuation of the winning bidder; let w2 be the valua-
tion of the bidder with the second-highest virtual valuation
(again break ties randomly).

Also let k be the number of bidders with bid in [v∗, ωH ).
Then, by Eq. (10), the price for the winning bidder is com-
puted as follows:
w1 ∈ [r⋆, v⋆): By Eq. (10),

p = w1 −Z w1

0

ρi(x, v−i)dx = w1 −Z w1

max{w2,r⋆}

1 dx

Because the probability of the allocation before max{w2, r⋆}
is 0 and after that is 1,

p = w1 −Z w1

max{w2,r⋆}

1 dx

Therefore, p = max{w2, r⋆}.

w1 ∈ [v⋆, ωH ):

If k = 1, similar to the previous case,
p = max{w2, r⋆}. Otherwise, by Eq. (10), the expected
payment of each bidder with vi ∈ [v∗, ωH ) is 1
k v⋆. This
is equivalent to charging the winner v⋆.

w1 ∈ [ωH , ωH ]: If w2 ≤ v⋆ or w2 ≥ ωH then similar to
the ﬁrst case, p = max{w2, r⋆}. If w2 ∈ [v⋆, ωH ), then
p = 1

k+1 (kωH + v⋆).

ρi(x, v−i)dx

p = w1 −Z w1
= ωH −Z ωH

0

=

1

k + 1

1

dx

k + 1

v⋆
(kωH + v⋆) .

WWW 2011 – Session: Monetization IMarch 28–April 1, 2011, Hyderabad, India156
