[1] Gagan Aggarwal. Privacy Protection and Advertising in a
Networked World. PhD thesis, Stanford University, 2005.

[2] Gagan Aggarwal, Ashish Goel, and Rajeev Motwani.

Truthful auctions for pricing search keywords. In ACM Conf
on Electronic commerce, pages 1–7, 2006.

[3] Gagan Aggarwal, S. Muthukrishnan, and Jon Feldman.

Bidding to the top: VCG and equilibria of position-based
auctions. In WAOA, 2006.

[4] Gagan Aggarwal, S. Muthukrishnan, Dávid Pál, and Martin

Pál. General auction mechanism for search advertising.
Available from http://arxiv.org/abs/0807.1297.

[5] Ahmet Alkan. Existence and computation of matching

equilibria. European Journal of Political Economy,
5(2-3):285–296, 1989.

[6] Ahmet Alkan and David Gale. The core of the matching

game. Games and Economic Behavior, 2(3):203–212, 1990.

[7] Sushil Bikhchandani and Joseph M. Ostroy. From the

assignment model to combinatorial auctions. In
Combinatorial Auctions. MIT Press, 2006.

[8] Edward H. Clarke. Multipart pricing of public goods. Public

Choice, 11(1):17–33, 1971.

[9] G. Demange and D. Gale. The strategy structure of two-sided

matching markets. Econometrica, 53(4):873–888, 1985.

[10] Gabrielle Demange, David Gale, and Marilda Sotomayor.

Multi-item auctions. Journal of Political Economy,
94(4):863–872, 1986.

[11] Gabrielle Demange, David Gale, and Marilda Sotomayor. A

further note on the stable matching problem. Discrete
Applied Mathematics, 16:217–222, 1987.

[12] Benjamin Edelman, Michael Ostrovsky, and Michael

Schwarz. Internet advertising and the generalized second
price auction: Selling billions of dollars worth of keywords.
American Economic Review, 97(1):242–259, March 2007.

[13] Eyal Even-Dar, Jon Feldman, Yishay Mansour, and

S. Muthukrishnan. On the effect of minimum prices on
position auctions. In WINE, 2008.

[14] Satoru Fujishige and Akihisa Tamura. A two-sided
discrete-concave market with possibly bounded side

payments: An approach by discrete convex analysis.
Mathematics of Operations Research, 32(1):136–155, 2007.

[15] David Gale and Lloyd S. Shapley. College admissions and

the stability of marriage. Am Math Monthly, 69(1):9–15,
1962.

[16] David Gale and Marilda Sotomayor. Some remarks on the

stable marriage problem. Discrete Applied Mathematics,
11:223–232, 1985.

[17] Theodore Groves. Incentives in teams. Econometrica,

41(4):617–631, 1973.

[18] J. A. S. Kelso and V. P. Crawford. Job matching, coalition

formation, and gross substitutes. Econometrica,
50:1483–1504, 1982.

[19] Harold W. Kuhn. The Hungarian method for the assignment

problem. Naval Logistics Quarterly, 2:83–97, 1955.

[20] Herman B. Leonard. Elicitation of honest preferences for the

assignment of individuals to positions. Journal of Political
Economy, 91:461–479, 1983.

[21] Noam Nisan, Tim Roughgarden, Eva Tardos, and Vijay V.

Vazirani, editors. Algorithmic Game Theory. Cambridge
University Press, Septermber 2007.

[22] M. Quinzii. Core and competitive equilibria with

indivisibilities. International Journal of Game Theory,
13(1):41–60, 1984.

[23] Alvin E. Roth. The economics of matching: Stability and

incentives. Mathematics of Operations Research,
7(4):617–628, 1982.

[24] Alvin E. Roth and Marilda A. Oliveira Sotomayor. Two-sided
matching: A study in game-theoretic modeling and analysis.
Cambridge University Press, 1990.

[25] Lloyd S. Shapley and Martin Shubik. The assignment game

i: The core. Intl J. of Game Theory, 1(1):111–130, 1971.
[26] Hal R. Varian. Position auctions. International Journal of

Industrial Organization, 2006.

[27] William Vickrey. Counterspeculation, auctions, and

competitive sealed tenders. J.of Finance, 16(1):8–37, 1961.

[28] Wikipedia.

http://en.wikipedia.org/wiki/Hungarian_algorithm.

APPENDIX
A. ANALYSIS OF STABLEMATCH

Proofs of statements from Section 6.1.

A.1 Proof of Lemma 11

PROOF OF LEMMA 11. Consider the number of edges in the
update graph.
Initially, the graph G(0) has at most nk reserve-
price, nk maximum-price and n terminal edges. We claim that in
each iteration, the number of edges in the update graph is reduced
by one. Since STABLEMATCH must stop when there are no more
edges left, this bounds the total number of iterations.

Consider an iteration t of STABLEMATCH. We claim that in
the alternating path P = (i0, j1, i1, . . . , j‘, i‘, j‘+1), the last edge
(i, j) = (i‘, j‘+1) will not appear in the update graph G(t+1). This
is easily veriﬁed by considering three cases:

Case 1: If (i, j) is a terminal edge, then w(t)(P ) = d(t)(i0, i) + u(t)

and hence u(t+1)

i

= u(t)

i − (w(t)(P ) − d(t)(i0, i)) = 0.

i

Case 2: If (i, j) is a maximum-price edge, then w(t)(P ) = d(t)(i0, i)+
i −

i + mi,j − vi,j) and hence u(t+1)
(u(t)
(w(t)(P ) − d(t)(i0, i)) + mi,j = vi,j.

+ mi,j = u(t)

i

WWW 2009 MADRID!Track: Internet Monetization / Session: Sponsored Search248Case 3: If (i, j) is a reserve-price edge, then w(t)(P ) = d(t)(i0, i) +
i −(w(t)(P )−

i +ri,j−vi,j) and hence u(t+1)

+ri,j = u(t)

i

(u(t)
d(t)(i0, i)) + ri,j = vi,j.

The utilities never increase and the prices never decrease through-
out the algorithm, thus the edge (i‘, j‘+1) does not appear in any
update graph G(t0) for any t0 > t.
A.2 Proof of Lemma 15
Without loss of generality assume that (u, p, µ) is such that there
does not exist a pair (i, j) ∈ µ such that pj = mi,j. If there was
such a pair, then we can decrease prices of some of the items and
increase utilities of some of the bidders such that pj < mi,j. This
is possible because of the general position assumption. See full
version of the paper.
trivially holds true, since by feasibility of (u0, p0, µ0), p0
all j ∈ J and u0
that u(t) ≥ u0 and p(t) ≤ p0. We ﬁrst prove that

We prove Lemma 15 by induction on t. The base case, t = 0,
j ≥ 0 for
i ≤ B for all i ∈ I. In the inductive case, assume

PROPOSITION 19. u(t+1) ≥ u0 and p(t+) ≤ p0.
We look “continuously” at updates (6) and (7). For that pur-
pose we deﬁne for each i ∈ I a continuous non-increasing function
ui(x),

ui(x) = u(t)

i − max

x − d(t)(i0, i), 0

,

By feasibility of (u0, p0, µ0), p0

and thus bidder i is matched in µ0 to some slot j ∈ J.
j ∈ [ri,j, mi,j]. By the assump-
tion made at the beginning pj 6= mi,j. Therefore in G(t) there is a
forward edge from i to j and thus

d(t)(i0, j) ≤ d(t)(i0, i) + (u(t)

i + p(t)

j − vi,j) .

Clearly, since i ∈ I0,

ui(y) = u(t)

i − (y − d(t)(i0, i)) .

By the price update rule

pj(y) ≥ p(t)

j + (y − d(t)(i0, j)) .

We add (9) to (10) and subtract from that (8) and we obtain

(8)

(9)

(10)

pj(y) ≥ vi,j − ui(y) .
Hence, since by feasibility of (u0, p0, µ0), u0
pj(y) ≥ vi,j − ui(y) = vi,j − u
0
0
i = p
j .
Recalling that p(y) ≤ p0 we see that pj(y) = p0
j.

i + p0

j = vi,j, we have

Subtracting (9) from (8) and cancelling common terms we have

d(t)(i0, j) ≤ y + (ui(y) + p(t)

j − vi,j) .

We upper-bound the right side of the inequality using that ui(y) =
u0
i, p(t)

j ≤ pj(y) and u0

j = vi,j and we have

i + p0

and for each j ∈ J a continuous non-decreasing function pj(x),

d(t)(i0, j) ≤ y + (u

j − vi,j) = y .
0
0
i + p

pj(x) = p(t)

j + max

x − d(t)(i0, j), 0

.

Thus j ∈ J0.

“
“

”
”

Clearly, u(t+1) = u(w(t)(P )) and p(t+) = p(w(t)(P )). To prove
that u(t+1) ≥ u0 and p(t+) ≤ p0, suppose by contraction that there
exists y ∈ [0, w(t)(P )] such that either ui(y) < u0
i for some i ∈ I
j for some j ∈ J. We choose inﬁmal such y. Clearly,
or pj(y) > p0
u(y) ≥ u0, p(y) ≤ p0 and y < w(t)(P ). Consider the sets
= {i ∈ I | ui(y) = u
i and d(t)(i0, i) ≤ y} ,
0
= {i ∈ J | pj(y) = p
j and d(t)(i0, j) ≤ y} .
0

J

I

0

0

CLAIM 20. Each slot j ∈ J0 is matched in µ(t) to some i ∈ I0.
PROOF. Let j ∈ J0. If j was unmatched, then either d(t)(i0, j) =
w(t)(P ) or d(t)(i0, j) = ∞; however both options contradict the
choice of y and that j ∈ J0. Thus j is matched to some i ∈
I, hence in G(t) there is a backward edge from j to i and thus
d(t)(i0, i) = d(t)(i0, j) and therefore ui(y) + pj(y) = vi,j. Fur-
j ∈ [ri,j, mi,j). Con-
ther, invariants (A2) and (B1) imply that p(t)
sequently, there is a maximum-price edge from i to j, w(t)(P ) ≤
d(t)(i0, i) + (u(t)
j =
j ∈ [ri,j, mi,j),
p(t) +(w(t)(P )−d(t)(i0, j)) ≤ mi,j. Therefore p0
j ≥ vi,j and hence ui(y) =
and since (u0, p0, µ0) is stable, u0
vi,j − pj(y) = vi,j − p0
i. On the other hand, by inﬁmality of
y, ui(y) ≥ u0

i + mi,j − vi,j), and hence p0

j = pj(y) < p(t+)

i. Thus i ∈ I0.

j ≤ u0

i + p0

CLAIM 21. Each bidder i ∈ I0 is matched in µ0 to some j ∈

J0.

PROOF. Since in G(t) there is a terminal edge from i to the

dummy slot, w(t)(P ) ≤ d(t)(i0, i) + u(t)
i − (y − d(t)(i0, i))

0
i = ui(y) = u(t)

u

i

. Hence

> u(t)

i − (w(t)(P ) − d(t)(i0, i)) ≥ 0 ,

From the two claims it follows that |I0| = |J|0 and that µ(t)
bijectively matches I0 with J0. In particular i0 6∈ I0. Choose j ∈
J0 with smallest d(t)(i0, j). Consider the minimum-weight path in
G(t) from i0 to j which uses only forward and backward edges.
The vertex on the path just before j is a bidder i 6∈ I0. Clearly,
y ≥ d(t)(i0, j) > d(t)(i0, i) and hence ui(y) < u0
i. There is a
j ∈ [ri,j, mi,j) and also ui(y) +
forward edge from i to j, thus p(t)
pj(y) = vi,j, and hence (*) u0
i + p0
j < vi,j. Since in G(t) there
is a maximum-price edge from i to j, p0
j = pj(y) < mi,j, which
together with (*) contradicts stability of (u0, p0, µ0). This proves
Proposition 19.
To prove Lemma 15 it remains to show that p(t+1) ≤ p0. This
amounts to show that if (u(t+1), p(t+1), µ(t+1)) was obtained from
(u(t), p(t), µ(t)) by updating along an alternating path P of which
the last edge, (i, j) = (i‘, jl+1), was a reserve-price edge and
p(t+)
j < ri,j, then

ri,j ≤ p
0
(11)
j .
j ≥ mi,j. In
Since (u0, p0, µ0) is stable, either u0
i + p0
= vi,j − ri,j, Propo-
former case, (11) follows from that u(t+1)
sition 19 and that (u0, p0, µ0) is stable. In latter case, (11) follows
since the presence of the reserve-price edge from i to j guarantees
that mi,j > ri,j.

j ≥ vi,j or p0

i

B.

INCENTIVE COMPATIBILITY PROOFS
PROOF OF LEMMA 16. For the sake of contradiction, suppose
that there is a feasible matching (u, p, µ) such that ui > u∗
i for
all i ∈ I. Note that every bidder must be matched in µ, since
ui > u∗
For each bidder i ∈ I, consider the slot j = µ(i) matched to
bidder i in the matching µ. Since the pair (i, j) is not blocking for

i ≥ 0.

WWW 2009 MADRID!Track: Internet Monetization / Session: Sponsored Search2490

r

∗

i,j

i )´ .

i,j = vi,j and m0

i,j = max`ri,j, max

vi0,j − ri0,j}. For every i ∈ I + and j ∈ J +, we set
i0∈I0 min(mi0,j, vi0,j − u
i,j = mi,j except that if mi,j ≤ r0
We also set v0
i,j = −1. It is not hard to show that if v, m, r is in general
we set m0
position, then so is (v0, m0, r0), using the fact that each utility u∗
i
was at some point set to be equal to the length of some alternating
walk in the auction graph.
Now consider the matchings µ and µ∗ restricted to the sets I +,
J +. If the restricted µ is not feasible for (v0, m0, r0), it must be
because pj < ri,j for some position j = µ(i). This can only
happen if r0
i0 ) for
some bidder i0 ∈ I \ I +.
On the other hand, it is easy to check that the restricted matching
µ∗ is feasible, stable and bidder-optimal for the auction (v0, m0, r0).
If the restricted µ is feasible for this auction, by Lemma 16, there
is a bidder i ∈ I∗ such that ui ≤ u∗
i . This however contradicts the
deﬁnition of the set I +.

i,j = max(mi0,j, vi0,j − u∗

i,j > ri,j and hence r0

C. LATTICE PROPERTY

The set of feasible and stable outcomes in both the stable mar-
riage and the assignment model has the algebraic structure of a lat-
tice (see e.g. Chapter 3 in [24]). This result can be carried over
to our assignment model with minimum and maximum prices as
well. The following lemma can be proved using ideas and tech-
niques from Section A. The proof is relatively long and tedious
and is omitted.

LEMMA 22

(LATTICE PROPERTY). Let (v, m, r) be an auc-
tion in general position. If (uA, pA, µA) and (uB, pB, µB) are two
feasible stable matchings for (v, m, r), then there exists a feasible
stable matching (uC , pC , µC ) for (v, m, r) such that

i = max{uA
uC
j = min{pA
pC

i }
i , uB
j }
j , pB

for each i ∈ I,
for each j ∈ J,

and there exists a feasible stable matching (uD, pD, µD) for (v, m, r)
such that

i = min{uA
uD
j = max{pA
pD

i }
i , uB
j }
j , pB

for each i ∈ I,
for each j ∈ J.

The set M of feasible and stable matchings for an auction (v, m, r)
is non-empty by 10. If the auction instance is in general position
we know that M is also a lattice by Lemma 22. It is not hard to see
that M is closed and bounded, and hence must have a minimum
and maximum element. This gives us an alternate way of proving
that a bidder-optimal stable matching exists.

the bidder-optimal matching (u∗, p∗, µ∗), it must be that p∗
j > pj.
In particular, the existence of µ implies that there must be n slots
with positive prices in the bidder-optimal matching µ∗, and that
these slots are matched in µ as well.

If a slot ever becomes matched to a bidder in the STABLEMATCH
algorithm, it will never become unmatched. Thus before the last
iteration, at most n − 1 slots have positive prices. Suppose the last
iteration, iteration T − 1, increases the size of the matching to n,
and let j be the last slot to be matched. Let i0 = µ(j) be the bidder
matched to j in the hypothetical matching µ.

Let P be the shortest alternating path found in Step 1 of the last
iteration of STABLEMATCH. Recall that the ﬁrst vertex of the path
is denoted by i0 and w(T−1)(P ) denotes its length. If P ends with
the reserve-price edge (i, j), it must be that i and j are matched in
both µ and µ∗ at the same reserve price, contradicting our assump-
tion that ui > u∗
i .
On the other hand, if P does not end with the reserve-price edge
(i, j), we show that there is a shorter alternating path P 0 that does
include this edge, which again leads to a contradiction. From Step
i = w(T−1)(P ) −
3 of the last iteration we have u(T−1)
d(T−1)(i0, i). Let s be the length of the reserve price edge (i, j);
+ ri,j − vi,j. Now con-
recall from Deﬁnition 8 that s = u(T−1)
sider the alternating path P 0 that consists of the shortest path from
i0 to i followed by the reserve price (i, j) edge. We have
w(T−1)(P )− w(T−1)(P
Since u∗
P 0 must be a shorter alternating path than P .

∗
i .
i < ui ≤ vi,j − ri,j, this difference is positive and hence

i − s = vi,j − ri,j − u
∗

) = u(T−1)

− u∗

− u

0

i

i

i

PROOF OF LEMMA 17. Without loss of generality assume that
(u, p, µ) is such that there does not exist a pair (i, j) 6∈ µ such that
ui + ri,j = vi,j. If there was such a pair, then we can decrease
prices of some of the items and increase utilities of some of the
bidders such that ui + ri,j > vi,j. (This is possible because of the
general position assumption. See full version of the paper.) The set
I + would only grow by such operation.
Let us denote by µ(I +), µ∗(I +) the set of slots matched to bid-
ders in I + in matching respectively µ, µ∗. We consider two cases:
Case 1: µ(I +) 6= µ∗(I +). For any i ∈ I + we have ui > u∗
i ≥
0 and hence each bidder in I + is matched in µ to some slot. There
exists a slot j ∈ µ(I +), j 6∈ µ∗(I +). Let i = µ(j). Since i ∈ I +,
ui > u∗
i .
We argue that pj < p∗
j : By the general position assumption
j 6= mi,j, and hence by feasibility of (u, p, µ), pj ∈ [ri,j, mi,j)
p∗
j ≥
and ui + pj = vi,j. Hence u∗
i > vi,j − ui = pj.
vi,j − u∗
In particular, j is matched in µ∗ to some i0, and by the choice of
j ∈
j, i0 6∈ I +. Thus ui0 ≤ u∗
i0. By feasibility of (u∗, p∗, µ∗), p∗
i0 + p∗
[ri0,j, mi0,j] and u∗
j = vi0,j. By the assumption on (u, p, µ)
that we made at the beginning of the proof, ui0 6= vi0,j − ri0,j.
Now, it is not hard to see that (i0, j) is blocking pair for µ. This

j ≥ vi,j. Therefore p∗

i + p∗

is because

j ≤ mi,j ,
∗
pj < p
i0 = vi0,j − p
ui0 ≤ u
j ≤ vi0,j − ri,j and
∗
∗
ui0 6= vi0,j − ri0,j ,

ui0 + pj < u

∗
∗
j = vi0,j .
i0 + p

stability of (u∗, p∗, µ∗) it follows that pj < p∗

i for i ∈ I +, by
Case 2: µ(I +) = µ∗(I +) = J +. Since ui > u∗
Consider a reduced auction (v0, m0, r0) on the set of bidders I +
and set of slots J +. We set the reserve prices to reﬂect the inﬂuence
of bidders in I \ I +. More speciﬁcally, let I0 = {i ∈ I \ I + | u∗
i0 ≥

j for j ∈ J +.

WWW 2009 MADRID!Track: Internet Monetization / Session: Sponsored Search250
