race finding and ranking compact connected trees for
